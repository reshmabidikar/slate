<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Kill Bill subscription API Documentation">
    <link rel="icon" type="image/x-icon" href="images/favicon.ico">
      <title>Kill Bill</title>
      <style media="screen">
        .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight .gh {
  color: #D0D5DD;
}
.highlight .sr {
  color: #FDA29B;
}
.highlight .go {
  color: #888888;
}
.highlight .gp {
  color: #555555;
}
.highlight .gs {
}
.highlight .gu {
  color: #aaaaaa;
}
.highlight .nb {
  color: #FEC84B;
}
.highlight .cm {
  color: #84ADFF;
}
.highlight .cp {
  color: #84ADFF;
}
.highlight .c1 {
  color: #84ADFF;
}
.highlight .cs {
  color: #84ADFF;
}
.highlight .c, .highlight .ch, .highlight .cd, .highlight .cpf {
  color: #84ADFF;
}
.highlight .err {
  color: #FE6099;
}
.highlight .gr {
  color: #FE6099;
}
.highlight .gt {
  color: #FE6099;
}
.highlight .gd {
  color: #49483e;
}
.highlight .gi {
  color: #49483e;
}
.highlight .ge {
  color: #49483e;
}
.highlight .kc {
  color: #84ADFF;
}
.highlight .kd {
  color: #84ADFF;
}
.highlight .kr {
  color: #84ADFF;
}
.highlight .no {
  color: #84ADFF;
}
.highlight .kt {
  color: #84ADFF;
}
.highlight .mf {
  color: #ae81ff;
}
.highlight .mh {
  color: #ae81ff;
}
.highlight .il {
  color: #ae81ff;
}
.highlight .mi {
  color: #ae81ff;
}
.highlight .mo {
  color: #ae81ff;
}
.highlight .m, .highlight .mb, .highlight .mx {
  color: #ae81ff;
}
.highlight .sc {
  color: #ae81ff;
}
.highlight .se {
  color: #ae81ff;
}
.highlight .ss {
  color: #ae81ff;
}
.highlight .sd {
  color: #FDA29B;
}
.highlight .s2 {
  color: #FDA29B;
}
.highlight .sb {
  color: #FDA29B;
}
.highlight .sh {
  color: #FDA29B;
}
.highlight .si {
  color: #FDA29B;
}
.highlight .sx {
  color: #FDA29B;
}
.highlight .s1 {
  color: #FDA29B;
}
.highlight .s, .highlight .sa, .highlight .dl {
  color: #FDA29B;
}
.highlight .na {
  color: #6CE9A6;
}
.highlight .nc {
  color: #6CE9A6;
}
.highlight .nd {
  color: #6CE9A6;
}
.highlight .ne {
  color: #6CE9A6;
}
.highlight .nf, .highlight .fm {
  color: #6CE9A6;
}
.highlight .vc {
  color: #D0D5DD;
}
.highlight .nn {
  color: #D0D5DD;
}
.highlight .ni {
  color: #D0D5DD;
}
.highlight .bp {
  color: #D0D5DD;
}
.highlight .vg {
  color: #D0D5DD;
}
.highlight .vi {
  color: #D0D5DD;
}
.highlight .nv, .highlight .vm {
  color: #D0D5DD;
}
.highlight .w {
  color: #D0D5DD;
}
.highlight {
  color: #D0D5DD;
}
.highlight .n, .highlight .py, .highlight .nx {
  color: #D0D5DD;
}
.highlight .nl {
  color: #ffffff;
}
.highlight .ow {
  color: #84ADFF;
}
.highlight .nt {
  color: #84ADFF;
}
.highlight .k, .highlight .kv {
  color: #84ADFF;
}
.highlight .kn {
  color: #84ADFF;
}
.highlight .kp {
  color: #84ADFF;
}
.highlight .o {
  color: #84ADFF;
}
      </style>
      <style media="print">
        * {
          -webkit-transition:none!important;
          transition:none!important;
        }
        .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight, .highlight .w {
  color: #586e75;
}
.highlight .err {
  color: #002b36;
  background-color: #dc322f;
}
.highlight .c, .highlight .ch, .highlight .cd, .highlight .cm, .highlight .cpf, .highlight .c1, .highlight .cs {
  color: #657b83;
}
.highlight .cp {
  color: #b58900;
}
.highlight .nt {
  color: #b58900;
}
.highlight .o, .highlight .ow {
  color: #93a1a1;
}
.highlight .p, .highlight .pi {
  color: #93a1a1;
}
.highlight .gi {
  color: #859900;
}
.highlight .gd {
  color: #dc322f;
}
.highlight .gh {
  color: #268bd2;
  background-color: #002b36;
  font-weight: bold;
}
.highlight .k, .highlight .kn, .highlight .kp, .highlight .kr, .highlight .kv {
  color: #6c71c4;
}
.highlight .kc {
  color: #cb4b16;
}
.highlight .kt {
  color: #cb4b16;
}
.highlight .kd {
  color: #cb4b16;
}
.highlight .s, .highlight .sb, .highlight .sc, .highlight .dl, .highlight .sd, .highlight .s2, .highlight .sh, .highlight .sx, .highlight .s1 {
  color: #859900;
}
.highlight .sa {
  color: #6c71c4;
}
.highlight .sr {
  color: #2aa198;
}
.highlight .si {
  color: #d33682;
}
.highlight .se {
  color: #d33682;
}
.highlight .nn {
  color: #b58900;
}
.highlight .nc {
  color: #b58900;
}
.highlight .no {
  color: #b58900;
}
.highlight .na {
  color: #268bd2;
}
.highlight .m, .highlight .mb, .highlight .mf, .highlight .mh, .highlight .mi, .highlight .il, .highlight .mo, .highlight .mx {
  color: #859900;
}
.highlight .ss {
  color: #859900;
}
      </style>
      <link href="stylesheets/screen.css" rel="stylesheet" media="screen" />
      <link href="stylesheets/print.css" rel="stylesheet" media="print" />
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@docsearch/css@3" />
  </head>

  <body data-languages="[&quot;shell&quot;,&quot;java&quot;,&quot;ruby&quot;,&quot;python&quot;]">
    <div class="loader-wrapper">
      <div id="loading"></div>
    </div>
    <header class="header sticky" id="header">
      <div class="header__logo-wrapper">
        <a href="/"  aria-label="Kill Bill logo" class="header__logo"></a>
        <label class="header__theme-switch theme-switch"></label>
      </div>
      
      <div class="header__sidebar-toggler">
        <svg class="hamburger" xmlns="http://www.w3.org/2000/svg" width="25" height="25" viewBox="0 0 24 24" fill="currentColor">
          <path fill-rule="evenodd" clip-rule="evenodd" d="M20.75 7C20.75 7.41421 20.4142 7.75 20 7.75L4 7.75C3.58579 7.75 3.25 7.41421 3.25 7C3.25 6.58579 3.58579 6.25 4 6.25L20 6.25C20.4142 6.25 20.75 6.58579 20.75 7Z" fill=""/>
          <path fill-rule="evenodd" clip-rule="evenodd" d="M20.75 12C20.75 12.4142 20.4142 12.75 20 12.75L4 12.75C3.58579 12.75 3.25 12.4142 3.25 12C3.25 11.5858 3.58579 11.25 4 11.25L20 11.25C20.4142 11.25 20.75 11.5858 20.75 12Z" fill=""/>
          <path fill-rule="evenodd" clip-rule="evenodd" d="M20.75 17C20.75 17.4142 20.4142 17.75 20 17.75L4 17.75C3.58579 17.75 3.25 17.4142 3.25 17C3.25 16.5858 3.58579 16.25 4 16.25L20 16.25C20.4142 16.25 20.75 16.5858 20.75 17Z" fill=""/>
        </svg>
      </div>

      <div class="header__search-wrapper">
        <div class="header__search">
          <div id="docsearch" style="height: 43px; display: flex; align-items: center; width: 100%;">
          </div>
        </div>

          <div class="lang-selector">
            <label>
              <select class="lang-selector__select">
                  <option data-language-name="shell" value="shell">shell</option>
                  <option data-language-name="java" value="java">java</option>
                  <option data-language-name="ruby" value="ruby">ruby</option>
                  <option data-language-name="python" value="python">python</option>
              </select>
            </label>
            <div class="lang-selector__list">
                  <a href="#" class="lang-selector__link" data-language-name="shell">shell</a>
                  <a href="#" class="lang-selector__link" data-language-name="java">java</a>
                  <a href="#" class="lang-selector__link" data-language-name="ruby">ruby</a>
                  <a href="#" class="lang-selector__link" data-language-name="python">python</a>
            </div>
          </div>
      </div>
    </header>
    <main class="page">
      <div class="page__sidebar">
        <nav class="site-navigator">
          <ul class="site-navigator__menu">
              <li>
                <a href="index.html" class="site-navigator__item site-navigator__menu-item" data-title="Using Kill Bill APIs">
                  <span>Using Kill Bill APIs</span>
                </a>
                
                  <ul class="site-navigator__submenu">
                      <li class="site-navigator__submenu-container">
                        <a href="#introduction" class="site-navigator__item site-navigator__submenu-item" data-title="Introduction">
                          <span>Introduction</span>
                        </a>

                      </li>
                      <li class="site-navigator__submenu-container">
                        <a href="#authentication-and-rbac" class="site-navigator__item site-navigator__submenu-item" data-title="Authentication and RBAC">
                          <span>Authentication and RBAC</span>
                        </a>

                      </li>
                      <li class="site-navigator__submenu-container">
                        <a href="#multi-tenancy" class="site-navigator__item site-navigator__submenu-item" data-title="Multi-Tenancy">
                          <span>Multi-Tenancy</span>
                        </a>

                      </li>
                      <li class="site-navigator__submenu-container">
                        <a href="#resource-ids-and-external-keys" class="site-navigator__item site-navigator__submenu-item" data-title="Resource IDs and External Keys">
                          <span>Resource IDs and External Keys</span>
                        </a>

                      </li>
                      <li class="site-navigator__submenu-container">
                        <a href="#pagination" class="site-navigator__item site-navigator__submenu-item" data-title="Pagination">
                          <span>Pagination</span>
                        </a>

                      </li>
                      <li class="site-navigator__submenu-container">
                        <a href="#audit-and-history" class="site-navigator__item site-navigator__submenu-item" data-title="Audit and History">
                          <span>Audit and History</span>
                        </a>

                      </li>
                      <li class="site-navigator__submenu-container">
                        <a href="#versioning" class="site-navigator__item site-navigator__submenu-item" data-title="Versioning">
                          <span>Versioning</span>
                        </a>

                          <ul class="site-navigator__submenu">
                              <li>
                                <a href="#kill-bill-server" class="site-navigator__item site-navigator__submenu-item" data-title="Kill Bill Server">
                                  <span>Kill Bill Server</span>
                                </a>
                              </li>
                              <li>
                                <a href="#client-libraries" class="site-navigator__item site-navigator__submenu-item" data-title="Client Libraries">
                                  <span>Client Libraries</span>
                                </a>
                              </li>
                              <li>
                                <a href="#plugins" class="site-navigator__item site-navigator__submenu-item" data-title="Plugins">
                                  <span>Plugins</span>
                                </a>
                              </li>
                              <li>
                                <a href="#kpm" class="site-navigator__item site-navigator__submenu-item" data-title="KPM">
                                  <span>KPM</span>
                                </a>
                              </li>
                          </ul>
                      </li>
                      <li class="site-navigator__submenu-container">
                        <a href="#errors" class="site-navigator__item site-navigator__submenu-item" data-title="Errors">
                          <span>Errors</span>
                        </a>

                      </li>
                      <li class="site-navigator__submenu-container">
                        <a href="#additional-resources" class="site-navigator__item site-navigator__submenu-item" data-title="Additional Resources">
                          <span>Additional Resources</span>
                        </a>

                      </li>
                  </ul>
              </li>
              <li>
                <a href="tenant.html" class="site-navigator__item site-navigator__menu-item" data-title="Tenant">
                  <span>Tenant</span>
                </a>
                
                  <ul class="site-navigator__submenu">
                      <li class="site-navigator__submenu-container">
                        <a href="#tenant-resource" class="site-navigator__item site-navigator__submenu-item" data-title="Tenant Resource">
                          <span>Tenant Resource</span>
                        </a>

                      </li>
                      <li class="site-navigator__submenu-container">
                        <a href="#tenant-2" class="site-navigator__item site-navigator__submenu-item" data-title="Tenant">
                          <span>Tenant</span>
                        </a>

                          <ul class="site-navigator__submenu">
                              <li>
                                <a href="#create-a-tenant" class="site-navigator__item site-navigator__submenu-item" data-title="Create a tenant">
                                  <span>Create a tenant</span>
                                </a>
                              </li>
                              <li>
                                <a href="#retrieve-a-tenant-by-id" class="site-navigator__item site-navigator__submenu-item" data-title="Retrieve a tenant by id">
                                  <span>Retrieve a tenant by id</span>
                                </a>
                              </li>
                              <li>
                                <a href="#retrieve-a-tenant-by-its-api-key" class="site-navigator__item site-navigator__submenu-item" data-title="Retrieve a tenant by its API key">
                                  <span>Retrieve a tenant by its API key</span>
                                </a>
                              </li>
                          </ul>
                      </li>
                      <li class="site-navigator__submenu-container">
                        <a href="#tenant-key-value-pairs" class="site-navigator__item site-navigator__submenu-item" data-title="Tenant Key-Value Pairs">
                          <span>Tenant Key-Value Pairs</span>
                        </a>

                          <ul class="site-navigator__submenu">
                              <li>
                                <a href="#add-a-per-tenant-user-key-value" class="site-navigator__item site-navigator__submenu-item" data-title="Add a per tenant user key/value">
                                  <span>Add a per tenant user key/value</span>
                                </a>
                              </li>
                              <li>
                                <a href="#retrieve-a-per-tenant-user-key-value" class="site-navigator__item site-navigator__submenu-item" data-title="Retrieve a per tenant user key value">
                                  <span>Retrieve a per tenant user key value</span>
                                </a>
                              </li>
                              <li>
                                <a href="#delete-a-per-tenant-user-key-value" class="site-navigator__item site-navigator__submenu-item" data-title="Delete a per tenant user key/value">
                                  <span>Delete a per tenant user key/value</span>
                                </a>
                              </li>
                              <li>
                                <a href="#retrieve-per-tenant-keys-and-values-based-on-a-key-prefix" class="site-navigator__item site-navigator__submenu-item" data-title="Retrieve per tenant keys and values based on a key prefix">
                                  <span>Retrieve per tenant keys and values based on a key prefix</span>
                                </a>
                              </li>
                          </ul>
                      </li>
                      <li class="site-navigator__submenu-container">
                        <a href="#push-notifications" class="site-navigator__item site-navigator__submenu-item" data-title="Push Notifications">
                          <span>Push Notifications</span>
                        </a>

                          <ul class="site-navigator__submenu">
                              <li>
                                <a href="#register-a-push-notification" class="site-navigator__item site-navigator__submenu-item" data-title="Register a push notification">
                                  <span>Register a push notification</span>
                                </a>
                              </li>
                              <li>
                                <a href="#retrieve-a-registered-push-notification" class="site-navigator__item site-navigator__submenu-item" data-title="Retrieve a registered push notification">
                                  <span>Retrieve a registered push notification</span>
                                </a>
                              </li>
                              <li>
                                <a href="#delete-a-registered-push-notification" class="site-navigator__item site-navigator__submenu-item" data-title="Delete a registered push notification">
                                  <span>Delete a registered push notification</span>
                                </a>
                              </li>
                          </ul>
                      </li>
                      <li class="site-navigator__submenu-container">
                        <a href="#system-properties-configuration" class="site-navigator__item site-navigator__submenu-item" data-title="System Properties Configuration">
                          <span>System Properties Configuration</span>
                        </a>

                          <ul class="site-navigator__submenu">
                              <li>
                                <a href="#add-a-per-tenant-system-properties-configuration" class="site-navigator__item site-navigator__submenu-item" data-title="Add a per tenant system properties configuration">
                                  <span>Add a per tenant system properties configuration</span>
                                </a>
                              </li>
                              <li>
                                <a href="#retrieve-a-per-tenant-system-properties-configuration" class="site-navigator__item site-navigator__submenu-item" data-title="Retrieve a per tenant system properties configuration">
                                  <span>Retrieve a per tenant system properties configuration</span>
                                </a>
                              </li>
                              <li>
                                <a href="#delete-a-per-tenant-system-properties-configuration" class="site-navigator__item site-navigator__submenu-item" data-title="Delete a per tenant system properties configuration">
                                  <span>Delete a per tenant system properties configuration</span>
                                </a>
                              </li>
                          </ul>
                      </li>
                      <li class="site-navigator__submenu-container">
                        <a href="#plugin-configuration" class="site-navigator__item site-navigator__submenu-item" data-title="Plugin Configuration">
                          <span>Plugin Configuration</span>
                        </a>

                          <ul class="site-navigator__submenu">
                              <li>
                                <a href="#add-a-per-tenant-configuration-for-a-plugin" class="site-navigator__item site-navigator__submenu-item" data-title="Add a per tenant configuration for a plugin">
                                  <span>Add a per tenant configuration for a plugin</span>
                                </a>
                              </li>
                              <li>
                                <a href="#retrieve-a-per-tenant-configuration-for-a-plugin" class="site-navigator__item site-navigator__submenu-item" data-title="Retrieve a per tenant configuration for a plugin">
                                  <span>Retrieve a per tenant configuration for a plugin</span>
                                </a>
                              </li>
                              <li>
                                <a href="#delete-a-per-tenant-configuration-for-a-plugin" class="site-navigator__item site-navigator__submenu-item" data-title="Delete a per tenant configuration for a plugin">
                                  <span>Delete a per tenant configuration for a plugin</span>
                                </a>
                              </li>
                          </ul>
                      </li>
                      <li class="site-navigator__submenu-container">
                        <a href="#payment-state-machines" class="site-navigator__item site-navigator__submenu-item" data-title="Payment State Machines">
                          <span>Payment State Machines</span>
                        </a>

                          <ul class="site-navigator__submenu">
                              <li>
                                <a href="#add-a-per-tenant-payment-state-machine-for-a-plugin" class="site-navigator__item site-navigator__submenu-item" data-title="Add a per tenant payment state machine for a plugin">
                                  <span>Add a per tenant payment state machine for a plugin</span>
                                </a>
                              </li>
                              <li>
                                <a href="#retrieve-a-per-tenant-payment-state-machine-for-a-plugin" class="site-navigator__item site-navigator__submenu-item" data-title="Retrieve a per tenant payment state machine for a plugin">
                                  <span>Retrieve a per tenant payment state machine for a plugin</span>
                                </a>
                              </li>
                              <li>
                                <a href="#delete-a-per-tenant-payment-state-machine-for-a-plugin" class="site-navigator__item site-navigator__submenu-item" data-title="Delete a per tenant payment state machine for a plugin">
                                  <span>Delete a per tenant payment state machine for a plugin</span>
                                </a>
                              </li>
                          </ul>
                      </li>
                  </ul>
              </li>
              <li>
                <a href="catalog.html" class="site-navigator__item site-navigator__menu-item" data-title="Catalog">
                  <span>Catalog</span>
                </a>
                
                  <ul class="site-navigator__submenu">
                      <li class="site-navigator__submenu-container">
                        <a href="#catalog-resource" class="site-navigator__item site-navigator__submenu-item" data-title="Catalog Resource">
                          <span>Catalog Resource</span>
                        </a>

                      </li>
                      <li class="site-navigator__submenu-container">
                        <a href="#catalogvalidation-resource" class="site-navigator__item site-navigator__submenu-item" data-title="CatalogValidation Resource">
                          <span>CatalogValidation Resource</span>
                        </a>

                      </li>
                      <li class="site-navigator__submenu-container">
                        <a href="#catalog-2" class="site-navigator__item site-navigator__submenu-item" data-title="Catalog">
                          <span>Catalog</span>
                        </a>

                          <ul class="site-navigator__submenu">
                              <li>
                                <a href="#upload-a-catalog-as-xml" class="site-navigator__item site-navigator__submenu-item" data-title="Upload a catalog as XML">
                                  <span>Upload a catalog as XML</span>
                                </a>
                              </li>
                              <li>
                                <a href="#retrieve-the-catalog-as-xml" class="site-navigator__item site-navigator__submenu-item" data-title="Retrieve the catalog as XML">
                                  <span>Retrieve the catalog as XML</span>
                                </a>
                              </li>
                              <li>
                                <a href="#retrieve-the-catalog-as-json" class="site-navigator__item site-navigator__submenu-item" data-title="Retrieve the catalog as JSON">
                                  <span>Retrieve the catalog as JSON</span>
                                </a>
                              </li>
                              <li>
                                <a href="#retrieve-a-list-of-catalog-versions" class="site-navigator__item site-navigator__submenu-item" data-title="Retrieve a list of catalog versions">
                                  <span>Retrieve a list of catalog versions</span>
                                </a>
                              </li>
                              <li>
                                <a href="#retrieve-available-base-plans" class="site-navigator__item site-navigator__submenu-item" data-title="Retrieve available base plans">
                                  <span>Retrieve available base plans</span>
                                </a>
                              </li>
                              <li>
                                <a href="#retrieve-available-add-ons-for-a-given-product" class="site-navigator__item site-navigator__submenu-item" data-title="Retrieve available add-ons for a given product">
                                  <span>Retrieve available add-ons for a given product</span>
                                </a>
                              </li>
                              <li>
                                <a href="#delete-all-versions-of-a-per-tenant-catalog" class="site-navigator__item site-navigator__submenu-item" data-title="Delete all versions of a per tenant catalog">
                                  <span>Delete all versions of a per tenant catalog</span>
                                </a>
                              </li>
                              <li>
                                <a href="#validate-a-catalog-xml" class="site-navigator__item site-navigator__submenu-item" data-title="Validate a catalog XML">
                                  <span>Validate a catalog XML</span>
                                </a>
                              </li>
                          </ul>
                      </li>
                      <li class="site-navigator__submenu-container">
                        <a href="#subscription-info" class="site-navigator__item site-navigator__submenu-item" data-title="Subscription info">
                          <span>Subscription info</span>
                        </a>

                          <ul class="site-navigator__submenu">
                              <li>
                                <a href="#retrieve-the-phase-for-a-given-subscription-and-date" class="site-navigator__item site-navigator__submenu-item" data-title="Retrieve the phase for a given subscription and date">
                                  <span>Retrieve the phase for a given subscription and date</span>
                                </a>
                              </li>
                              <li>
                                <a href="#retrieve-the-plan-for-a-given-subscription-and-date" class="site-navigator__item site-navigator__submenu-item" data-title="Retrieve the plan for a given subscription and date">
                                  <span>Retrieve the plan for a given subscription and date</span>
                                </a>
                              </li>
                              <li>
                                <a href="#retrieve-the-pricelist-for-a-given-subscription-and-date" class="site-navigator__item site-navigator__submenu-item" data-title="Retrieve the priceList for a given subscription and date">
                                  <span>Retrieve the priceList for a given subscription and date</span>
                                </a>
                              </li>
                              <li>
                                <a href="#retrieve-product-for-a-given-subscription-and-date" class="site-navigator__item site-navigator__submenu-item" data-title="Retrieve product for a given subscription and date">
                                  <span>Retrieve product for a given subscription and date</span>
                                </a>
                              </li>
                          </ul>
                      </li>
                      <li class="site-navigator__submenu-container">
                        <a href="#simple-plan" class="site-navigator__item site-navigator__submenu-item" data-title="Simple Plan">
                          <span>Simple Plan</span>
                        </a>

                          <ul class="site-navigator__submenu">
                              <li>
                                <a href="#add-a-simple-plan" class="site-navigator__item site-navigator__submenu-item" data-title="Add a simple plan">
                                  <span>Add a simple plan</span>
                                </a>
                              </li>
                          </ul>
                      </li>
                  </ul>
              </li>
              <li>
                <a href="account.html" class="site-navigator__item site-navigator__menu-item" data-title="Account">
                  <span>Account</span>
                </a>
                
                  <ul class="site-navigator__submenu">
                      <li class="site-navigator__submenu-container">
                        <a href="#account-resource" class="site-navigator__item site-navigator__submenu-item" data-title="Account Resource">
                          <span>Account Resource</span>
                        </a>

                      </li>
                      <li class="site-navigator__submenu-container">
                        <a href="#accounts" class="site-navigator__item site-navigator__submenu-item" data-title="Accounts">
                          <span>Accounts</span>
                        </a>

                          <ul class="site-navigator__submenu">
                              <li>
                                <a href="#create-an-account" class="site-navigator__item site-navigator__submenu-item" data-title="Create an Account">
                                  <span>Create an Account</span>
                                </a>
                              </li>
                              <li>
                                <a href="#retrieve-an-account-by-its-id" class="site-navigator__item site-navigator__submenu-item" data-title="Retrieve an Account by its ID">
                                  <span>Retrieve an Account by its ID</span>
                                </a>
                              </li>
                              <li>
                                <a href="#retrieve-an-account-by-its-external-key" class="site-navigator__item site-navigator__submenu-item" data-title="Retrieve an Account by its external key">
                                  <span>Retrieve an Account by its external key</span>
                                </a>
                              </li>
                              <li>
                                <a href="#update-an-account" class="site-navigator__item site-navigator__submenu-item" data-title="Update an Account">
                                  <span>Update an Account</span>
                                </a>
                              </li>
                              <li>
                                <a href="#close-account" class="site-navigator__item site-navigator__submenu-item" data-title="Close account">
                                  <span>Close account</span>
                                </a>
                              </li>
                          </ul>
                      </li>
                      <li class="site-navigator__submenu-container">
                        <a href="#list-and-search" class="site-navigator__item site-navigator__submenu-item" data-title="List and Search">
                          <span>List and Search</span>
                        </a>

                          <ul class="site-navigator__submenu">
                              <li>
                                <a href="#list-accounts" class="site-navigator__item site-navigator__submenu-item" data-title="List accounts">
                                  <span>List accounts</span>
                                </a>
                              </li>
                              <li>
                                <a href="#search-accounts" class="site-navigator__item site-navigator__submenu-item" data-title="Search accounts">
                                  <span>Search accounts</span>
                                </a>
                              </li>
                          </ul>
                      </li>
                      <li class="site-navigator__submenu-container">
                        <a href="#email" class="site-navigator__item site-navigator__submenu-item" data-title="Email">
                          <span>Email</span>
                        </a>

                          <ul class="site-navigator__submenu">
                              <li>
                                <a href="#add-account-email" class="site-navigator__item site-navigator__submenu-item" data-title="Add account email">
                                  <span>Add account email</span>
                                </a>
                              </li>
                              <li>
                                <a href="#retrieve-account-emails" class="site-navigator__item site-navigator__submenu-item" data-title="Retrieve account emails">
                                  <span>Retrieve account emails</span>
                                </a>
                              </li>
                              <li>
                                <a href="#delete-email" class="site-navigator__item site-navigator__submenu-item" data-title="Delete email">
                                  <span>Delete email</span>
                                </a>
                              </li>
                          </ul>
                      </li>
                      <li class="site-navigator__submenu-container">
                        <a href="#bundle" class="site-navigator__item site-navigator__submenu-item" data-title="Bundle">
                          <span>Bundle</span>
                        </a>

                          <ul class="site-navigator__submenu">
                              <li>
                                <a href="#retrieve-bundles-for-account" class="site-navigator__item site-navigator__submenu-item" data-title="Retrieve bundles for account">
                                  <span>Retrieve bundles for account</span>
                                </a>
                              </li>
                              <li>
                                <a href="#retrieve-paginated-bundles-for-account" class="site-navigator__item site-navigator__submenu-item" data-title="Retrieve paginated bundles for account">
                                  <span>Retrieve paginated bundles for account</span>
                                </a>
                              </li>
                          </ul>
                      </li>
                      <li class="site-navigator__submenu-container">
                        <a href="#invoice" class="site-navigator__item site-navigator__submenu-item" data-title="Invoice">
                          <span>Invoice</span>
                        </a>

                          <ul class="site-navigator__submenu">
                              <li>
                                <a href="#retrieve-account-invoices" class="site-navigator__item site-navigator__submenu-item" data-title="Retrieve account invoices">
                                  <span>Retrieve account invoices</span>
                                </a>
                              </li>
                              <li>
                                <a href="#retrieve-paginated-account-invoices" class="site-navigator__item site-navigator__submenu-item" data-title="Retrieve paginated account invoices">
                                  <span>Retrieve paginated account invoices</span>
                                </a>
                              </li>
                          </ul>
                      </li>
                      <li class="site-navigator__submenu-container">
                        <a href="#payment" class="site-navigator__item site-navigator__submenu-item" data-title="Payment">
                          <span>Payment</span>
                        </a>

                          <ul class="site-navigator__submenu">
                              <li>
                                <a href="#trigger-a-payment-for-all-unpaid-invoices" class="site-navigator__item site-navigator__submenu-item" data-title="Trigger a payment for all unpaid invoices">
                                  <span>Trigger a payment for all unpaid invoices</span>
                                </a>
                              </li>
                              <li>
                                <a href="#retrieve-account-invoice-payments" class="site-navigator__item site-navigator__submenu-item" data-title="Retrieve account invoice payments">
                                  <span>Retrieve account invoice payments</span>
                                </a>
                              </li>
                              <li>
                                <a href="#retrieve-account-payments" class="site-navigator__item site-navigator__submenu-item" data-title="Retrieve account payments">
                                  <span>Retrieve account payments</span>
                                </a>
                              </li>
                              <li>
                                <a href="#trigger-a-payment-authorization-purchase-or-credit" class="site-navigator__item site-navigator__submenu-item" data-title="Trigger a payment (authorization, purchase or credit)">
                                  <span>Trigger a payment (authorization, purchase or credit)</span>
                                </a>
                              </li>
                              <li>
                                <a href="#trigger-a-payment-authorization-purchase-or-credit-using-the-account-external-key" class="site-navigator__item site-navigator__submenu-item" data-title="Trigger a payment (authorization, purchase or credit) using the account external key">
                                  <span>Trigger a payment (authorization, purchase or credit) using the account external key</span>
                                </a>
                              </li>
                          </ul>
                      </li>
                      <li class="site-navigator__submenu-container">
                        <a href="#payment-method" class="site-navigator__item site-navigator__submenu-item" data-title="Payment Method">
                          <span>Payment Method</span>
                        </a>

                          <ul class="site-navigator__submenu">
                              <li>
                                <a href="#add-a-payment-method" class="site-navigator__item site-navigator__submenu-item" data-title="Add a payment method">
                                  <span>Add a payment method</span>
                                </a>
                              </li>
                              <li>
                                <a href="#retrieve-account-payment-methods" class="site-navigator__item site-navigator__submenu-item" data-title="Retrieve account payment methods">
                                  <span>Retrieve account payment methods</span>
                                </a>
                              </li>
                              <li>
                                <a href="#set-the-default-payment-method" class="site-navigator__item site-navigator__submenu-item" data-title="Set the default payment method">
                                  <span>Set the default payment method</span>
                                </a>
                              </li>
                              <li>
                                <a href="#refresh-account-payment-methods" class="site-navigator__item site-navigator__submenu-item" data-title="Refresh account payment methods">
                                  <span>Refresh account payment methods</span>
                                </a>
                              </li>
                          </ul>
                      </li>
                      <li class="site-navigator__submenu-container">
                        <a href="#overdue" class="site-navigator__item site-navigator__submenu-item" data-title="Overdue">
                          <span>Overdue</span>
                        </a>

                          <ul class="site-navigator__submenu">
                              <li>
                                <a href="#retrieve-overdue-state-for-account" class="site-navigator__item site-navigator__submenu-item" data-title="Retrieve overdue state for account">
                                  <span>Retrieve overdue state for account</span>
                                </a>
                              </li>
                          </ul>
                      </li>
                      <li class="site-navigator__submenu-container">
                        <a href="#blocking-state" class="site-navigator__item site-navigator__submenu-item" data-title="Blocking State">
                          <span>Blocking State</span>
                        </a>

                          <ul class="site-navigator__submenu">
                              <li>
                                <a href="#blocking-state-resource" class="site-navigator__item site-navigator__submenu-item" data-title="Blocking State Resource">
                                  <span>Blocking State Resource</span>
                                </a>
                              </li>
                              <li>
                                <a href="#block-an-account" class="site-navigator__item site-navigator__submenu-item" data-title="Block an account">
                                  <span>Block an account</span>
                                </a>
                              </li>
                              <li>
                                <a href="#retrieve-blocking-states-for-account" class="site-navigator__item site-navigator__submenu-item" data-title="Retrieve blocking states for account">
                                  <span>Retrieve blocking states for account</span>
                                </a>
                              </li>
                          </ul>
                      </li>
                      <li class="site-navigator__submenu-container">
                        <a href="#hierarchical-accounts" class="site-navigator__item site-navigator__submenu-item" data-title="Hierarchical Accounts">
                          <span>Hierarchical Accounts</span>
                        </a>

                          <ul class="site-navigator__submenu">
                              <li>
                                <a href="#list-child-accounts" class="site-navigator__item site-navigator__submenu-item" data-title="List child accounts">
                                  <span>List child accounts</span>
                                </a>
                              </li>
                              <li>
                                <a href="#transfer-a-given-child-credit-to-the-parent-level" class="site-navigator__item site-navigator__submenu-item" data-title="Transfer a given child credit to the parent level">
                                  <span>Transfer a given child credit to the parent level</span>
                                </a>
                              </li>
                          </ul>
                      </li>
                      <li class="site-navigator__submenu-container">
                        <a href="#custom-fields" class="site-navigator__item site-navigator__submenu-item" data-title="Custom Fields">
                          <span>Custom Fields</span>
                        </a>

                          <ul class="site-navigator__submenu">
                              <li>
                                <a href="#add-custom-fields-to-account" class="site-navigator__item site-navigator__submenu-item" data-title="Add custom fields to account">
                                  <span>Add custom fields to account</span>
                                </a>
                              </li>
                              <li>
                                <a href="#retrieve-all-custom-fields" class="site-navigator__item site-navigator__submenu-item" data-title="Retrieve all custom fields">
                                  <span>Retrieve all custom fields</span>
                                </a>
                              </li>
                              <li>
                                <a href="#retrieve-account-custom-fields" class="site-navigator__item site-navigator__submenu-item" data-title="Retrieve account custom fields">
                                  <span>Retrieve account custom fields</span>
                                </a>
                              </li>
                              <li>
                                <a href="#modify-custom-fields-for-an-account" class="site-navigator__item site-navigator__submenu-item" data-title="Modify custom fields for an account">
                                  <span>Modify custom fields for an account</span>
                                </a>
                              </li>
                              <li>
                                <a href="#remove-custom-fields-from-account" class="site-navigator__item site-navigator__submenu-item" data-title="Remove custom fields from account">
                                  <span>Remove custom fields from account</span>
                                </a>
                              </li>
                          </ul>
                      </li>
                      <li class="site-navigator__submenu-container">
                        <a href="#tags" class="site-navigator__item site-navigator__submenu-item" data-title="Tags">
                          <span>Tags</span>
                        </a>

                          <ul class="site-navigator__submenu">
                              <li>
                                <a href="#add-tags-to-account" class="site-navigator__item site-navigator__submenu-item" data-title="Add tags to account">
                                  <span>Add tags to account</span>
                                </a>
                              </li>
                              <li>
                                <a href="#retrieve-all-tags" class="site-navigator__item site-navigator__submenu-item" data-title="Retrieve all tags">
                                  <span>Retrieve all tags</span>
                                </a>
                              </li>
                              <li>
                                <a href="#retrieve-account-tags" class="site-navigator__item site-navigator__submenu-item" data-title="Retrieve account tags">
                                  <span>Retrieve account tags</span>
                                </a>
                              </li>
                              <li>
                                <a href="#remove-tags-from-account" class="site-navigator__item site-navigator__submenu-item" data-title="Remove tags from account">
                                  <span>Remove tags from account</span>
                                </a>
                              </li>
                          </ul>
                      </li>
                      <li class="site-navigator__submenu-container">
                        <a href="#audit-logs" class="site-navigator__item site-navigator__submenu-item" data-title="Audit Logs">
                          <span>Audit Logs</span>
                        </a>

                          <ul class="site-navigator__submenu">
                              <li>
                                <a href="#retrieve-audit-logs" class="site-navigator__item site-navigator__submenu-item" data-title="Retrieve audit logs">
                                  <span>Retrieve audit logs</span>
                                </a>
                              </li>
                              <li>
                                <a href="#retrieve-account-audit-logs-with-history" class="site-navigator__item site-navigator__submenu-item" data-title="Retrieve account audit logs with history">
                                  <span>Retrieve account audit logs with history</span>
                                </a>
                              </li>
                              <li>
                                <a href="#retrieve-account-email-audit-logs-with-history" class="site-navigator__item site-navigator__submenu-item" data-title="Retrieve account email audit logs with history">
                                  <span>Retrieve account email audit logs with history</span>
                                </a>
                              </li>
                              <li>
                                <a href="#retrieve-blocking-state-audit-logs-with-history" class="site-navigator__item site-navigator__submenu-item" data-title="Retrieve blocking state audit logs with history">
                                  <span>Retrieve blocking state audit logs with history</span>
                                </a>
                              </li>
                              <li>
                                <a href="#retrieve-account-timeline" class="site-navigator__item site-navigator__submenu-item" data-title="Retrieve account timeline">
                                  <span>Retrieve account timeline</span>
                                </a>
                              </li>
                          </ul>
                      </li>
                  </ul>
              </li>
              <li>
                <a href="payment-method.html" class="site-navigator__item site-navigator__menu-item" data-title="Payment Method">
                  <span>Payment Method</span>
                </a>
                
                  <ul class="site-navigator__submenu">
                      <li class="site-navigator__submenu-container">
                        <a href="#payment-method-resource" class="site-navigator__item site-navigator__submenu-item" data-title="Payment Method Resource">
                          <span>Payment Method Resource</span>
                        </a>

                      </li>
                      <li class="site-navigator__submenu-container">
                        <a href="#plugin-details-resource" class="site-navigator__item site-navigator__submenu-item" data-title="Plugin Details Resource">
                          <span>Plugin Details Resource</span>
                        </a>

                      </li>
                      <li class="site-navigator__submenu-container">
                        <a href="#payment-methods" class="site-navigator__item site-navigator__submenu-item" data-title="Payment Methods">
                          <span>Payment Methods</span>
                        </a>

                          <ul class="site-navigator__submenu">
                              <li>
                                <a href="#retrieve-a-payment-method-by-id" class="site-navigator__item site-navigator__submenu-item" data-title="Retrieve a payment method by id">
                                  <span>Retrieve a payment method by id</span>
                                </a>
                              </li>
                              <li>
                                <a href="#retrieve-a-payment-method-by-external-key" class="site-navigator__item site-navigator__submenu-item" data-title="Retrieve a payment method by external key">
                                  <span>Retrieve a payment method by external key</span>
                                </a>
                              </li>
                              <li>
                                <a href="#delete-a-payment-method" class="site-navigator__item site-navigator__submenu-item" data-title="Delete a payment method">
                                  <span>Delete a payment method</span>
                                </a>
                              </li>
                          </ul>
                      </li>
                      <li class="site-navigator__submenu-container">
                        <a href="#list-and-search" class="site-navigator__item site-navigator__submenu-item" data-title="List and Search">
                          <span>List and Search</span>
                        </a>

                          <ul class="site-navigator__submenu">
                              <li>
                                <a href="#list-payment-methods" class="site-navigator__item site-navigator__submenu-item" data-title="List payment methods">
                                  <span>List payment methods</span>
                                </a>
                              </li>
                              <li>
                                <a href="#search-payment-methods" class="site-navigator__item site-navigator__submenu-item" data-title="Search payment methods">
                                  <span>Search payment methods</span>
                                </a>
                              </li>
                          </ul>
                      </li>
                      <li class="site-navigator__submenu-container">
                        <a href="#custom-fields" class="site-navigator__item site-navigator__submenu-item" data-title="Custom Fields">
                          <span>Custom Fields</span>
                        </a>

                          <ul class="site-navigator__submenu">
                              <li>
                                <a href="#add-custom-fields-to-a-payment-method" class="site-navigator__item site-navigator__submenu-item" data-title="Add custom fields to a payment method">
                                  <span>Add custom fields to a payment method</span>
                                </a>
                              </li>
                              <li>
                                <a href="#retrieve-payment-method-custom-fields" class="site-navigator__item site-navigator__submenu-item" data-title="Retrieve payment method custom fields">
                                  <span>Retrieve payment method custom fields</span>
                                </a>
                              </li>
                              <li>
                                <a href="#modify-custom-fields-for-payment-method" class="site-navigator__item site-navigator__submenu-item" data-title="Modify custom fields for payment method">
                                  <span>Modify custom fields for payment method</span>
                                </a>
                              </li>
                              <li>
                                <a href="#remove-custom-fields-from-payment-method" class="site-navigator__item site-navigator__submenu-item" data-title="Remove custom fields from payment method">
                                  <span>Remove custom fields from payment method</span>
                                </a>
                              </li>
                          </ul>
                      </li>
                      <li class="site-navigator__submenu-container">
                        <a href="#audit-logs" class="site-navigator__item site-navigator__submenu-item" data-title="Audit Logs">
                          <span>Audit Logs</span>
                        </a>

                          <ul class="site-navigator__submenu">
                              <li>
                                <a href="#retrieve-payment-method-audit-logs-with-history-by-id" class="site-navigator__item site-navigator__submenu-item" data-title="Retrieve payment method audit logs with history by id">
                                  <span>Retrieve payment method audit logs with history by id</span>
                                </a>
                              </li>
                          </ul>
                      </li>
                  </ul>
              </li>
              <li>
                <a href="#subscription" class="site-navigator__item site-navigator__menu-item" data-title="Subscription">
                  <span>Subscription</span>
                </a>
                
                  <ul class="site-navigator__submenu">
                      <li class="site-navigator__submenu-container">
                        <a href="#subscription-resource" class="site-navigator__item site-navigator__submenu-item" data-title="Subscription Resource">
                          <span>Subscription Resource</span>
                        </a>

                      </li>
                      <li class="site-navigator__submenu-container">
                        <a href="#subscriptions" class="site-navigator__item site-navigator__submenu-item" data-title="Subscriptions">
                          <span>Subscriptions</span>
                        </a>

                          <ul class="site-navigator__submenu">
                              <li>
                                <a href="#create-a-subscription" class="site-navigator__item site-navigator__submenu-item" data-title="Create a subscription">
                                  <span>Create a subscription</span>
                                </a>
                              </li>
                              <li>
                                <a href="#create-a-subscription-with-addon-products" class="site-navigator__item site-navigator__submenu-item" data-title="Create a subscription with addon products">
                                  <span>Create a subscription with addon products</span>
                                </a>
                              </li>
                              <li>
                                <a href="#create-multiple-subscriptions-with-addon-products" class="site-navigator__item site-navigator__submenu-item" data-title="Create multiple subscriptions with addon products">
                                  <span>Create multiple subscriptions with addon products</span>
                                </a>
                              </li>
                              <li>
                                <a href="#retrieve-a-subscription-by-id" class="site-navigator__item site-navigator__submenu-item" data-title="Retrieve a subscription by id">
                                  <span>Retrieve a subscription by id</span>
                                </a>
                              </li>
                              <li>
                                <a href="#retrieve-a-subscription-by-key" class="site-navigator__item site-navigator__submenu-item" data-title="Retrieve a subscription by key">
                                  <span>Retrieve a subscription by key</span>
                                </a>
                              </li>
                              <li>
                                <a href="#update-the-bcd-associated-with-a-subscription" class="site-navigator__item site-navigator__submenu-item" data-title="Update the BCD associated with a subscription">
                                  <span>Update the BCD associated with a subscription</span>
                                </a>
                              </li>
                              <li>
                                <a href="#update-the-subscription-quantity" class="site-navigator__item site-navigator__submenu-item" data-title="Update the subscription quantity">
                                  <span>Update the subscription quantity</span>
                                </a>
                              </li>
                              <li>
                                <a href="#change-subscription-plan" class="site-navigator__item site-navigator__submenu-item" data-title="Change subscription plan">
                                  <span>Change subscription plan</span>
                                </a>
                              </li>
                              <li>
                                <a href="#undo-a-pending-change-plan-on-a-subscription" class="site-navigator__item site-navigator__submenu-item" data-title="Undo a pending change plan on a subscription">
                                  <span>Undo a pending change plan on a subscription</span>
                                </a>
                              </li>
                              <li>
                                <a href="#cancel-a-subscription" class="site-navigator__item site-navigator__submenu-item" data-title="Cancel a subscription">
                                  <span>Cancel a subscription</span>
                                </a>
                              </li>
                              <li>
                                <a href="#un-cancel-a-subscription" class="site-navigator__item site-navigator__submenu-item" data-title="Un-cancel a subscription">
                                  <span>Un-cancel a subscription</span>
                                </a>
                              </li>
                          </ul>
                      </li>
                      <li class="site-navigator__submenu-container">
                        <a href="#blocking-state" class="site-navigator__item site-navigator__submenu-item" data-title="Blocking State">
                          <span>Blocking State</span>
                        </a>

                          <ul class="site-navigator__submenu">
                              <li>
                                <a href="#block-a-subscription" class="site-navigator__item site-navigator__submenu-item" data-title="Block a subscription">
                                  <span>Block a subscription</span>
                                </a>
                              </li>
                          </ul>
                      </li>
                      <li class="site-navigator__submenu-container">
                        <a href="#custom-fields" class="site-navigator__item site-navigator__submenu-item" data-title="Custom Fields">
                          <span>Custom Fields</span>
                        </a>

                          <ul class="site-navigator__submenu">
                              <li>
                                <a href="#add-custom-fields-to-subscription" class="site-navigator__item site-navigator__submenu-item" data-title="Add custom fields to subscription">
                                  <span>Add custom fields to subscription</span>
                                </a>
                              </li>
                              <li>
                                <a href="#retrieve-subscription-custom-fields" class="site-navigator__item site-navigator__submenu-item" data-title="Retrieve subscription custom fields">
                                  <span>Retrieve subscription custom fields</span>
                                </a>
                              </li>
                              <li>
                                <a href="#modify-custom-fields-for-a-subscription" class="site-navigator__item site-navigator__submenu-item" data-title="Modify custom fields for a subscription">
                                  <span>Modify custom fields for a subscription</span>
                                </a>
                              </li>
                              <li>
                                <a href="#remove-custom-fields-from-subscription" class="site-navigator__item site-navigator__submenu-item" data-title="Remove custom fields from subscription">
                                  <span>Remove custom fields from subscription</span>
                                </a>
                              </li>
                          </ul>
                      </li>
                      <li class="site-navigator__submenu-container">
                        <a href="#tags" class="site-navigator__item site-navigator__submenu-item" data-title="Tags">
                          <span>Tags</span>
                        </a>

                          <ul class="site-navigator__submenu">
                              <li>
                                <a href="#add-tags-to-subscription" class="site-navigator__item site-navigator__submenu-item" data-title="Add tags to subscription">
                                  <span>Add tags to subscription</span>
                                </a>
                              </li>
                              <li>
                                <a href="#retrieve-subscription-tags" class="site-navigator__item site-navigator__submenu-item" data-title="Retrieve subscription tags">
                                  <span>Retrieve subscription tags</span>
                                </a>
                              </li>
                              <li>
                                <a href="#remove-tags-from-subscription" class="site-navigator__item site-navigator__submenu-item" data-title="Remove tags from subscription">
                                  <span>Remove tags from subscription</span>
                                </a>
                              </li>
                          </ul>
                      </li>
                      <li class="site-navigator__submenu-container">
                        <a href="#audit-logs" class="site-navigator__item site-navigator__submenu-item" data-title="Audit Logs">
                          <span>Audit Logs</span>
                        </a>

                          <ul class="site-navigator__submenu">
                              <li>
                                <a href="#retrieve-subscription-audit-logs-with-history-by-subscription-id" class="site-navigator__item site-navigator__submenu-item" data-title="Retrieve subscription audit logs with history by subscription id">
                                  <span>Retrieve subscription audit logs with history by subscription id</span>
                                </a>
                              </li>
                              <li>
                                <a href="#retrieve-subscription-event-audit-logs-with-history-by-subscription-event-id" class="site-navigator__item site-navigator__submenu-item" data-title="Retrieve subscription event audit logs with history by subscription event id">
                                  <span>Retrieve subscription event audit logs with history by subscription event id</span>
                                </a>
                              </li>
                          </ul>
                      </li>
                  </ul>
              </li>
              <li>
                <a href="bundle.html" class="site-navigator__item site-navigator__menu-item" data-title="Bundle">
                  <span>Bundle</span>
                </a>
                
                  <ul class="site-navigator__submenu">
                      <li class="site-navigator__submenu-container">
                        <a href="#bundle-resource" class="site-navigator__item site-navigator__submenu-item" data-title="Bundle Resource">
                          <span>Bundle Resource</span>
                        </a>

                      </li>
                      <li class="site-navigator__submenu-container">
                        <a href="#bundle-2" class="site-navigator__item site-navigator__submenu-item" data-title="Bundle">
                          <span>Bundle</span>
                        </a>

                          <ul class="site-navigator__submenu">
                              <li>
                                <a href="#retrieve-a-bundle-by-id" class="site-navigator__item site-navigator__submenu-item" data-title="Retrieve a bundle by id">
                                  <span>Retrieve a bundle by id</span>
                                </a>
                              </li>
                              <li>
                                <a href="#retrieve-a-bundle-by-external-key" class="site-navigator__item site-navigator__submenu-item" data-title="Retrieve a bundle by external key">
                                  <span>Retrieve a bundle by external key</span>
                                </a>
                              </li>
                              <li>
                                <a href="#update-a-bundle-external-key" class="site-navigator__item site-navigator__submenu-item" data-title="Update a bundle external key">
                                  <span>Update a bundle external key</span>
                                </a>
                              </li>
                          </ul>
                      </li>
                      <li class="site-navigator__submenu-container">
                        <a href="#transfer" class="site-navigator__item site-navigator__submenu-item" data-title="Transfer">
                          <span>Transfer</span>
                        </a>

                          <ul class="site-navigator__submenu">
                              <li>
                                <a href="#transfer-a-bundle-to-another-account" class="site-navigator__item site-navigator__submenu-item" data-title="Transfer a bundle to another account">
                                  <span>Transfer a bundle to another account</span>
                                </a>
                              </li>
                          </ul>
                      </li>
                      <li class="site-navigator__submenu-container">
                        <a href="#blocking-state" class="site-navigator__item site-navigator__submenu-item" data-title="Blocking State">
                          <span>Blocking State</span>
                        </a>

                          <ul class="site-navigator__submenu">
                              <li>
                                <a href="#pause-a-bundle" class="site-navigator__item site-navigator__submenu-item" data-title="Pause a bundle">
                                  <span>Pause a bundle</span>
                                </a>
                              </li>
                              <li>
                                <a href="#resume-a-bundle" class="site-navigator__item site-navigator__submenu-item" data-title="Resume a bundle">
                                  <span>Resume a bundle</span>
                                </a>
                              </li>
                              <li>
                                <a href="#block-a-bundle" class="site-navigator__item site-navigator__submenu-item" data-title="Block a bundle">
                                  <span>Block a bundle</span>
                                </a>
                              </li>
                          </ul>
                      </li>
                      <li class="site-navigator__submenu-container">
                        <a href="#custom-fields" class="site-navigator__item site-navigator__submenu-item" data-title="Custom Fields">
                          <span>Custom Fields</span>
                        </a>

                          <ul class="site-navigator__submenu">
                              <li>
                                <a href="#add-custom-fields-to-bundle" class="site-navigator__item site-navigator__submenu-item" data-title="Add custom fields to bundle">
                                  <span>Add custom fields to bundle</span>
                                </a>
                              </li>
                              <li>
                                <a href="#retrieve-bundle-custom-fields" class="site-navigator__item site-navigator__submenu-item" data-title="Retrieve bundle custom fields">
                                  <span>Retrieve bundle custom fields</span>
                                </a>
                              </li>
                              <li>
                                <a href="#modify-custom-fields-for-a-bundle" class="site-navigator__item site-navigator__submenu-item" data-title="Modify custom fields for a bundle">
                                  <span>Modify custom fields for a bundle</span>
                                </a>
                              </li>
                              <li>
                                <a href="#remove-custom-fields-from-bundle" class="site-navigator__item site-navigator__submenu-item" data-title="Remove custom fields from bundle">
                                  <span>Remove custom fields from bundle</span>
                                </a>
                              </li>
                          </ul>
                      </li>
                      <li class="site-navigator__submenu-container">
                        <a href="#tags" class="site-navigator__item site-navigator__submenu-item" data-title="Tags">
                          <span>Tags</span>
                        </a>

                          <ul class="site-navigator__submenu">
                              <li>
                                <a href="#add-tags-to-bundle" class="site-navigator__item site-navigator__submenu-item" data-title="Add tags to bundle">
                                  <span>Add tags to bundle</span>
                                </a>
                              </li>
                              <li>
                                <a href="#retrieve-bundle-tags" class="site-navigator__item site-navigator__submenu-item" data-title="Retrieve bundle tags">
                                  <span>Retrieve bundle tags</span>
                                </a>
                              </li>
                              <li>
                                <a href="#remove-tags-from-bundle" class="site-navigator__item site-navigator__submenu-item" data-title="Remove tags from bundle">
                                  <span>Remove tags from bundle</span>
                                </a>
                              </li>
                          </ul>
                      </li>
                      <li class="site-navigator__submenu-container">
                        <a href="#audit-logs" class="site-navigator__item site-navigator__submenu-item" data-title="Audit Logs">
                          <span>Audit Logs</span>
                        </a>

                          <ul class="site-navigator__submenu">
                              <li>
                                <a href="#retrieve-bundle-audit-logs-with-history-by-bundle-id" class="site-navigator__item site-navigator__submenu-item" data-title="Retrieve bundle audit logs with history by bundle id">
                                  <span>Retrieve bundle audit logs with history by bundle id</span>
                                </a>
                              </li>
                          </ul>
                      </li>
                      <li class="site-navigator__submenu-container">
                        <a href="#list-search" class="site-navigator__item site-navigator__submenu-item" data-title="List/Search">
                          <span>List/Search</span>
                        </a>

                          <ul class="site-navigator__submenu">
                              <li>
                                <a href="#list-bundles" class="site-navigator__item site-navigator__submenu-item" data-title="List bundles">
                                  <span>List bundles</span>
                                </a>
                              </li>
                              <li>
                                <a href="#search-bundles" class="site-navigator__item site-navigator__submenu-item" data-title="Search bundles">
                                  <span>Search bundles</span>
                                </a>
                              </li>
                          </ul>
                      </li>
                  </ul>
              </li>
              <li>
                <a href="invoice.html" class="site-navigator__item site-navigator__menu-item" data-title="Invoice">
                  <span>Invoice</span>
                </a>
                
                  <ul class="site-navigator__submenu">
                      <li class="site-navigator__submenu-container">
                        <a href="#invoice-resource" class="site-navigator__item site-navigator__submenu-item" data-title="Invoice Resource">
                          <span>Invoice Resource</span>
                        </a>

                      </li>
                      <li class="site-navigator__submenu-container">
                        <a href="#invoiceitem-resource" class="site-navigator__item site-navigator__submenu-item" data-title="InvoiceItem Resource">
                          <span>InvoiceItem Resource</span>
                        </a>

                      </li>
                      <li class="site-navigator__submenu-container">
                        <a href="#invoicedryrun-resource" class="site-navigator__item site-navigator__submenu-item" data-title="InvoiceDryRun Resource">
                          <span>InvoiceDryRun Resource</span>
                        </a>

                      </li>
                      <li class="site-navigator__submenu-container">
                        <a href="#invoice-2" class="site-navigator__item site-navigator__submenu-item" data-title="Invoice">
                          <span>Invoice</span>
                        </a>

                          <ul class="site-navigator__submenu">
                              <li>
                                <a href="#trigger-an-invoice-run" class="site-navigator__item site-navigator__submenu-item" data-title="Trigger an invoice run">
                                  <span>Trigger an invoice run</span>
                                </a>
                              </li>
                              <li>
                                <a href="#create-a-migration-invoice" class="site-navigator__item site-navigator__submenu-item" data-title="Create a migration invoice">
                                  <span>Create a migration invoice</span>
                                </a>
                              </li>
                              <li>
                                <a href="#create-external-charge-s" class="site-navigator__item site-navigator__submenu-item" data-title="Create external charge(s)">
                                  <span>Create external charge(s)</span>
                                </a>
                              </li>
                              <li>
                                <a href="#create-tax-items" class="site-navigator__item site-navigator__submenu-item" data-title="Create tax items">
                                  <span>Create tax items</span>
                                </a>
                              </li>
                              <li>
                                <a href="#retrieve-an-invoice-by-id" class="site-navigator__item site-navigator__submenu-item" data-title="Retrieve an invoice by id">
                                  <span>Retrieve an invoice by id</span>
                                </a>
                              </li>
                              <li>
                                <a href="#retrieve-an-invoice-by-number" class="site-navigator__item site-navigator__submenu-item" data-title="Retrieve an invoice by number">
                                  <span>Retrieve an invoice by number</span>
                                </a>
                              </li>
                              <li>
                                <a href="#retrieve-an-invoice-by-invoice-item-id" class="site-navigator__item site-navigator__submenu-item" data-title="Retrieve an invoice by invoice item id">
                                  <span>Retrieve an invoice by invoice item id</span>
                                </a>
                              </li>
                              <li>
                                <a href="#render-an-invoice-as-html" class="site-navigator__item site-navigator__submenu-item" data-title="Render an invoice as HTML">
                                  <span>Render an invoice as HTML</span>
                                </a>
                              </li>
                              <li>
                                <a href="#change-invoice-status-from-draft-to-committed" class="site-navigator__item site-navigator__submenu-item" data-title="Change invoice status from DRAFT to COMMITTED">
                                  <span>Change invoice status from DRAFT to COMMITTED</span>
                                </a>
                              </li>
                              <li>
                                <a href="#void-an-invoice" class="site-navigator__item site-navigator__submenu-item" data-title="Void an invoice">
                                  <span>Void an invoice</span>
                                </a>
                              </li>
                              <li>
                                <a href="#adjust-an-invoice-item" class="site-navigator__item site-navigator__submenu-item" data-title="Adjust an invoice item">
                                  <span>Adjust an invoice item</span>
                                </a>
                              </li>
                              <li>
                                <a href="#delete-a-cba-item" class="site-navigator__item site-navigator__submenu-item" data-title="Delete a CBA item">
                                  <span>Delete a CBA item</span>
                                </a>
                              </li>
                          </ul>
                      </li>
                      <li class="site-navigator__submenu-container">
                        <a href="#dry-run" class="site-navigator__item site-navigator__submenu-item" data-title="Dry-run">
                          <span>Dry-run</span>
                        </a>

                          <ul class="site-navigator__submenu">
                              <li>
                                <a href="#generate-a-dry-run-invoice" class="site-navigator__item site-navigator__submenu-item" data-title="Generate a dry run invoice">
                                  <span>Generate a dry run invoice</span>
                                </a>
                              </li>
                          </ul>
                      </li>
                      <li class="site-navigator__submenu-container">
                        <a href="#invoice-groups" class="site-navigator__item site-navigator__submenu-item" data-title="Invoice Groups">
                          <span>Invoice Groups</span>
                        </a>

                          <ul class="site-navigator__submenu">
                              <li>
                                <a href="#trigger-an-invoice-group-run" class="site-navigator__item site-navigator__submenu-item" data-title="Trigger an invoice group run">
                                  <span>Trigger an invoice group run</span>
                                </a>
                              </li>
                              <li>
                                <a href="#retrieve-an-invoice-group" class="site-navigator__item site-navigator__submenu-item" data-title="Retrieve an invoice group">
                                  <span>Retrieve an invoice group</span>
                                </a>
                              </li>
                          </ul>
                      </li>
                      <li class="site-navigator__submenu-container">
                        <a href="#payments" class="site-navigator__item site-navigator__submenu-item" data-title="Payments">
                          <span>Payments</span>
                        </a>

                          <ul class="site-navigator__submenu">
                              <li>
                                <a href="#trigger-a-payment-for-an-invoice" class="site-navigator__item site-navigator__submenu-item" data-title="Trigger a payment for an invoice">
                                  <span>Trigger a payment for an invoice</span>
                                </a>
                              </li>
                              <li>
                                <a href="#retrieve-payments-associated-with-an-invoice" class="site-navigator__item site-navigator__submenu-item" data-title="Retrieve payments associated with an invoice">
                                  <span>Retrieve payments associated with an invoice</span>
                                </a>
                              </li>
                          </ul>
                      </li>
                      <li class="site-navigator__submenu-container">
                        <a href="#custom-fields" class="site-navigator__item site-navigator__submenu-item" data-title="Custom Fields">
                          <span>Custom Fields</span>
                        </a>

                          <ul class="site-navigator__submenu">
                              <li>
                                <a href="#add-custom-fields-to-an-invoice" class="site-navigator__item site-navigator__submenu-item" data-title="Add custom fields to an invoice">
                                  <span>Add custom fields to an invoice</span>
                                </a>
                              </li>
                              <li>
                                <a href="#retrieve-invoice-custom-fields" class="site-navigator__item site-navigator__submenu-item" data-title="Retrieve invoice custom fields">
                                  <span>Retrieve invoice custom fields</span>
                                </a>
                              </li>
                              <li>
                                <a href="#modify-custom-fields-for-an-invoice" class="site-navigator__item site-navigator__submenu-item" data-title="Modify custom fields for an invoice">
                                  <span>Modify custom fields for an invoice</span>
                                </a>
                              </li>
                              <li>
                                <a href="#remove-custom-fields-from-invoice" class="site-navigator__item site-navigator__submenu-item" data-title="Remove custom fields from invoice">
                                  <span>Remove custom fields from invoice</span>
                                </a>
                              </li>
                          </ul>
                      </li>
                      <li class="site-navigator__submenu-container">
                        <a href="#tags" class="site-navigator__item site-navigator__submenu-item" data-title="Tags">
                          <span>Tags</span>
                        </a>

                          <ul class="site-navigator__submenu">
                              <li>
                                <a href="#add-tags-to-invoice" class="site-navigator__item site-navigator__submenu-item" data-title="Add tags to invoice">
                                  <span>Add tags to invoice</span>
                                </a>
                              </li>
                              <li>
                                <a href="#retrieve-invoice-tags" class="site-navigator__item site-navigator__submenu-item" data-title="Retrieve invoice tags">
                                  <span>Retrieve invoice tags</span>
                                </a>
                              </li>
                              <li>
                                <a href="#remove-tags-from-invoice" class="site-navigator__item site-navigator__submenu-item" data-title="Remove tags from invoice">
                                  <span>Remove tags from invoice</span>
                                </a>
                              </li>
                          </ul>
                      </li>
                      <li class="site-navigator__submenu-container">
                        <a href="#translation" class="site-navigator__item site-navigator__submenu-item" data-title="Translation">
                          <span>Translation</span>
                        </a>

                          <ul class="site-navigator__submenu">
                              <li>
                                <a href="#upload-the-catalog-translation-for-the-tenant" class="site-navigator__item site-navigator__submenu-item" data-title="Upload the catalog translation for the tenant">
                                  <span>Upload the catalog translation for the tenant</span>
                                </a>
                              </li>
                              <li>
                                <a href="#retrieve-the-catalog-translation-for-the-tenant" class="site-navigator__item site-navigator__submenu-item" data-title="Retrieve the catalog translation for the tenant">
                                  <span>Retrieve the catalog translation for the tenant</span>
                                </a>
                              </li>
                              <li>
                                <a href="#upload-the-invoice-translation-for-the-tenant" class="site-navigator__item site-navigator__submenu-item" data-title="Upload the invoice translation for the tenant">
                                  <span>Upload the invoice translation for the tenant</span>
                                </a>
                              </li>
                              <li>
                                <a href="#retrieve-the-invoice-translation-for-the-tenant" class="site-navigator__item site-navigator__submenu-item" data-title="Retrieve the invoice translation for the tenant">
                                  <span>Retrieve the invoice translation for the tenant</span>
                                </a>
                              </li>
                          </ul>
                      </li>
                      <li class="site-navigator__submenu-container">
                        <a href="#template" class="site-navigator__item site-navigator__submenu-item" data-title="Template">
                          <span>Template</span>
                        </a>

                          <ul class="site-navigator__submenu">
                              <li>
                                <a href="#upload-the-manualpay-invoice-template-for-the-tenant" class="site-navigator__item site-navigator__submenu-item" data-title="Upload the manualPay invoice template for the tenant">
                                  <span>Upload the manualPay invoice template for the tenant</span>
                                </a>
                              </li>
                              <li>
                                <a href="#retrieve-the-manualpay-invoice-template-for-the-tenant" class="site-navigator__item site-navigator__submenu-item" data-title="Retrieve the manualPay invoice template for the tenant">
                                  <span>Retrieve the manualPay invoice template for the tenant</span>
                                </a>
                              </li>
                              <li>
                                <a href="#upload-the-invoice-template-for-the-tenant" class="site-navigator__item site-navigator__submenu-item" data-title="Upload the invoice template for the tenant">
                                  <span>Upload the invoice template for the tenant</span>
                                </a>
                              </li>
                              <li>
                                <a href="#retrieve-the-invoice-template-for-the-tenant" class="site-navigator__item site-navigator__submenu-item" data-title="Retrieve the invoice template for the tenant">
                                  <span>Retrieve the invoice template for the tenant</span>
                                </a>
                              </li>
                          </ul>
                      </li>
                      <li class="site-navigator__submenu-container">
                        <a href="#example" class="site-navigator__item site-navigator__submenu-item" data-title="Example">
                          <span>Example</span>
                        </a>

                      </li>
                      <li class="site-navigator__submenu-container">
                        <a href="#audit-logs" class="site-navigator__item site-navigator__submenu-item" data-title="Audit Logs">
                          <span>Audit Logs</span>
                        </a>

                          <ul class="site-navigator__submenu">
                              <li>
                                <a href="#retrieve-invoice-audit-logs-with-history-by-invoice-id" class="site-navigator__item site-navigator__submenu-item" data-title="Retrieve invoice audit logs with history by invoice id">
                                  <span>Retrieve invoice audit logs with history by invoice id</span>
                                </a>
                              </li>
                              <li>
                                <a href="#retrieve-invoice-item-audit-logs-with-history-by-invoice-item-id" class="site-navigator__item site-navigator__submenu-item" data-title="Retrieve invoice item audit logs with history by invoice item id">
                                  <span>Retrieve invoice item audit logs with history by invoice item id</span>
                                </a>
                              </li>
                              <li>
                                <a href="#retrieve-invoice-payment-audit-logs-with-history-by-invoice-payment-id" class="site-navigator__item site-navigator__submenu-item" data-title="Retrieve invoice payment audit logs with history by invoice payment id">
                                  <span>Retrieve invoice payment audit logs with history by invoice payment id</span>
                                </a>
                              </li>
                          </ul>
                      </li>
                      <li class="site-navigator__submenu-container">
                        <a href="#list-and-search" class="site-navigator__item site-navigator__submenu-item" data-title="List and Search">
                          <span>List and Search</span>
                        </a>

                          <ul class="site-navigator__submenu">
                              <li>
                                <a href="#list-invoices" class="site-navigator__item site-navigator__submenu-item" data-title="List invoices">
                                  <span>List invoices</span>
                                </a>
                              </li>
                              <li>
                                <a href="#search-invoices" class="site-navigator__item site-navigator__submenu-item" data-title="Search invoices">
                                  <span>Search invoices</span>
                                </a>
                              </li>
                          </ul>
                      </li>
                  </ul>
              </li>
              <li>
                <a href="credit.html" class="site-navigator__item site-navigator__menu-item" data-title="Credit">
                  <span>Credit</span>
                </a>
                
                  <ul class="site-navigator__submenu">
                      <li class="site-navigator__submenu-container">
                        <a href="#credit-resource" class="site-navigator__item site-navigator__submenu-item" data-title="Credit Resource">
                          <span>Credit Resource</span>
                        </a>

                      </li>
                      <li class="site-navigator__submenu-container">
                        <a href="#credit-2" class="site-navigator__item site-navigator__submenu-item" data-title="Credit">
                          <span>Credit</span>
                        </a>

                          <ul class="site-navigator__submenu">
                              <li>
                                <a href="#create-credits" class="site-navigator__item site-navigator__submenu-item" data-title="Create credits">
                                  <span>Create credits</span>
                                </a>
                              </li>
                              <li>
                                <a href="#retrieve-a-credit-by-id" class="site-navigator__item site-navigator__submenu-item" data-title="Retrieve a credit by id">
                                  <span>Retrieve a credit by id</span>
                                </a>
                              </li>
                          </ul>
                      </li>
                  </ul>
              </li>
              <li>
                <a href="payment.html" class="site-navigator__item site-navigator__menu-item" data-title="Payment">
                  <span>Payment</span>
                </a>
                
                  <ul class="site-navigator__submenu">
                      <li class="site-navigator__submenu-container">
                        <a href="#payment-resource" class="site-navigator__item site-navigator__submenu-item" data-title="Payment Resource">
                          <span>Payment Resource</span>
                        </a>

                      </li>
                      <li class="site-navigator__submenu-container">
                        <a href="#payments" class="site-navigator__item site-navigator__submenu-item" data-title="Payments">
                          <span>Payments</span>
                        </a>

                          <ul class="site-navigator__submenu">
                              <li>
                                <a href="#capture-an-existing-authorization-using-paymentid" class="site-navigator__item site-navigator__submenu-item" data-title="Capture an existing authorization [using paymentId]">
                                  <span>Capture an existing authorization [using paymentId]</span>
                                </a>
                              </li>
                              <li>
                                <a href="#capture-an-existing-authorization-using-paymentexternalkey" class="site-navigator__item site-navigator__submenu-item" data-title="Capture an existing authorization [using paymentExternalKey]">
                                  <span>Capture an existing authorization [using paymentExternalKey]</span>
                                </a>
                              </li>
                              <li>
                                <a href="#retrieve-a-payment-using-paymentid" class="site-navigator__item site-navigator__submenu-item" data-title="Retrieve a payment [using paymentId]">
                                  <span>Retrieve a payment [using paymentId]</span>
                                </a>
                              </li>
                              <li>
                                <a href="#retrieve-a-payment-using-paymentexternalkey" class="site-navigator__item site-navigator__submenu-item" data-title="Retrieve a payment [using paymentExternalKey]">
                                  <span>Retrieve a payment [using paymentExternalKey]</span>
                                </a>
                              </li>
                              <li>
                                <a href="#complete-an-existing-transaction-using-paymentid" class="site-navigator__item site-navigator__submenu-item" data-title="Complete an existing transaction [using paymentId]">
                                  <span>Complete an existing transaction [using paymentId]</span>
                                </a>
                              </li>
                              <li>
                                <a href="#complete-an-existing-transaction-using-paymentexternalkey" class="site-navigator__item site-navigator__submenu-item" data-title="Complete an existing transaction [using paymentExternalKey]">
                                  <span>Complete an existing transaction [using paymentExternalKey]</span>
                                </a>
                              </li>
                              <li>
                                <a href="#void-an-existing-payment-using-paymentid" class="site-navigator__item site-navigator__submenu-item" data-title="Void an existing payment [using paymentId]">
                                  <span>Void an existing payment [using paymentId]</span>
                                </a>
                              </li>
                              <li>
                                <a href="#void-an-existing-payment-using-paymentexternalkey" class="site-navigator__item site-navigator__submenu-item" data-title="Void an existing payment [using paymentExternalKey]">
                                  <span>Void an existing payment [using paymentExternalKey]</span>
                                </a>
                              </li>
                              <li>
                                <a href="#record-a-chargeback-using-paymentid" class="site-navigator__item site-navigator__submenu-item" data-title="Record a chargeback [using paymentId]">
                                  <span>Record a chargeback [using paymentId]</span>
                                </a>
                              </li>
                              <li>
                                <a href="#record-a-chargeback-using-paymentexternalkey" class="site-navigator__item site-navigator__submenu-item" data-title="Record a chargeback [using paymentExternalKey]">
                                  <span>Record a chargeback [using paymentExternalKey]</span>
                                </a>
                              </li>
                              <li>
                                <a href="#record-a-chargeback-reversal-using-paymentid" class="site-navigator__item site-navigator__submenu-item" data-title="Record a chargeback reversal [using paymentId]">
                                  <span>Record a chargeback reversal [using paymentId]</span>
                                </a>
                              </li>
                              <li>
                                <a href="#record-a-chargeback-reversal-using-paymentexternalkey" class="site-navigator__item site-navigator__submenu-item" data-title="Record a chargeback reversal [using paymentExternalKey]">
                                  <span>Record a chargeback reversal [using paymentExternalKey]</span>
                                </a>
                              </li>
                              <li>
                                <a href="#refund-an-existing-payment-using-paymentid" class="site-navigator__item site-navigator__submenu-item" data-title="Refund an existing payment [using paymentId]">
                                  <span>Refund an existing payment [using paymentId]</span>
                                </a>
                              </li>
                              <li>
                                <a href="#refund-an-existing-payment-using-paymentexternalkey" class="site-navigator__item site-navigator__submenu-item" data-title="Refund an existing payment [using paymentExternalKey]">
                                  <span>Refund an existing payment [using paymentExternalKey]</span>
                                </a>
                              </li>
                              <li>
                                <a href="#cancel-a-scheduled-payment-attempt-retry-using-transactionid" class="site-navigator__item site-navigator__submenu-item" data-title="Cancel a scheduled payment attempt retry [using transactionId]">
                                  <span>Cancel a scheduled payment attempt retry [using transactionId]</span>
                                </a>
                              </li>
                              <li>
                                <a href="#cancel-a-scheduled-payment-attempt-retry-using-transactionexternalkey" class="site-navigator__item site-navigator__submenu-item" data-title="Cancel a scheduled payment attempt retry [using transactionExternalKey]">
                                  <span>Cancel a scheduled payment attempt retry [using transactionExternalKey]</span>
                                </a>
                              </li>
                              <li>
                                <a href="#combo-api-to-create-a-new-payment-transaction-on-a-existing-or-not-account" class="site-navigator__item site-navigator__submenu-item" data-title="Combo api to create a new payment transaction on a existing (or not) account">
                                  <span>Combo api to create a new payment transaction on a existing (or not) account</span>
                                </a>
                              </li>
                          </ul>
                      </li>
                      <li class="site-navigator__submenu-container">
                        <a href="#custom-fields" class="site-navigator__item site-navigator__submenu-item" data-title="Custom Fields">
                          <span>Custom Fields</span>
                        </a>

                          <ul class="site-navigator__submenu">
                              <li>
                                <a href="#add-custom-fields-to-payment" class="site-navigator__item site-navigator__submenu-item" data-title="Add custom fields to payment">
                                  <span>Add custom fields to payment</span>
                                </a>
                              </li>
                              <li>
                                <a href="#retrieve-payment-custom-fields" class="site-navigator__item site-navigator__submenu-item" data-title="Retrieve payment custom fields">
                                  <span>Retrieve payment custom fields</span>
                                </a>
                              </li>
                              <li>
                                <a href="#modify-custom-fields-for-a-payment" class="site-navigator__item site-navigator__submenu-item" data-title="Modify custom fields for a payment">
                                  <span>Modify custom fields for a payment</span>
                                </a>
                              </li>
                              <li>
                                <a href="#remove-custom-fields-from-a-payment" class="site-navigator__item site-navigator__submenu-item" data-title="Remove custom fields from a payment">
                                  <span>Remove custom fields from a payment</span>
                                </a>
                              </li>
                          </ul>
                      </li>
                      <li class="site-navigator__submenu-container">
                        <a href="#tags" class="site-navigator__item site-navigator__submenu-item" data-title="Tags">
                          <span>Tags</span>
                        </a>

                          <ul class="site-navigator__submenu">
                              <li>
                                <a href="#add-tags-to-a-payment" class="site-navigator__item site-navigator__submenu-item" data-title="Add tags to a payment">
                                  <span>Add tags to a payment</span>
                                </a>
                              </li>
                              <li>
                                <a href="#retrieve-payment-tags" class="site-navigator__item site-navigator__submenu-item" data-title="Retrieve payment tags">
                                  <span>Retrieve payment tags</span>
                                </a>
                              </li>
                              <li>
                                <a href="#remove-tags-from-a-payment" class="site-navigator__item site-navigator__submenu-item" data-title="Remove tags from a payment">
                                  <span>Remove tags from a payment</span>
                                </a>
                              </li>
                          </ul>
                      </li>
                      <li class="site-navigator__submenu-container">
                        <a href="#audit-logs" class="site-navigator__item site-navigator__submenu-item" data-title="Audit Logs">
                          <span>Audit Logs</span>
                        </a>

                          <ul class="site-navigator__submenu">
                              <li>
                                <a href="#retrieve-payment-audit-logs-with-history-by-id" class="site-navigator__item site-navigator__submenu-item" data-title="Retrieve payment audit logs with history by id">
                                  <span>Retrieve payment audit logs with history by id</span>
                                </a>
                              </li>
                              <li>
                                <a href="#retrieve-payment-attempt-audit-logs-with-history-by-id" class="site-navigator__item site-navigator__submenu-item" data-title="Retrieve payment attempt audit logs with history by id">
                                  <span>Retrieve payment attempt audit logs with history by id</span>
                                </a>
                              </li>
                          </ul>
                      </li>
                      <li class="site-navigator__submenu-container">
                        <a href="#list-and-search" class="site-navigator__item site-navigator__submenu-item" data-title="List and Search">
                          <span>List and Search</span>
                        </a>

                          <ul class="site-navigator__submenu">
                              <li>
                                <a href="#get-payments" class="site-navigator__item site-navigator__submenu-item" data-title="Get payments">
                                  <span>Get payments</span>
                                </a>
                              </li>
                              <li>
                                <a href="#search-payments" class="site-navigator__item site-navigator__submenu-item" data-title="Search payments">
                                  <span>Search payments</span>
                                </a>
                              </li>
                          </ul>
                      </li>
                  </ul>
              </li>
              <li>
                <a href="payment-transaction.html" class="site-navigator__item site-navigator__menu-item" data-title="Payment Transaction">
                  <span>Payment Transaction</span>
                </a>
                
                  <ul class="site-navigator__submenu">
                      <li class="site-navigator__submenu-container">
                        <a href="#payment-transaction-resource" class="site-navigator__item site-navigator__submenu-item" data-title="Payment Transaction Resource">
                          <span>Payment Transaction Resource</span>
                        </a>

                      </li>
                      <li class="site-navigator__submenu-container">
                        <a href="#payment-transactions" class="site-navigator__item site-navigator__submenu-item" data-title="Payment Transactions">
                          <span>Payment Transactions</span>
                        </a>

                          <ul class="site-navigator__submenu">
                              <li>
                                <a href="#retrieve-a-payment-by-transaction-id" class="site-navigator__item site-navigator__submenu-item" data-title="Retrieve a payment by transaction id">
                                  <span>Retrieve a payment by transaction id</span>
                                </a>
                              </li>
                              <li>
                                <a href="#retrieve-a-payment-transaction-by-external-key" class="site-navigator__item site-navigator__submenu-item" data-title="Retrieve a payment transaction by external key">
                                  <span>Retrieve a payment transaction by external key</span>
                                </a>
                              </li>
                              <li>
                                <a href="#mark-a-pending-payment-transaction-as-succeeded-or-failed" class="site-navigator__item site-navigator__submenu-item" data-title="Mark a pending payment transaction as succeeded or failed">
                                  <span>Mark a pending payment transaction as succeeded or failed</span>
                                </a>
                              </li>
                          </ul>
                      </li>
                      <li class="site-navigator__submenu-container">
                        <a href="#audit-logs" class="site-navigator__item site-navigator__submenu-item" data-title="Audit Logs">
                          <span>Audit Logs</span>
                        </a>

                          <ul class="site-navigator__submenu">
                              <li>
                                <a href="#retrieve-payment-transaction-audit-logs-with-history-by-id" class="site-navigator__item site-navigator__submenu-item" data-title="Retrieve payment transaction audit logs with history by id">
                                  <span>Retrieve payment transaction audit logs with history by id</span>
                                </a>
                              </li>
                          </ul>
                      </li>
                      <li class="site-navigator__submenu-container">
                        <a href="#custom-fields" class="site-navigator__item site-navigator__submenu-item" data-title="Custom Fields">
                          <span>Custom Fields</span>
                        </a>

                          <ul class="site-navigator__submenu">
                              <li>
                                <a href="#add-custom-fields-to-payment-transaction" class="site-navigator__item site-navigator__submenu-item" data-title="Add custom fields to payment transaction">
                                  <span>Add custom fields to payment transaction</span>
                                </a>
                              </li>
                              <li>
                                <a href="#retrieve-payment-transaction-custom-fields" class="site-navigator__item site-navigator__submenu-item" data-title="Retrieve payment transaction custom fields">
                                  <span>Retrieve payment transaction custom fields</span>
                                </a>
                              </li>
                              <li>
                                <a href="#modify-custom-fields-for-a-payment-transaction" class="site-navigator__item site-navigator__submenu-item" data-title="Modify custom fields for a payment transaction">
                                  <span>Modify custom fields for a payment transaction</span>
                                </a>
                              </li>
                              <li>
                                <a href="#remove-custom-fields-from-a-payment-transaction" class="site-navigator__item site-navigator__submenu-item" data-title="Remove custom fields from a payment transaction">
                                  <span>Remove custom fields from a payment transaction</span>
                                </a>
                              </li>
                          </ul>
                      </li>
                      <li class="site-navigator__submenu-container">
                        <a href="#tags" class="site-navigator__item site-navigator__submenu-item" data-title="Tags">
                          <span>Tags</span>
                        </a>

                          <ul class="site-navigator__submenu">
                              <li>
                                <a href="#add-tags-to-a-payment-transaction" class="site-navigator__item site-navigator__submenu-item" data-title="Add tags to a payment transaction">
                                  <span>Add tags to a payment transaction</span>
                                </a>
                              </li>
                              <li>
                                <a href="#retrieve-payment-transaction-tags" class="site-navigator__item site-navigator__submenu-item" data-title="Retrieve payment transaction tags">
                                  <span>Retrieve payment transaction tags</span>
                                </a>
                              </li>
                              <li>
                                <a href="#remove-tags-from-a-payment-transaction" class="site-navigator__item site-navigator__submenu-item" data-title="Remove tags from a payment transaction">
                                  <span>Remove tags from a payment transaction</span>
                                </a>
                              </li>
                          </ul>
                      </li>
                  </ul>
              </li>
              <li>
                <a href="invoice-payment.html" class="site-navigator__item site-navigator__menu-item" data-title="Invoice Payment">
                  <span>Invoice Payment</span>
                </a>
                
                  <ul class="site-navigator__submenu">
                      <li class="site-navigator__submenu-container">
                        <a href="#invoice-payment-resource" class="site-navigator__item site-navigator__submenu-item" data-title="Invoice Payment Resource">
                          <span>Invoice Payment Resource</span>
                        </a>

                      </li>
                      <li class="site-navigator__submenu-container">
                        <a href="#invoice-payment-transaction-resource" class="site-navigator__item site-navigator__submenu-item" data-title="Invoice Payment Transaction Resource">
                          <span>Invoice Payment Transaction Resource</span>
                        </a>

                      </li>
                      <li class="site-navigator__submenu-container">
                        <a href="#invoice-payment-2" class="site-navigator__item site-navigator__submenu-item" data-title="Invoice Payment">
                          <span>Invoice Payment</span>
                        </a>

                          <ul class="site-navigator__submenu">
                              <li>
                                <a href="#retrieve-a-payment-by-id" class="site-navigator__item site-navigator__submenu-item" data-title="Retrieve a payment by id">
                                  <span>Retrieve a payment by id</span>
                                </a>
                              </li>
                              <li>
                                <a href="#refund-a-payment-and-adjust-the-invoice-if-needed" class="site-navigator__item site-navigator__submenu-item" data-title="Refund a payment, and adjust the invoice if needed">
                                  <span>Refund a payment, and adjust the invoice if needed</span>
                                </a>
                              </li>
                              <li>
                                <a href="#record-a-chargeback" class="site-navigator__item site-navigator__submenu-item" data-title="Record a chargeback">
                                  <span>Record a chargeback</span>
                                </a>
                              </li>
                              <li>
                                <a href="#record-a-chargeback-reversal" class="site-navigator__item site-navigator__submenu-item" data-title="Record a chargeback reversal">
                                  <span>Record a chargeback reversal</span>
                                </a>
                              </li>
                              <li>
                                <a href="#complete-an-existing-transaction" class="site-navigator__item site-navigator__submenu-item" data-title="Complete an existing transaction">
                                  <span>Complete an existing transaction</span>
                                </a>
                              </li>
                          </ul>
                      </li>
                      <li class="site-navigator__submenu-container">
                        <a href="#custom-fields" class="site-navigator__item site-navigator__submenu-item" data-title="Custom Fields">
                          <span>Custom Fields</span>
                        </a>

                          <ul class="site-navigator__submenu">
                              <li>
                                <a href="#add-custom-fields-to-invoice-payment" class="site-navigator__item site-navigator__submenu-item" data-title="Add custom fields to invoice payment">
                                  <span>Add custom fields to invoice payment</span>
                                </a>
                              </li>
                              <li>
                                <a href="#retrieve-invoice-payment-custom-fields" class="site-navigator__item site-navigator__submenu-item" data-title="Retrieve invoice payment custom fields">
                                  <span>Retrieve invoice payment custom fields</span>
                                </a>
                              </li>
                              <li>
                                <a href="#modify-custom-fields-for-an-invoice-payment" class="site-navigator__item site-navigator__submenu-item" data-title="Modify custom fields for an invoice payment">
                                  <span>Modify custom fields for an invoice payment</span>
                                </a>
                              </li>
                              <li>
                                <a href="#remove-custom-fields-from-an-invoice-payment" class="site-navigator__item site-navigator__submenu-item" data-title="Remove custom fields from an invoice payment">
                                  <span>Remove custom fields from an invoice payment</span>
                                </a>
                              </li>
                          </ul>
                      </li>
                      <li class="site-navigator__submenu-container">
                        <a href="#tags" class="site-navigator__item site-navigator__submenu-item" data-title="Tags">
                          <span>Tags</span>
                        </a>

                          <ul class="site-navigator__submenu">
                              <li>
                                <a href="#add-tags-to-an-invoice-payment" class="site-navigator__item site-navigator__submenu-item" data-title="Add tags to an invoice payment">
                                  <span>Add tags to an invoice payment</span>
                                </a>
                              </li>
                              <li>
                                <a href="#retrieve-invoice-payment-tags" class="site-navigator__item site-navigator__submenu-item" data-title="Retrieve invoice payment tags">
                                  <span>Retrieve invoice payment tags</span>
                                </a>
                              </li>
                              <li>
                                <a href="#remove-tags-from-an-invoice-payment" class="site-navigator__item site-navigator__submenu-item" data-title="Remove tags from an invoice payment">
                                  <span>Remove tags from an invoice payment</span>
                                </a>
                              </li>
                          </ul>
                      </li>
                      <li class="site-navigator__submenu-container">
                        <a href="#audit-logs" class="site-navigator__item site-navigator__submenu-item" data-title="Audit Logs">
                          <span>Audit Logs</span>
                        </a>

                          <ul class="site-navigator__submenu">
                              <li>
                                <a href="#retrieve-invoice-payment-audit-logs-with-history-by-id" class="site-navigator__item site-navigator__submenu-item" data-title="Retrieve invoice payment audit logs with history by id">
                                  <span>Retrieve invoice payment audit logs with history by id</span>
                                </a>
                              </li>
                          </ul>
                      </li>
                  </ul>
              </li>
              <li>
                <a href="usage.html" class="site-navigator__item site-navigator__menu-item" data-title="Usage">
                  <span>Usage</span>
                </a>
                
                  <ul class="site-navigator__submenu">
                      <li class="site-navigator__submenu-container">
                        <a href="#usage-resource" class="site-navigator__item site-navigator__submenu-item" data-title="Usage Resource">
                          <span>Usage Resource</span>
                        </a>

                      </li>
                      <li class="site-navigator__submenu-container">
                        <a href="#usage-2" class="site-navigator__item site-navigator__submenu-item" data-title="Usage">
                          <span>Usage</span>
                        </a>

                          <ul class="site-navigator__submenu">
                              <li>
                                <a href="#record-usage-for-a-subscription" class="site-navigator__item site-navigator__submenu-item" data-title="Record usage for a subscription">
                                  <span>Record usage for a subscription</span>
                                </a>
                              </li>
                              <li>
                                <a href="#retrieve-usage-for-a-subscription-and-unit-type" class="site-navigator__item site-navigator__submenu-item" data-title="Retrieve usage for a subscription and unit type">
                                  <span>Retrieve usage for a subscription and unit type</span>
                                </a>
                              </li>
                              <li>
                                <a href="#retrieve-usage-for-a-subscription" class="site-navigator__item site-navigator__submenu-item" data-title="Retrieve usage for a subscription">
                                  <span>Retrieve usage for a subscription</span>
                                </a>
                              </li>
                          </ul>
                      </li>
                  </ul>
              </li>
              <li>
                <a href="custom-field.html" class="site-navigator__item site-navigator__menu-item" data-title="Custom Field">
                  <span>Custom Field</span>
                </a>
                
                  <ul class="site-navigator__submenu">
                      <li class="site-navigator__submenu-container">
                        <a href="#custom-field-resource" class="site-navigator__item site-navigator__submenu-item" data-title="Custom Field  Resource">
                          <span>Custom Field  Resource</span>
                        </a>

                          <ul class="site-navigator__submenu">
                              <li>
                                <a href="#list-all-custom-fields" class="site-navigator__item site-navigator__submenu-item" data-title="List all custom fields">
                                  <span>List all custom fields</span>
                                </a>
                              </li>
                              <li>
                                <a href="#search-custom-fields-by-id" class="site-navigator__item site-navigator__submenu-item" data-title="Search custom fields by ID">
                                  <span>Search custom fields by ID</span>
                                </a>
                              </li>
                              <li>
                                <a href="#search-custom-fields-by-resource-type-name-and-optional-value" class="site-navigator__item site-navigator__submenu-item" data-title="Search custom fields by resource type, name, and optional value">
                                  <span>Search custom fields by resource type, name, and optional value</span>
                                </a>
                              </li>
                          </ul>
                      </li>
                      <li class="site-navigator__submenu-container">
                        <a href="#audit-logs" class="site-navigator__item site-navigator__submenu-item" data-title="Audit Logs">
                          <span>Audit Logs</span>
                        </a>

                          <ul class="site-navigator__submenu">
                              <li>
                                <a href="#retrieve-custom-field-audit-logs-with-history-by-custom-field-id" class="site-navigator__item site-navigator__submenu-item" data-title="Retrieve custom field audit logs with history by custom field id">
                                  <span>Retrieve custom field audit logs with history by custom field id</span>
                                </a>
                              </li>
                          </ul>
                      </li>
                  </ul>
              </li>
              <li>
                <a href="tag.html" class="site-navigator__item site-navigator__menu-item" data-title="Tag">
                  <span>Tag</span>
                </a>
                
                  <ul class="site-navigator__submenu">
                      <li class="site-navigator__submenu-container">
                        <a href="#tag-resource" class="site-navigator__item site-navigator__submenu-item" data-title="Tag  Resource">
                          <span>Tag  Resource</span>
                        </a>

                          <ul class="site-navigator__submenu">
                              <li>
                                <a href="#list-all-tags" class="site-navigator__item site-navigator__submenu-item" data-title="List all tags">
                                  <span>List all tags</span>
                                </a>
                              </li>
                              <li>
                                <a href="#search-tags" class="site-navigator__item site-navigator__submenu-item" data-title="Search tags">
                                  <span>Search tags</span>
                                </a>
                              </li>
                              <li>
                                <a href="#retrieve-tag-audit-logs" class="site-navigator__item site-navigator__submenu-item" data-title="Retrieve tag audit logs">
                                  <span>Retrieve tag audit logs</span>
                                </a>
                              </li>
                          </ul>
                      </li>
                  </ul>
              </li>
              <li>
                <a href="tag-definition.html" class="site-navigator__item site-navigator__menu-item" data-title="Tag Definition">
                  <span>Tag Definition</span>
                </a>
                
                  <ul class="site-navigator__submenu">
                      <li class="site-navigator__submenu-container">
                        <a href="#tag-definition-resource" class="site-navigator__item site-navigator__submenu-item" data-title="Tag Definition Resource">
                          <span>Tag Definition Resource</span>
                        </a>

                      </li>
                      <li class="site-navigator__submenu-container">
                        <a href="#tag-definition-2" class="site-navigator__item site-navigator__submenu-item" data-title="Tag Definition">
                          <span>Tag Definition</span>
                        </a>

                          <ul class="site-navigator__submenu">
                              <li>
                                <a href="#create-a-tag-definition" class="site-navigator__item site-navigator__submenu-item" data-title="Create a tag definition">
                                  <span>Create a tag definition</span>
                                </a>
                              </li>
                              <li>
                                <a href="#list-tag-definitions" class="site-navigator__item site-navigator__submenu-item" data-title="List tag definitions">
                                  <span>List tag definitions</span>
                                </a>
                              </li>
                              <li>
                                <a href="#retrieve-a-tag-definition-by-its-id" class="site-navigator__item site-navigator__submenu-item" data-title="Retrieve a tag definition by its ID">
                                  <span>Retrieve a tag definition by its ID</span>
                                </a>
                              </li>
                              <li>
                                <a href="#delete-a-tag-definition" class="site-navigator__item site-navigator__submenu-item" data-title="Delete a tag definition">
                                  <span>Delete a tag definition</span>
                                </a>
                              </li>
                          </ul>
                      </li>
                      <li class="site-navigator__submenu-container">
                        <a href="#audit-logs" class="site-navigator__item site-navigator__submenu-item" data-title="Audit Logs">
                          <span>Audit Logs</span>
                        </a>

                          <ul class="site-navigator__submenu">
                              <li>
                                <a href="#retrieve-tag-definition-audit-logs-with-history-by-id" class="site-navigator__item site-navigator__submenu-item" data-title="Retrieve tag definition audit logs with history by id">
                                  <span>Retrieve tag definition audit logs with history by id</span>
                                </a>
                              </li>
                          </ul>
                      </li>
                  </ul>
              </li>
              <li>
                <a href="admin.html" class="site-navigator__item site-navigator__menu-item" data-title="Admin">
                  <span>Admin</span>
                </a>
                
                  <ul class="site-navigator__submenu">
                      <li class="site-navigator__submenu-container">
                        <a href="#adminpayment-object" class="site-navigator__item site-navigator__submenu-item" data-title="AdminPayment object">
                          <span>AdminPayment object</span>
                        </a>

                      </li>
                      <li class="site-navigator__submenu-container">
                        <a href="#administrative-apis" class="site-navigator__item site-navigator__submenu-item" data-title="Administrative Apis">
                          <span>Administrative Apis</span>
                        </a>

                          <ul class="site-navigator__submenu">
                              <li>
                                <a href="#trigger-an-invoice-generation-for-all-parked-accounts" class="site-navigator__item site-navigator__submenu-item" data-title="Trigger an invoice generation for all parked accounts">
                                  <span>Trigger an invoice generation for all parked accounts</span>
                                </a>
                              </li>
                              <li>
                                <a href="#update-the-state-of-a-paymenttransaction-and-associated-payment" class="site-navigator__item site-navigator__submenu-item" data-title="Update the state of a paymentTransaction and associated payment">
                                  <span>Update the state of a paymentTransaction and associated payment</span>
                                </a>
                              </li>
                          </ul>
                      </li>
                      <li class="site-navigator__submenu-container">
                        <a href="#operational-apis" class="site-navigator__item site-navigator__submenu-item" data-title="Operational Apis">
                          <span>Operational Apis</span>
                        </a>

                          <ul class="site-navigator__submenu">
                              <li>
                                <a href="#invalidate-a-specific-cache-or-invalidate-all-caches" class="site-navigator__item site-navigator__submenu-item" data-title="Invalidate a specific cache, or invalidate all caches">
                                  <span>Invalidate a specific cache, or invalidate all caches</span>
                                </a>
                              </li>
                              <li>
                                <a href="#invalidate-caches-for-an-account" class="site-navigator__item site-navigator__submenu-item" data-title="Invalidate Caches for an Account">
                                  <span>Invalidate Caches for an Account</span>
                                </a>
                              </li>
                              <li>
                                <a href="#invalidate-caches-for-a-tenant" class="site-navigator__item site-navigator__submenu-item" data-title="Invalidate Caches for a Tenant">
                                  <span>Invalidate Caches for a Tenant</span>
                                </a>
                              </li>
                              <li>
                                <a href="#put-the-host-back-into-rotation" class="site-navigator__item site-navigator__submenu-item" data-title="Put the host back into rotation">
                                  <span>Put the host back into rotation</span>
                                </a>
                              </li>
                              <li>
                                <a href="#remove-a-server-from-the-rotation" class="site-navigator__item site-navigator__submenu-item" data-title="Remove a server from the rotation">
                                  <span>Remove a server from the rotation</span>
                                </a>
                              </li>
                          </ul>
                      </li>
                      <li class="site-navigator__submenu-container">
                        <a href="#low-level-view-apis" class="site-navigator__item site-navigator__submenu-item" data-title="Low Level View Apis">
                          <span>Low Level View Apis</span>
                        </a>

                          <ul class="site-navigator__submenu">
                              <li>
                                <a href="#get-queue-entries" class="site-navigator__item site-navigator__submenu-item" data-title="Get queue entries">
                                  <span>Get queue entries</span>
                                </a>
                              </li>
                          </ul>
                      </li>
                  </ul>
              </li>
          </ul>
            <ul class="site-navigator__footer">
                <li><a href="mailto:support@killbill.io">Report a doc problem </a></li>
            </ul>
        </nav>
      </div>

      <div class="page__content content">
        <h1 id='subscription'>Subscription</h1>
<p>A <code>Subscription</code> in Kill Bill entitles a customer to the use of a product or service for a period of time in exchange for a specified payment. Every subscription belongs to a <code>Bundle</code> that is associated with a given customer <code>Account</code>.</p>

<p>Subscriptions are created by specifying a <code>Plan</code> from the catalog, and an effective date on which to start. The Plan identifies the <code>Product</code> subscribed along with the terms of service and of billing. These attributes are used by the system to drive the generation of invoices. Kill Bill offers two parallel views of the subscription: one to track the entitlement, i.e the service associated with the subscription, and one to track the billing. These views address the following questions:</p>

<ul>
<li>Given a date, how much should we invoice ?</li>
<li>Given a date, is the service available to the customer? </li>
</ul>

<p>For most use cases, those two views are one and the same; the customer gets invoiced for what she consumes.</p>

<p>Please refer to our <a href="http://docs.killbill.io/latest/userguide_subscription.html">subscription manual</a> for more details.</p>
<h2 id='subscription-resource'>Subscription Resource</h2>
<p>The <code>Subscription</code> resource represents a subscription. The attributes contained in the subscription resource are the following:</p>

<table><thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Generated by</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><strong>accountId</strong></td>
<td>string</td>
<td>system</td>
<td>UUID for the account</td>
</tr>
<tr>
<td><strong>bundleId</strong></td>
<td>string</td>
<td>system</td>
<td>UUID for the bundle</td>
</tr>
<tr>
<td><strong>subscriptionId</strong></td>
<td>string</td>
<td>system</td>
<td>UUID for this subscription</td>
</tr>
<tr>
<td><strong>externalKey</strong></td>
<td>string</td>
<td>user</td>
<td>Optional external key for the subscription</td>
</tr>
<tr>
<td><strong>bundleExternalKey</strong></td>
<td>string</td>
<td>user</td>
<td>Optional external key for the bundle</td>
</tr>
<tr>
<td><strong>startDate</strong></td>
<td>date</td>
<td>user</td>
<td>Datetime the service (entitlement) starts</td>
</tr>
<tr>
<td><strong>productName</strong></td>
<td>string</td>
<td>user</td>
<td>Name of the product subscribed (from catalog)</td>
</tr>
<tr>
<td><strong>productCategory</strong></td>
<td>string</td>
<td>user</td>
<td>Product catgory (see notes below)</td>
</tr>
<tr>
<td><strong>billingPeriod</strong></td>
<td>string</td>
<td>user</td>
<td>Billing period (see notes below)</td>
</tr>
<tr>
<td><strong>phaseType</strong></td>
<td>string</td>
<td>user</td>
<td>Type of the current plan phase (see notes below)</td>
</tr>
<tr>
<td><strong>priceList</strong></td>
<td>string</td>
<td>user</td>
<td>Name of the current price list (from catalog)</td>
</tr>
<tr>
<td><strong>planName</strong></td>
<td>string</td>
<td>user</td>
<td>Name of the current plan (from catalog)</td>
</tr>
<tr>
<td><strong>state</strong></td>
<td>string</td>
<td>system</td>
<td>Current state of the subscription (see notes below)</td>
</tr>
<tr>
<td><strong>sourceType</strong></td>
<td>string</td>
<td>system</td>
<td>Kind of subscription (see notes below)</td>
</tr>
<tr>
<td><strong>cancelledDate</strong></td>
<td>date</td>
<td>user</td>
<td>Datetime when the service stopped, or will stop</td>
</tr>
<tr>
<td><strong>chargedThroughDate</strong></td>
<td>date</td>
<td>system</td>
<td>Date up to which the subscription has been invoiced (see notes below)</td>
</tr>
<tr>
<td><strong>billingStartDate</strong></td>
<td>date</td>
<td>user</td>
<td>Datetime on which the system starts invoicing</td>
</tr>
<tr>
<td><strong>billingEndDate</strong></td>
<td>date</td>
<td>user</td>
<td>Datetime on which the system ends invoicing</td>
</tr>
<tr>
<td><strong>billCycleDayLocal</strong></td>
<td>integer</td>
<td>user or system</td>
<td>Day of the month on which invoices are generated, if applicable (see notes below)</td>
</tr>
<tr>
<td><strong>events</strong></td>
<td>list</td>
<td>system</td>
<td>list of subscription events tracking what happened (see notes below)</td>
</tr>
<tr>
<td><strong>prices</strong></td>
<td>list</td>
<td>user</td>
<td>list of prices, one for each phase in the plan</td>
</tr>
<tr>
<td><strong>priceOverrides</strong></td>
<td>list</td>
<td>user</td>
<td>list of prices if this subscription has price overrides (see notes below)</td>
</tr>
<tr>
<td><strong>quantity</strong></td>
<td>integer</td>
<td>user</td>
<td>quantity of subscriptions (see notes below)</td>
</tr>
</tbody></table>

<p><strong>productCategory</strong>: possible values are BASE, ADD_ON, or STANDALONE</p>

<p><strong>billingPeriod</strong>: possible values are DAILY, WEEKLY, BIWEEKLY, THIRTY_DAYS, THIRTY_ONE_DAYS, SIXTY_DAYS, NINETY_DAYS, MONTHLY, BIMESTRIAL (bimonthly), QUARTERLY, TRIANNUAL, BIANNUAL, ANNUAL, SESQUIENNIAL, BIENNIAL, TRIENNIAL, or NO_BILLING_PERIOD</p>

<p><strong>phaseType</strong>: possible values are: TRIAL, DISCOUNT, FIXEDTERM, or EVERGREEN</p>

<p><strong>state</strong>: possible values are:</p>

<ul>
<li><code>PENDING</code>: The subscription is not yet created.</li>
<li><code>ACTIVE</code>: The subscription is currently active.</li>
<li><code>BLOCKED</code>: The subscription is currently paused.</li>
<li><code>CANCELLED</code>: The subscription has been cancelled.</li>
<li><code>EXPIRED</code>: The subscription has expired. This state is applicable only for subscriptions with a <code>FIXEDTERM</code> phase.</li>
</ul>

<p><strong>sourceType</strong>: possible values are NATIVE, MIGRATED, or TRANSFERRED </p>

<p><strong><code>chargedThroughDate</code></strong>: The date up to which the entitlement for this subscription has been invoiced. For <code>IN_ADVANCE</code> billing mode, this date will often be in the future; for <code>IN_ARREAR</code>, this date will often be in the past. For example,</p>

<ol>
<li><p>A subscription is billed each month, on the 15th, in advance. If we check on May 31, the <code>chargedThroughDate</code> will be June 15th, 15 days ahead. If the subscription is ended on May 31, a prorated credit will need to be issued.</p></li>
<li><p>A subscription is billed quarterly, in arrears, on the 10th of Feb., May, Aug., and Nov. If we check on Jul. 20, the <code>chargedThroughDate</code> will be May 10, over 2 months earlier. If the subscription is cancelled on Jul. 20, an additional invoice will need to be issued.</p></li>
</ol>

<p>These use cases assume that invoicing is up to date. If AUTO_INVOICING_OFF is set, invoicing relies on a manual process and may be late. In that situation the first use case may require a smaller credit or none at all, while the second case will have a larger amount to be billed to close out the subscription.</p>

<p><strong><code>billCycleDayLocal</code></strong>: this value is either the overridden subscription billCycleDay (in case of BCD change) or the value at the subscription, bundle or account level (depending on the catalog <a href="http://docs.killbill.io/latest/userguide_subscription.html#_billing_alignment_rules">billing alignments</a>). For <code>ACCOUNT</code> billing alignments, if the account level billCycleDay hasn&#39;t been set yet, the value returned would be null.</p>

<p><strong><code>Events</code></strong>: possible event types are START_ENTITLEMENT, START_BILLING, PAUSE_ENTITLEMENT, PAUSE_BILLING, RESUME_ENTITLEMENT, RESUME_BILLING, PHASE, CHANGE, STOP_ENTITLEMENT, STOP_BILLING, SERVICE_STATE_CHANGE</p>

<p><strong><code>priceOverrides</code></strong>:  List of overridden prices for specific plan phases. Can be specified to override the fixed/recurring price in the catalog for a particular phase. For example, suppose you are creating a subscription corresponding to a plan that has an <code>EVERGREEN</code> phase with a recurring price of <code>$100</code>. You can specify an overridden price of <code>200</code> while creating the subscription by specifying a <code>priceOverrides</code> object as follows:</p>
<div class="highlight"><pre class="highlight shell tab-shell"><code><span class="s2">"priceOverrides"</span>: <span class="o">[</span>
        <span class="o">{</span>
            <span class="s2">"planName"</span>: <span class="s2">"shotgun-monthly"</span>,
            <span class="s2">"phaseType"</span>: <span class="s2">"DISCOUNT"</span>,
            <span class="s2">"fixedPrice"</span>: null,
            <span class="s2">"recurringPrice"</span>: 150.00,
            <span class="s2">"usagePrices"</span>: <span class="o">[]</span>
        <span class="o">}</span>
</code></pre></div>
<p><strong>quantity</strong>: An integer value that specifies the quantity of subscription. The default value is 1. The corresponding invoice is generated as per the quantity. So if <code>price=$20/mo</code>, <code>quantity=$2</code> =&gt; <code>invoiceItem recurring amount=$40</code>.</p>
<h2 id='subscriptions'>Subscriptions</h2>
<p>These endpoints support the basic CRUD operations on Subscriptions.</p>
<h3 id='create-a-subscription'>Create a subscription</h3>
<p>This API creates a base product subscription. It also creates a bundle to contain the subscription. See <a href="bundle.html">Bundle</a> for further information.</p>

<p><strong>HTTP Request</strong> </p>

<p><code>POST http://127.0.0.1:8080/1.0/kb/subscriptions</code></p>

<blockquote>
<p>Example Request:</p>
</blockquote>
<div class="highlight"><pre class="highlight shell tab-shell"><code>
<span class="c"># With planName</span>
curl <span class="nt">-v</span> <span class="se">\</span>
    <span class="nt">-X</span> POST <span class="se">\</span>
    <span class="nt">-u</span> admin:password <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-ApiKey: bob"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-ApiSecret: lazar"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-CreatedBy: demo"</span> <span class="se">\</span>
    <span class="nt">-d</span> <span class="s1">'{ 
            "accountId": "581d86fc-7cfc-46f2-b6d4-4dbc1d98beb3",
            "externalKey": "somethingSpecial",
            "planName": "super-monthly"
        }'</span> <span class="se">\</span>
    <span class="s2">"http://127.0.0.1:8080/1.0/kb/subscriptions"</span> 

<span class="c"># With productName, productCategory and billingPeriod</span>

    curl <span class="nt">-v</span> <span class="se">\</span>
    <span class="nt">-X</span> POST <span class="se">\</span>
    <span class="nt">-u</span> admin:password <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-ApiKey: bob"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-ApiSecret: lazar"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-CreatedBy: demo"</span> <span class="se">\</span>
    <span class="nt">-d</span> <span class="s1">'{ 
          "accountId": "59afd9fe-e98d-4fb3-b5bf-21d4a2b036cd",
            "externalKey": "somethingSpecial", 
            "productName": "Test", 
            "productCategory": "BASE",  
            "billingPeriod": "MONTHLY",
            "priceList": "DEFAULT"
        }'</span> <span class="se">\</span>
    <span class="s2">"http://127.0.0.1:8080/1.0/kb/subscriptions"</span>    

<span class="c"># With priceOverrides</span>

    curl <span class="nt">-v</span> <span class="se">\</span>
    <span class="nt">-X</span> POST <span class="se">\</span>
    <span class="nt">-u</span> admin:password <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-ApiKey: bob"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-ApiSecret: lazar"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-CreatedBy: demo"</span> <span class="se">\</span>
    <span class="nt">-d</span> <span class="s1">'{ 
            "accountId": "187f9270-7aa0-4db5-81f7-857e8e59fd9a",
            "planName": "shotgun-monthly",
             "prices": [
        {
            "planName": "shotgun-monthly",
            "phaseType": "DISCOUNT",
            "fixedPrice": 150.00,
            "recurringPrice": null,
            "usagePrices": []
        },
        {
            "planName": "shotgun-monthly",
            "phaseType": "EVERGREEN",
            "fixedPrice": null,
            "recurringPrice": 400.00,
            "usagePrices": []
        }       
    ]
        }'</span> <span class="se">\</span>
    <span class="s2">"http://127.0.0.1:8080/1.0/kb/subscriptions"</span> 

<span class="c"># With Datetime</span>

curl <span class="nt">-v</span> <span class="se">\</span>
    <span class="nt">-X</span> POST <span class="se">\</span>
    <span class="nt">-u</span> admin:password <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-ApiKey: bob"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-ApiSecret: lazar"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-CreatedBy: demo"</span> <span class="se">\</span>
    <span class="nt">-d</span> <span class="s1">'{ 
            "accountId": "325fbe1c-7c35-4d96-a4e5-2cbaabe218c6",
            "planName": "pistol-monthly-notrial"
        }'</span> <span class="se">\</span>
    <span class="s2">"http://127.0.0.1:8080/1.0/kb/subscriptions?billingDate=2023-02-07T11:15&amp;entitlementDate=2023-02-07T11:15"</span> 

</code></pre></div><div class="highlight"><pre class="highlight java tab-java"><code><span class="kn">import</span> <span class="nn">org.killbill.billing.client.api.gen.SubscriptionApi</span><span class="o">;</span>
<span class="kd">protected</span> <span class="nc">SubscriptionApi</span> <span class="n">subscriptionApi</span><span class="o">;</span>

<span class="no">UUID</span> <span class="n">accountId</span> <span class="o">=</span> <span class="no">UUID</span><span class="o">.</span><span class="na">fromString</span><span class="o">(</span><span class="s">"905a0636-ab63-40c0-acd4-b461b6808b5d"</span><span class="o">);</span>

<span class="nc">Subscription</span> <span class="n">input</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Subscription</span><span class="o">();</span>
<span class="n">input</span><span class="o">.</span><span class="na">setAccountId</span><span class="o">(</span><span class="n">accountId</span><span class="o">);</span>
<span class="n">input</span><span class="o">.</span><span class="na">setExternalKey</span><span class="o">(</span><span class="s">"somethingSpecial"</span><span class="o">);</span>
<span class="n">input</span><span class="o">.</span><span class="na">setPlanName</span><span class="o">(</span><span class="s">"shotgun-monthly"</span><span class="o">);</span>

<span class="nc">LocalDate</span> <span class="n">entitlementDate</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
<span class="nc">LocalDate</span> <span class="n">billingDate</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
<span class="nc">Boolean</span> <span class="n">renameKeyIfExistsAndUnused</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span> 
<span class="nc">Boolean</span> <span class="n">migrated</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
<span class="nc">Boolean</span> <span class="n">skipResponse</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>
<span class="nc">Boolean</span> <span class="n">callCompletion</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>
<span class="kt">long</span> <span class="no">DEFAULT_WAIT_COMPLETION_TIMEOUT_SEC</span> <span class="o">=</span> <span class="mi">10</span><span class="o">;</span>
<span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">String</span><span class="o">&gt;</span> <span class="no">NULL_PLUGIN_PROPERTIES</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>

<span class="nc">Subscription</span> <span class="n">subscription</span> <span class="o">=</span> <span class="n">subscriptionApi</span><span class="o">.</span><span class="na">createSubscription</span><span class="o">(</span><span class="n">input</span><span class="o">,</span> 
                                                               <span class="n">entitlementDate</span><span class="o">,</span> 
                                                               <span class="n">billingDate</span><span class="o">,</span> 
                                                               <span class="n">renameKeyIfExistsAndUnused</span><span class="o">,</span> 
                                                               <span class="n">migrated</span><span class="o">,</span>
                                                               <span class="n">skipResponse</span><span class="o">,</span>  
                                                               <span class="n">callCompletion</span><span class="o">,</span> 
                                                               <span class="no">DEFAULT_WAIT_COMPLETION_TIMEOUT_SEC</span><span class="o">,</span> 
                                                               <span class="no">NULL_PLUGIN_PROPERTIES</span><span class="o">,</span> 
                                                               <span class="n">requestOptions</span><span class="o">);</span>
</code></pre></div><div class="highlight"><pre class="highlight ruby tab-ruby"><code><span class="n">user</span> <span class="o">=</span> <span class="s2">"demo"</span>
<span class="n">reason</span> <span class="o">=</span> <span class="kp">nil</span>
<span class="n">comment</span> <span class="o">=</span> <span class="kp">nil</span>

<span class="n">subscription</span> <span class="o">=</span> <span class="no">KillBillClient</span><span class="o">::</span><span class="no">Model</span><span class="o">::</span><span class="no">Subscription</span><span class="p">.</span><span class="nf">new</span>
<span class="n">subscription</span><span class="p">.</span><span class="nf">account_id</span> <span class="o">=</span> <span class="s2">"e1826665-4524-4d57-81b5-a5eb11146f3f"</span>
<span class="n">subscription</span><span class="p">.</span><span class="nf">plan_name</span> <span class="o">=</span> <span class="s2">"basic-monthly-in-advance"</span>

<span class="n">requested_date</span>  <span class="o">=</span> <span class="kp">nil</span>
<span class="n">call_completion</span> <span class="o">=</span> <span class="kp">nil</span> 

<span class="n">subscription</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="n">user</span><span class="p">,</span> 
                    <span class="n">reason</span><span class="p">,</span> 
                    <span class="n">comment</span><span class="p">,</span> 
                    <span class="n">requested_date</span><span class="p">,</span> 
                    <span class="n">call_completion</span><span class="p">,</span> 
                    <span class="n">options</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="n">subscriptionApi</span> <span class="o">=</span> <span class="n">killbill</span><span class="p">.</span><span class="n">api</span><span class="p">.</span><span class="n">SubscriptionApi</span><span class="p">()</span>
<span class="n">account_id</span> <span class="o">=</span> <span class="s">'32660591-b8a0-4a0e-b6a8-9b52611217c2'</span>
<span class="n">body</span> <span class="o">=</span> <span class="n">Subscription</span><span class="p">(</span><span class="n">account_id</span><span class="o">=</span><span class="n">account_id</span><span class="p">,</span> <span class="n">plan_name</span><span class="o">=</span><span class="s">'pistol-monthly'</span><span class="p">)</span>

<span class="n">subscriptionApi</span><span class="p">.</span><span class="n">create_subscription</span><span class="p">(</span><span class="n">body</span><span class="p">,</span> 
                                    <span class="n">created_by</span><span class="o">=</span><span class="s">'demo'</span><span class="p">,</span>
                                    <span class="n">reason</span><span class="o">=</span><span class="s">'reason'</span><span class="p">,</span> 
                                    <span class="n">comment</span><span class="o">=</span><span class="s">'comment'</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">const</span> <span class="nx">api</span><span class="p">:</span> <span class="nx">killbill</span><span class="p">.</span><span class="nx">SubscriptionApi</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">killbill</span><span class="p">.</span><span class="nx">SubscriptionApi</span><span class="p">(</span><span class="nx">config</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">subscription</span><span class="p">:</span> <span class="nx">Subscription</span> <span class="o">=</span> <span class="p">{</span><span class="na">planName</span><span class="p">:</span> <span class="dl">"</span><span class="s2">blowdart-monthly</span><span class="dl">"</span><span class="p">,</span> <span class="na">accountId</span><span class="p">:</span> <span class="dl">"</span><span class="s2">04779ade-11f9-48d1-88a1-a63be84d1cb7</span><span class="dl">"</span><span class="p">};</span>

<span class="nx">api</span><span class="p">.</span><span class="nx">createSubscription</span><span class="p">(</span><span class="nx">subscription</span><span class="p">,</span> <span class="dl">'</span><span class="s1">created_by</span><span class="dl">'</span><span class="p">);</span>
</code></pre></div><div class="highlight"><pre class="highlight php tab-php"><code><span class="nv">$apiInstance</span> <span class="o">=</span> <span class="nv">$client</span><span class="o">-&gt;</span><span class="nf">getSubscriptionApi</span><span class="p">();</span>

<span class="nv">$xKillbillCreatedBy</span> <span class="o">=</span> <span class="s2">"user"</span><span class="p">;</span>
<span class="nv">$xKillbillReason</span> <span class="o">=</span> <span class="s2">"reason"</span><span class="p">;</span>
<span class="nv">$xKillbillComment</span> <span class="o">=</span> <span class="s2">"comment"</span><span class="p">;</span>

<span class="nv">$body</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Subscription</span><span class="p">();</span>
<span class="nv">$body</span> <span class="o">-&gt;</span> <span class="nf">setAccountId</span><span class="p">(</span><span class="s1">'13102713-9672-4e3b-8b4f-e10869fc5a59'</span><span class="p">);</span>
<span class="nv">$body</span> <span class="o">-&gt;</span> <span class="nf">setPlanName</span><span class="p">(</span><span class="s1">'pistol-monthly'</span><span class="p">);</span>

<span class="nv">$entitlementDate</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
<span class="nv">$billingDate</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
<span class="nv">$renameKeyIfExistsAndUnused</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
<span class="nv">$migrated</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
<span class="nv">$skipResponse</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
<span class="nv">$callCompletion</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
<span class="nv">$callTimeoutSec</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
<span class="nv">$pluginProperty</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">"pluginProperty_example"</span><span class="p">);</span>

<span class="nv">$result</span> <span class="o">=</span> <span class="nv">$apiInstance</span><span class="o">-&gt;</span><span class="nf">createSubscription</span><span class="p">(</span><span class="nv">$body</span><span class="p">,</span> <span class="nv">$xKillbillCreatedBy</span><span class="p">,</span> <span class="nv">$xKillbillReason</span><span class="p">,</span> <span class="nv">$xKillbillComment</span><span class="p">,</span> <span class="nv">$entitlementDate</span><span class="p">,</span> <span class="nv">$billingDate</span><span class="p">,</span> <span class="nv">$renameKeyIfExistsAndUnused</span><span class="p">,</span> <span class="nv">$migrated</span><span class="p">,</span> <span class="nv">$skipResponse</span><span class="p">,</span> <span class="nv">$callCompletion</span><span class="p">,</span> <span class="nv">$callTimeoutSec</span><span class="p">,</span> <span class="nv">$pluginProperty</span><span class="p">);</span>
</code></pre></div>
<p><strong>Request Body</strong></p>

<p>A subscription resource object specifying <code>accountId</code> and either the <code>planName</code> or a combination of <code>productName</code>, <code>productCategory</code>,<code>billingPeriod</code> and <code>priceList</code>. </p>

<p>It can also include the following optional fields:</p>

<ul>
<li><code>phaseType</code> - Target phase type. Specifying this field causes the subscription to start with this phase.</li>
<li><code>externalKey</code> - External key corresponding to the subscription.</li>
<li><code>billCycleDayLocal</code> - Per-subscription BCD. Specifying this value allows realigning the billing with the specified date. </li>
<li><code>bundleId</code> - Id of the bundle in which to create this subscription. Can be specified only while invoking this method for an addon subscription.</li>
</ul>

<p><strong>Query Parameters</strong></p>

<table><thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Required</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><strong>entitlementDate</strong></td>
<td>string</td>
<td>no</td>
<td>immediately</td>
<td>Date/DateTime at which the entitlement (service) starts in <code>yyyy-mm-dd</code>/<code>yyyy-mm-ddThh:mm</code> format.</td>
</tr>
<tr>
<td><strong>billingDate</strong></td>
<td>string</td>
<td>no</td>
<td>immediately</td>
<td>Date/DateTime at which the entitlement (service) starts in <code>yyyy-mm-dd</code>/<code>yyyy-mm-ddThh:mm</code> format.</td>
</tr>
<tr>
<td><strong>renameKeyIfExistsAndUnused</strong></td>
<td>boolean</td>
<td>no</td>
<td>true</td>
<td>If true, rename external key if it exists and is unused</td>
</tr>
<tr>
<td><strong>migrated</strong></td>
<td>boolean</td>
<td>no</td>
<td>false</td>
<td>If true, subscription is migrated</td>
</tr>
<tr>
<td><strong>skipResponse</strong></td>
<td>boolean</td>
<td>no</td>
<td>false</td>
<td>TODO</td>
</tr>
<tr>
<td><strong>callCompletion</strong></td>
<td>boolean</td>
<td>no</td>
<td>false</td>
<td>see below</td>
</tr>
<tr>
<td><strong>callTimeoutSec</strong></td>
<td>long</td>
<td>no</td>
<td>unlimited?</td>
<td>Timeout in seconds (see below)</td>
</tr>
</tbody></table>

<p>Creating a subscription often triggers the creation of an invoice, and associated with this there is often a payment (against the invoice). If <strong>callCompletion</strong> is true, the call to this API will be delayed until the invoice is created and/or the payment is processed. However, the maximum delay in seconds will be given by <strong>callTimeoutSec</strong>.</p>

<p><strong>Other Notes:</strong></p>

<ul>
<li>Specifying the <code>startDate</code>/<code>billingStartDate</code> as part of the request body has no effect, these dates need to be passed as query parameters (<code>entitlementDate</code>/<code>billingDate</code>). </li>
<li>The <code>entitlementDate</code> drives the subscription state. So, if a subscription is created with a future <code>entitlementDate</code>, its state remains <code>PENDING</code> until the date is reached after which it becomes <code>ACTIVE</code>.</li>
</ul>

<p><strong>Response</strong></p>

<p>If successful, returns a status code of 201 and an empty body. In addition, a <code>Location</code> header is returned which contains the new subscription id.</p>
<h3 id='create-a-subscription-with-addon-products'>Create a subscription with addon products</h3>
<p>This API creates a subscription bundle with base and addon product subscriptions. It can also be used to add an addon subscription to a base subscription in which case the bundle id of the base subscription must be specified.</p>

<p><strong>HTTP Request</strong></p>

<p><code>POST http://127.0.0.1:8080/1.0/kb/subscriptions/createSubscriptionWithAddOns</code></p>

<blockquote>
<p>Example Request:</p>
</blockquote>
<div class="highlight"><pre class="highlight shell tab-shell"><code><span class="c"># create a subscription with addon</span>
curl <span class="nt">-v</span> <span class="se">\</span>
    <span class="nt">-X</span> POST <span class="se">\</span>
    <span class="nt">-u</span> admin:password <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-ApiKey: bob"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-ApiSecret: lazar"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-CreatedBy: demo"</span> <span class="se">\</span>
    <span class="nt">-d</span> <span class="s1">'[
          {
            "accountId": "581d86fc-7cfc-46f2-b6d4-4dbc1d98beb3",
            "externalKey": "something",
            "bundleExternalKey": "somethingAlso",
            "productName": "Sports",
            "productCategory": "BASE",
            "billingPeriod": "MONTHLY",
            "priceList": "DEFAULT"
        },
        {
          "accountId": "581d86fc-7cfc-46f2-b6d4-4dbc1d98beb3",
          "productName": "OilSlick",
          "productCategory": "ADD_ON",
          "billingPeriod": "MONTHLY",
          "priceList": "DEFAULT"
        }
        ]'</span> <span class="se">\</span>
    <span class="s1">'http://127.0.0.1:8080/1.0/kb/subscriptions/createSubscriptionWithAddOns'</span> 

OR

<span class="c"># create an addon on an existing base subscription</span>
curl <span class="nt">-v</span> <span class="se">\</span>
    <span class="nt">-X</span> POST <span class="se">\</span>
    <span class="nt">-u</span> admin:password <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-ApiKey: bob"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-ApiSecret: lazar"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-CreatedBy: demo"</span> <span class="se">\</span>
    <span class="nt">-d</span> <span class="s1">'[

        {
          "accountId": "1f635c3d-fc24-4fa8-81e0-ab646882807a",
          "planName": "remotecontrol-monthly",
          "bundleId":"b4709feb-bd14-455a-bbb4-57a758498791"
        }
        ]'</span> <span class="se">\</span>
    <span class="s1">'http://127.0.0.1:8080/1.0/kb/subscriptions/createSubscriptionWithAddOns'</span>   

</code></pre></div><div class="highlight"><pre class="highlight java tab-java"><code><span class="kn">import</span> <span class="nn">org.killbill.billing.client.api.gen.SubscriptionApi</span><span class="o">;</span>
<span class="kd">protected</span> <span class="nc">SubscriptionApi</span> <span class="n">subscriptionApi</span><span class="o">;</span>

<span class="no">UUID</span> <span class="n">accountId</span> <span class="o">=</span> <span class="no">UUID</span><span class="o">.</span><span class="na">fromString</span><span class="o">(</span><span class="s">"abfba40d-d2dd-47f0-94f2-8ea3e6bc8794"</span><span class="o">);</span>

<span class="nc">Subscription</span> <span class="n">base</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Subscription</span><span class="o">();</span>
<span class="n">base</span><span class="o">.</span><span class="na">setAccountId</span><span class="o">(</span><span class="n">accountId</span><span class="o">);</span>
<span class="n">base</span><span class="o">.</span><span class="na">setExternalKey</span><span class="o">(</span><span class="s">"base"</span><span class="o">);</span>
<span class="n">base</span><span class="o">.</span><span class="na">setProductName</span><span class="o">(</span><span class="s">"Shotgun"</span><span class="o">);</span>
<span class="n">base</span><span class="o">.</span><span class="na">setProductCategory</span><span class="o">(</span><span class="nc">ProductCategory</span><span class="o">.</span><span class="na">BASE</span><span class="o">);</span>
<span class="n">base</span><span class="o">.</span><span class="na">setBillingPeriod</span><span class="o">(</span><span class="nc">BillingPeriod</span><span class="o">.</span><span class="na">MONTHLY</span><span class="o">);</span>
<span class="n">base</span><span class="o">.</span><span class="na">setPriceList</span><span class="o">(</span><span class="s">"DEFAULT"</span><span class="o">);</span>

<span class="kd">final</span> <span class="nc">Subscription</span> <span class="n">addOn1</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Subscription</span><span class="o">();</span>
<span class="n">addOn1</span><span class="o">.</span><span class="na">setAccountId</span><span class="o">(</span><span class="n">accountId</span><span class="o">);</span>
<span class="n">addOn1</span><span class="o">.</span><span class="na">setProductName</span><span class="o">(</span><span class="s">"Telescopic-Scope"</span><span class="o">);</span>
<span class="n">addOn1</span><span class="o">.</span><span class="na">setProductCategory</span><span class="o">(</span><span class="nc">ProductCategory</span><span class="o">.</span><span class="na">ADD_ON</span><span class="o">);</span>
<span class="n">addOn1</span><span class="o">.</span><span class="na">setBillingPeriod</span><span class="o">(</span><span class="nc">BillingPeriod</span><span class="o">.</span><span class="na">MONTHLY</span><span class="o">);</span>
<span class="n">addOn1</span><span class="o">.</span><span class="na">setPriceList</span><span class="o">(</span><span class="s">"DEFAULT"</span><span class="o">);</span>

<span class="kd">final</span> <span class="nc">Subscription</span> <span class="n">addOn2</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Subscription</span><span class="o">();</span>
<span class="n">addOn2</span><span class="o">.</span><span class="na">setAccountId</span><span class="o">(</span><span class="n">accountId</span><span class="o">);</span>
<span class="n">addOn2</span><span class="o">.</span><span class="na">setProductName</span><span class="o">(</span><span class="s">"Laser-Scope"</span><span class="o">);</span>
<span class="n">addOn2</span><span class="o">.</span><span class="na">setProductCategory</span><span class="o">(</span><span class="nc">ProductCategory</span><span class="o">.</span><span class="na">ADD_ON</span><span class="o">);</span>
<span class="n">addOn2</span><span class="o">.</span><span class="na">setBillingPeriod</span><span class="o">(</span><span class="nc">BillingPeriod</span><span class="o">.</span><span class="na">MONTHLY</span><span class="o">);</span>
<span class="n">addOn2</span><span class="o">.</span><span class="na">setPriceList</span><span class="o">(</span><span class="s">"DEFAULT"</span><span class="o">);</span>

<span class="kd">final</span> <span class="nc">Subscriptions</span> <span class="n">subscriptions</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Subscriptions</span><span class="o">();</span>
<span class="n">subscriptions</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">base</span><span class="o">);</span>
<span class="n">subscriptions</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">addOn1</span><span class="o">);</span>
<span class="n">subscriptions</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">addOn2</span><span class="o">);</span>

<span class="nc">LocalDate</span> <span class="n">entitlementDate</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
<span class="nc">LocalDate</span> <span class="n">billingDate</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
<span class="nc">Boolean</span> <span class="n">migrated</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
<span class="nc">Boolean</span> <span class="n">skipResponse</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>
<span class="nc">Boolean</span> <span class="n">renameKeyIfExistsAndUnused</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
<span class="nc">Boolean</span> <span class="n">callCompletion</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>
<span class="kt">long</span> <span class="no">DEFAULT_WAIT_COMPLETION_TIMEOUT_SEC</span> <span class="o">=</span> <span class="mi">10</span><span class="o">;</span>
<span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">String</span><span class="o">&gt;</span> <span class="no">NULL_PLUGIN_PROPERTIES</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>

<span class="kd">final</span> <span class="nc">Bundle</span> <span class="n">bundle</span> <span class="o">=</span> <span class="n">subscriptionApi</span><span class="o">.</span><span class="na">createSubscriptionWithAddOns</span><span class="o">(</span><span class="n">subscriptions</span><span class="o">,</span> 
                                                                   <span class="n">entitlementDate</span><span class="o">,</span> 
                                                                   <span class="n">billingDate</span><span class="o">,</span> 
                                                                   <span class="n">migrated</span><span class="o">,</span> 
                                                                   <span class="n">skipResponse</span><span class="o">,</span>
                                                                   <span class="n">renameKeyIfExistsAndUnused</span><span class="o">,</span> 
                                                                   <span class="n">callCompletion</span><span class="o">,</span> 
                                                                   <span class="no">DEFAULT_WAIT_COMPLETION_TIMEOUT_SEC</span><span class="o">,</span> 
                                                                   <span class="no">NULL_PLUGIN_PROPERTIES</span><span class="o">,</span> 
                                                                   <span class="n">requestOptions</span><span class="o">);</span>
</code></pre></div><div class="highlight"><pre class="highlight ruby tab-ruby"><code><span class="n">user</span> <span class="o">=</span> <span class="s2">"demo"</span>
<span class="n">reason</span> <span class="o">=</span> <span class="kp">nil</span>
<span class="n">comment</span> <span class="o">=</span> <span class="kp">nil</span>

<span class="n">entitlement</span> <span class="o">=</span> <span class="p">[</span>
                <span class="p">{</span>
                    <span class="s2">"accountId"</span><span class="ss">:"e3a23520-2ce2-493a-a3c0-7fc08e554353"</span><span class="p">,</span>
                    <span class="s2">"productCategory"</span><span class="ss">:"BASE"</span><span class="p">,</span>
                    <span class="s2">"productName"</span><span class="ss">:"Shotgun"</span><span class="p">,</span>
                    <span class="s2">"billingPeriod"</span><span class="ss">:"MONTHLY"</span><span class="p">,</span>
                    <span class="s2">"priceList"</span><span class="ss">:"DEFAULT"</span>
                <span class="p">},</span>
                <span class="p">{</span>
                    <span class="s2">"accountId"</span><span class="ss">:"e3a23520-2ce2-493a-a3c0-7fc08e554353"</span><span class="p">,</span>
                    <span class="s2">"productCategory"</span><span class="ss">:"ADD_ON"</span><span class="p">,</span>
                    <span class="s2">"productName"</span><span class="ss">:"Telescopic-Scope"</span><span class="p">,</span>
                    <span class="s2">"billingPeriod"</span><span class="ss">:"MONTHLY"</span><span class="p">,</span>
                    <span class="s2">"priceList"</span><span class="ss">:"DEFAULT"</span>
                <span class="p">}</span>
             <span class="p">]</span>

<span class="n">requested_date</span> <span class="o">=</span> <span class="kp">nil</span>
<span class="n">entitlement_date</span> <span class="o">=</span> <span class="kp">nil</span>
<span class="n">billing_date</span> <span class="o">=</span> <span class="kp">nil</span>
<span class="n">migrated</span> <span class="o">=</span> <span class="kp">false</span>
<span class="n">call_completion_sec</span> <span class="o">=</span> <span class="mi">3</span>

<span class="n">subscription</span> <span class="o">=</span> <span class="no">KillBillClient</span><span class="o">::</span><span class="no">Model</span><span class="o">::</span><span class="no">Subscription</span><span class="p">.</span><span class="nf">new</span>
<span class="n">subscription</span><span class="p">.</span><span class="nf">create_entitlement_with_add_on</span><span class="p">(</span><span class="n">entitlement</span><span class="p">,</span>
                                            <span class="n">requested_date</span><span class="p">,</span>
                                            <span class="n">entitlement_date</span><span class="p">,</span>
                                            <span class="n">billing_date</span><span class="p">,</span>
                                            <span class="n">migrated</span><span class="p">,</span>
                                            <span class="n">call_completion_sec</span><span class="p">,</span>
                                            <span class="n">user</span><span class="p">,</span>
                                            <span class="n">reason</span><span class="p">,</span>
                                            <span class="n">comment</span><span class="p">,</span>
                                            <span class="n">options</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="n">subscriptionApi</span> <span class="o">=</span> <span class="n">killbill</span><span class="p">.</span><span class="n">api</span><span class="p">.</span><span class="n">SubscriptionApi</span><span class="p">()</span>
<span class="n">account_id</span> <span class="o">=</span> <span class="s">'32660591-b8a0-4a0e-b6a8-9b52611217c2'</span>
<span class="n">subscription_a</span> <span class="o">=</span> <span class="n">Subscription</span><span class="p">(</span><span class="n">account_id</span><span class="o">=</span><span class="n">account_id</span><span class="p">,</span>
                              <span class="n">plan_name</span><span class="o">=</span><span class="s">'pistol-monthly'</span><span class="p">)</span>

<span class="n">subscription_b</span> <span class="o">=</span> <span class="n">Subscription</span><span class="p">(</span><span class="n">account_id</span><span class="o">=</span><span class="n">account_id</span><span class="p">,</span>
                              <span class="n">plan_name</span><span class="o">=</span><span class="s">'cleaning-monthly'</span><span class="p">)</span>

<span class="n">body</span> <span class="o">=</span> <span class="p">[</span><span class="n">subscription_a</span><span class="p">,</span> <span class="n">subscription_b</span><span class="p">]</span>

<span class="n">subscriptionApi</span><span class="p">.</span><span class="n">create_subscription_with_add_ons</span><span class="p">(</span><span class="n">body</span><span class="p">,</span> 
                                                 <span class="n">created_by</span><span class="o">=</span><span class="s">'demo'</span><span class="p">,</span> 
                                                 <span class="n">reason</span><span class="o">=</span><span class="s">'reason'</span><span class="p">,</span> 
                                                 <span class="n">comment</span><span class="o">=</span><span class="s">'comment'</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">const</span> <span class="nx">api</span><span class="p">:</span> <span class="nx">killbill</span><span class="p">.</span><span class="nx">SubscriptionApi</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">killbill</span><span class="p">.</span><span class="nx">SubscriptionApi</span><span class="p">(</span><span class="nx">config</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">base</span><span class="p">:</span> <span class="nx">Subscription</span> <span class="o">=</span> <span class="p">{</span><span class="na">planName</span><span class="p">:</span> <span class="dl">"</span><span class="s2">pistol-monthly</span><span class="dl">"</span><span class="p">,</span> <span class="na">accountId</span><span class="p">:</span> <span class="dl">"</span><span class="s2">04779ade-11f9-48d1-88a1-a63be84d1cb7</span><span class="dl">"</span><span class="p">};</span>
<span class="kd">const</span> <span class="nx">addon</span><span class="p">:</span> <span class="nx">Subscription</span> <span class="o">=</span> <span class="p">{</span><span class="na">planName</span><span class="p">:</span> <span class="dl">"</span><span class="s2">cleaning-monthly</span><span class="dl">"</span><span class="p">,</span> <span class="na">accountId</span><span class="p">:</span> <span class="dl">"</span><span class="s2">04779ade-11f9-48d1-88a1-a63be84d1cb7</span><span class="dl">"</span><span class="p">};</span>
<span class="kd">const</span> <span class="nx">subscriptions</span> <span class="o">=</span><span class="p">[</span><span class="nx">base</span><span class="p">,</span> <span class="nx">addon</span><span class="p">];</span>

<span class="nx">api</span><span class="p">.</span><span class="nx">createSubscriptionWithAddOns</span><span class="p">(</span><span class="nx">subscriptions</span><span class="p">,</span> <span class="dl">'</span><span class="s1">created_by</span><span class="dl">'</span><span class="p">);</span>
</code></pre></div><div class="highlight"><pre class="highlight php tab-php"><code><span class="nv">$apiInstance</span> <span class="o">=</span> <span class="nv">$client</span><span class="o">-&gt;</span><span class="nf">getSubscriptionApi</span><span class="p">();</span>

<span class="nv">$xKillbillCreatedBy</span> <span class="o">=</span> <span class="s2">"user"</span><span class="p">;</span>
<span class="nv">$xKillbillReason</span> <span class="o">=</span> <span class="s2">"reason"</span><span class="p">;</span>
<span class="nv">$xKillbillComment</span> <span class="o">=</span> <span class="s2">"comment"</span><span class="p">;</span>

<span class="nv">$base</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Subscription</span><span class="p">();</span>
<span class="nv">$base</span> <span class="o">-&gt;</span> <span class="nf">setAccountId</span><span class="p">(</span><span class="s1">'13102713-9672-4e3b-8b4f-e10869fc5a59'</span><span class="p">);</span>
<span class="nv">$base</span> <span class="o">-&gt;</span> <span class="nf">setPlanName</span><span class="p">(</span><span class="s1">'pistol-monthly'</span><span class="p">);</span>

<span class="nv">$addon</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Subscription</span><span class="p">();</span>
<span class="nv">$addon</span> <span class="o">-&gt;</span> <span class="nf">setAccountId</span><span class="p">(</span><span class="s1">'13102713-9672-4e3b-8b4f-e10869fc5a59'</span><span class="p">);</span>
<span class="nv">$addon</span> <span class="o">-&gt;</span> <span class="nf">setPlanName</span><span class="p">(</span><span class="s1">'cleaning-monthly'</span><span class="p">);</span>

<span class="nv">$body</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="nv">$base</span><span class="p">,</span> <span class="nv">$addon</span><span class="p">);</span>

<span class="nv">$entitlementDate</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
<span class="nv">$billingDate</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
<span class="nv">$migrated</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
<span class="nv">$skipResponse</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
<span class="nv">$renameKeyIfExistsAndUnused</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
<span class="nv">$callCompletion</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
<span class="nv">$callTimeoutSec</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
<span class="nv">$pluginProperty</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">"pluginProperty_example"</span><span class="p">);</span>

<span class="nv">$result</span> <span class="o">=</span> <span class="nv">$apiInstance</span><span class="o">-&gt;</span><span class="nf">createSubscriptionWithAddOns</span><span class="p">(</span><span class="nv">$body</span><span class="p">,</span> <span class="nv">$xKillbillCreatedBy</span><span class="p">,</span> <span class="nv">$xKillbillReason</span><span class="p">,</span> <span class="nv">$xKillbillComment</span><span class="p">,</span> <span class="nv">$entitlementDate</span><span class="p">,</span> <span class="nv">$billingDate</span><span class="p">,</span> <span class="nv">$migrated</span><span class="p">,</span> <span class="nv">$skipResponse</span><span class="p">,</span> <span class="nv">$renameKeyIfExistsAndUnused</span><span class="p">,</span> <span class="nv">$callCompletion</span><span class="p">,</span> <span class="nv">$callTimeoutSec</span><span class="p">,</span> <span class="nv">$pluginProperty</span><span class="p">);</span>
</code></pre></div>
<p><strong>Request Body</strong></p>

<p>A subscription resource object corresponding to the base subscription and zero or more subscription resource objects corresponding to add-on subscriptions need to be specified. Alternatively, only a list of add-on subscription resource objects may be specified along with the base subscription bundle id. Each subscription resource object needs to include <code>accountId</code> and either the <code>planName</code> or a combination of <code>productName</code>, <code>productCategory</code>,<code>billingPeriod</code> and <code>priceList</code>.</p>

<p>In addition, each subscription resource can also include the following optional fields:</p>

<ul>
<li><code>phaseType</code> - Target phase type. Specifying this field causes the subscription to start with this phase.</li>
<li><code>externalKey</code> - External key corresponding to the subscription.</li>
<li><code>billCycleDayLocal</code> - Per-subscription BCD. Specifying this value allows realigning the billing with the specified date. </li>
<li><code>bundleId</code> - Id of the bundle in which to create this subscription. Can be specified only with an add-on subscription resource.</li>
</ul>

<p><strong>Query Parameters</strong></p>

<table><thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Required</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><strong>entitlementDate</strong></td>
<td>string</td>
<td>no</td>
<td>immediately</td>
<td>Date at which the entitlement (sevice) starts in <code>yyyy-mm-dd</code> format. If specified, applies both to base and add-on products.</td>
</tr>
<tr>
<td><strong>billingDate</strong></td>
<td>string</td>
<td>no</td>
<td>immediately</td>
<td>Date at which the billing starts in <code>yyyy-mm-dd</code> format. If specified, applies both to base and add-on products.</td>
</tr>
<tr>
<td><strong>renameKeyIfExistsAndUnused</strong></td>
<td>boolean</td>
<td>no</td>
<td>true</td>
<td>If true, rename external key if it exists and is unused</td>
</tr>
<tr>
<td><strong>migrated</strong></td>
<td>boolean</td>
<td>no</td>
<td>false</td>
<td>If true, subscription is migrated</td>
</tr>
<tr>
<td><strong>skipResponse</strong></td>
<td>boolean</td>
<td>no</td>
<td>false</td>
<td>TODO</td>
</tr>
<tr>
<td><strong>callCompletion</strong></td>
<td>boolean</td>
<td>no</td>
<td>false</td>
<td>see below</td>
</tr>
<tr>
<td><strong>callTimeoutSec</strong></td>
<td>long</td>
<td>no</td>
<td>unlimited?</td>
<td>Timeout in seconds (see below)</td>
</tr>
<tr>
<td><strong>pluginProperty</strong></td>
<td>array of strings</td>
<td>false</td>
<td>omit</td>
<td>list of plugin properties, if any</td>
</tr>
</tbody></table>

<p>Creating a subscription often triggers the creation of an invoice, and associated with this there is often a payment (against the invoice). If <strong>callCompletion</strong> is true, the call to this API will be delayed until the invoice is created and/or the payment is processed. However, the maximum delay in seconds will be given by <strong>callTimeoutSec</strong>.</p>

<p><strong>Response</strong></p>

<p>If successful, returns a status code of 201 and an empty body. In addition, a <code>Location</code> header is returned which contains the new bundle id.</p>
<h3 id='create-multiple-subscriptions-with-addon-products'>Create multiple subscriptions with addon products</h3>
<p>This API creates multiple subscriptions with base and addon product subscriptions. It can also be used to add an addon subscription to a base subscription in which case the bundle id of the base subscription must be specified.</p>

<p><strong>HTTP Request</strong> </p>

<p><code>POST http://127.0.0.1:8080/1.0/kb/subscriptions/createSubscriptionsWithAddOns</code></p>

<blockquote>
<p>Example Request:</p>
</blockquote>
<div class="highlight"><pre class="highlight shell tab-shell"><code>curl <span class="nt">-v</span> <span class="se">\</span>
    <span class="nt">-X</span> POST <span class="se">\</span>
    <span class="nt">-u</span> admin:password <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-ApiKey: bob"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-ApiSecret: lazar"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-CreatedBy: demo"</span> <span class="se">\</span>
    <span class="nt">-d</span> <span class="s1">'[
          {
            "baseEntitlementAndAddOns": [
              {
                "accountId": "886adb60-be70-40c8-b97d-1f8ecbc30a64",
                "externalKey": "base",
                "productName": "Sports",
                "productCategory": "BASE",
                "billingPeriod": "MONTHLY",
                "priceList": "DEFAULT"
              },
              {
                "accountId": "886adb60-be70-40c8-b97d-1f8ecbc30a64",
                "productName": "OilSlick",
                "productCategory": "ADD_ON",
                "billingPeriod": "MONTHLY",
                "priceList": "DEFAULT"
              }
            ]
          },
           {
            "baseEntitlementAndAddOns": [
              {
                "accountId": "59afd9fe-e98d-4fb3-b5bf-21d4a2b036cd",
                "externalKey": "createSubscriptionsWithAddOns3",
                "productName": "Test",
                "productCategory": "BASE",
                "billingPeriod": "MONTHLY",
                "priceList": "DEFAULT"
              },
              {
                "accountId": "59afd9fe-e98d-4fb3-b5bf-21d4a2b036cd",
                "productName": "TestAO",
                "productCategory": "ADD_ON",
                "billingPeriod": "MONTHLY",
                "priceList": "DEFAULT"
              }
            ]
          }
        ]'</span> <span class="se">\</span>
    <span class="s1">'http://127.0.0.1:8080/1.0/kb/subscriptions/createSubscriptionsWithAddOns'</span> 

OR 

curl <span class="nt">-v</span> <span class="se">\</span>
    <span class="nt">-X</span> POST <span class="se">\</span>
    <span class="nt">-u</span> admin:password <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-ApiKey: bob"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-ApiSecret: lazar"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-CreatedBy: demo"</span> <span class="se">\</span>
    <span class="nt">-d</span> <span class="s1">'[
          {
            "baseEntitlementAndAddOns": [
              {
                "accountId": "1f635c3d-fc24-4fa8-81e0-ab646882807a",
                "planName": "remotecontrol-monthly",  
                "bundleId":"a8b4022c-e38c-4336-ad2f-ee15c5e18d12"
              }
            ]
          },
          {
            "baseEntitlementAndAddOns": [

              {
                "accountId": "1f635c3d-fc24-4fa8-81e0-ab646882807a",
                "planName": "remotecontrol-monthly",
                "bundleId":"06892885-c276-4cf9-8311-ef0b8a2e364b"
              }
            ]
          }
        ]'</span> <span class="se">\</span>
    <span class="s1">'http://127.0.0.1:8080/1.0/kb/subscriptions/createSubscriptionsWithAddOns'</span> 

</code></pre></div><div class="highlight"><pre class="highlight java tab-java"><code><span class="kn">import</span> <span class="nn">org.killbill.billing.client.api.gen.SubscriptionApi</span><span class="o">;</span>
<span class="kd">protected</span> <span class="nc">SubscriptionApi</span> <span class="n">subscriptionApi</span><span class="o">;</span>

<span class="no">UUID</span> <span class="n">accountId</span> <span class="o">=</span> <span class="no">UUID</span><span class="o">.</span><span class="na">fromString</span><span class="o">(</span><span class="s">"a3087bfb-eb81-466d-afeb-6501c30f8f85"</span><span class="o">);</span>

<span class="nc">Subscription</span> <span class="n">base</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Subscription</span><span class="o">();</span>
<span class="n">base</span><span class="o">.</span><span class="na">setAccountId</span><span class="o">(</span><span class="n">accountId</span><span class="o">);</span>
<span class="n">base</span><span class="o">.</span><span class="na">setPlanName</span><span class="o">(</span><span class="s">"test-monthly"</span><span class="o">);</span>

<span class="kd">final</span> <span class="nc">Subscription</span> <span class="n">addOn1</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Subscription</span><span class="o">();</span>
<span class="n">addOn1</span><span class="o">.</span><span class="na">setAccountId</span><span class="o">(</span><span class="n">accountId</span><span class="o">);</span>
<span class="n">addOn1</span><span class="o">.</span><span class="na">setPlanName</span><span class="o">(</span><span class="s">"testao-monthly"</span><span class="o">);</span>

<span class="kd">final</span> <span class="nc">Subscriptions</span> <span class="n">subscriptions</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Subscriptions</span><span class="o">();</span>
<span class="n">subscriptions</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">base</span><span class="o">);</span>
<span class="n">subscriptions</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">addOn1</span><span class="o">);</span>

<span class="nc">BulkSubscriptionsBundle</span> <span class="n">bulkSubscriptionsBundle</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">BulkSubscriptionsBundle</span><span class="o">();</span>
<span class="n">bulkSubscriptionsBundle</span><span class="o">.</span><span class="na">setBaseEntitlementAndAddOns</span><span class="o">(</span><span class="n">subscriptions</span><span class="o">);</span>

<span class="nc">Subscription</span> <span class="n">base2</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Subscription</span><span class="o">();</span>
<span class="n">base2</span><span class="o">.</span><span class="na">setAccountId</span><span class="o">(</span><span class="n">accountId</span><span class="o">);</span>
<span class="n">base2</span><span class="o">.</span><span class="na">setPlanName</span><span class="o">(</span><span class="s">"product1-monthly"</span><span class="o">);</span>

<span class="nc">Subscription</span> <span class="n">base2addOn1</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Subscription</span><span class="o">();</span>
<span class="n">base2addOn1</span><span class="o">.</span><span class="na">setAccountId</span><span class="o">(</span><span class="n">accountId</span><span class="o">);</span>
<span class="n">base2addOn1</span><span class="o">.</span><span class="na">setPlanName</span><span class="o">(</span><span class="s">"product1-ao-monthly"</span><span class="o">);</span>

<span class="nc">Subscriptions</span> <span class="n">subscriptions2</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Subscriptions</span><span class="o">();</span>
<span class="n">subscriptions2</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">base2</span><span class="o">);</span>
<span class="n">subscriptions2</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">base2addOn1</span><span class="o">);</span>

<span class="nc">BulkSubscriptionsBundle</span> <span class="n">bulkSubscriptionsBundle2</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">BulkSubscriptionsBundle</span><span class="o">();</span>
<span class="n">bulkSubscriptionsBundle2</span><span class="o">.</span><span class="na">setBaseEntitlementAndAddOns</span><span class="o">(</span><span class="n">subscriptions2</span><span class="o">);</span>

<span class="nc">BulkSubscriptionsBundles</span> <span class="n">bulkSubscriptionsBundles</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">BulkSubscriptionsBundles</span><span class="o">();</span>
<span class="n">bulkSubscriptionsBundles</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">bulkSubscriptionsBundle</span><span class="o">);</span>
<span class="n">bulkSubscriptionsBundles</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">bulkSubscriptionsBundle2</span><span class="o">);</span>

<span class="nc">LocalDate</span> <span class="n">entitlementDate</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
<span class="nc">LocalDate</span> <span class="n">billingDate</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
<span class="nc">Boolean</span> <span class="n">renameKeyIfExistsAndUnused</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>
<span class="nc">Boolean</span> <span class="n">migrated</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>
<span class="nc">Boolean</span> <span class="n">skipResponse</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>
<span class="nc">Boolean</span> <span class="n">callCompletion</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>
<span class="kt">long</span> <span class="no">DEFAULT_WAIT_COMPLETION_TIMEOUT_SEC</span> <span class="o">=</span> <span class="mi">10</span><span class="o">;</span>
<span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">String</span><span class="o">&gt;</span> <span class="no">NULL_PLUGIN_PROPERTIES</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>

<span class="nc">Bundles</span> <span class="n">bundles</span> <span class="o">=</span> <span class="n">subscriptionApi</span><span class="o">.</span><span class="na">createSubscriptionsWithAddOns</span><span class="o">(</span><span class="n">bulkSubscriptionsBundles</span><span class="o">,</span> 
                                                                 <span class="n">entitlementDate</span><span class="o">,</span> 
                                                                 <span class="n">billingDate</span><span class="o">,</span> 
                                                                 <span class="n">renameKeyIfExistsAndUnused</span><span class="o">,</span> 
                                                                 <span class="n">migrated</span><span class="o">,</span> 
                                                                 <span class="n">skipResponse</span><span class="o">,</span> 
                                                                 <span class="n">callCompletion</span><span class="o">,</span> 
                                                                <span class="no">DEFAULT_WAIT_COMPLETION_TIMEOUT_SEC</span><span class="o">,</span> <span class="no">NULL_PLUGIN_PROPERTIES</span><span class="o">,</span>                                                               <span class="n">requestOptions</span><span class="o">);</span>
</code></pre></div><div class="highlight"><pre class="highlight ruby tab-ruby"><code><span class="n">user</span> <span class="o">=</span> <span class="s2">"demo"</span>
<span class="n">reason</span> <span class="o">=</span> <span class="kp">nil</span>
<span class="n">comment</span> <span class="o">=</span> <span class="kp">nil</span>

<span class="n">bulk_subscription_list</span> <span class="o">=</span> <span class="p">[</span>
                            <span class="p">{</span>
                               <span class="s2">"baseEntitlementAndAddOns"</span><span class="p">:[</span>
                                  <span class="p">{</span>
                                     <span class="s2">"accountId"</span><span class="ss">:"e3a23520-2ce2-493a-a3c0-7fc08e554353"</span><span class="p">,</span>
                                     <span class="s2">"productCategory"</span><span class="ss">:"BASE"</span><span class="p">,</span>
                                     <span class="s2">"productName"</span><span class="ss">:"Pistol"</span><span class="p">,</span>
                                     <span class="s2">"billingPeriod"</span><span class="ss">:"MONTHLY"</span><span class="p">,</span>
                                     <span class="s2">"priceList"</span><span class="ss">:"DEFAULT"</span>
                                  <span class="p">},</span>
                                  <span class="p">{</span>
                                     <span class="s2">"accountId"</span><span class="ss">:"e3a23520-2ce2-493a-a3c0-7fc08e554353"</span><span class="p">,</span>
                                     <span class="s2">"productCategory"</span><span class="ss">:"ADD_ON"</span><span class="p">,</span>
                                     <span class="s2">"productName"</span><span class="ss">:"Cleaning"</span><span class="p">,</span>
                                     <span class="s2">"billingPeriod"</span><span class="ss">:"MONTHLY"</span><span class="p">,</span>
                                     <span class="s2">"priceList"</span><span class="ss">:"DEFAULT"</span>
                                  <span class="p">}</span>
                               <span class="p">]</span>
                            <span class="p">},</span>
                            <span class="p">{</span>
                               <span class="s2">"baseEntitlementAndAddOns"</span><span class="p">:[</span>
                                  <span class="p">{</span>
                                     <span class="s2">"accountId"</span><span class="ss">:"e3a23520-2ce2-493a-a3c0-7fc08e554353"</span><span class="p">,</span>
                                     <span class="s2">"productCategory"</span><span class="ss">:"BASE"</span><span class="p">,</span>
                                     <span class="s2">"productName"</span><span class="ss">:"Shotgun"</span><span class="p">,</span>
                                     <span class="s2">"billingPeriod"</span><span class="ss">:"MONTHLY"</span><span class="p">,</span>
                                     <span class="s2">"priceList"</span><span class="ss">:"DEFAULT"</span>
                                  <span class="p">},</span>
                                  <span class="p">{</span>
                                     <span class="s2">"accountId"</span><span class="ss">:"e3a23520-2ce2-493a-a3c0-7fc08e554353"</span><span class="p">,</span>
                                     <span class="s2">"productCategory"</span><span class="ss">:"ADD_ON"</span><span class="p">,</span>
                                     <span class="s2">"productName"</span><span class="ss">:"Telescopic-Scope"</span><span class="p">,</span>
                                     <span class="s2">"billingPeriod"</span><span class="ss">:"MONTHLY"</span><span class="p">,</span>
                                     <span class="s2">"priceList"</span><span class="ss">:"DEFAULT"</span>
                                  <span class="p">}</span>
                               <span class="p">]</span>
                            <span class="p">},</span>

                         <span class="p">]</span>
<span class="n">entitlement_date</span> <span class="o">=</span> <span class="kp">nil</span>
<span class="n">billing_date</span> <span class="o">=</span> <span class="kp">nil</span>
<span class="n">call_completion_sec</span> <span class="o">=</span> <span class="kp">nil</span>

<span class="no">KillBillClient</span><span class="o">::</span><span class="no">Model</span><span class="o">::</span><span class="no">BulkSubscription</span><span class="p">.</span><span class="nf">create_bulk_subscriptions</span><span class="p">(</span><span class="n">bulk_subscription_list</span><span class="p">,</span>
                                                                  <span class="n">user</span><span class="p">,</span>
                                                                  <span class="n">reason</span><span class="p">,</span>
                                                                  <span class="n">comment</span><span class="p">,</span>
                                                                  <span class="n">entitlement_date</span><span class="p">,</span>
                                                                  <span class="n">billing_date</span><span class="p">,</span>
                                                                  <span class="n">call_completion_sec</span><span class="p">,</span>
                                                                  <span class="n">options</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="n">subscriptionApi</span> <span class="o">=</span> <span class="n">killbill</span><span class="p">.</span><span class="n">api</span><span class="p">.</span><span class="n">SubscriptionApi</span><span class="p">()</span>
<span class="n">account_id</span> <span class="o">=</span> <span class="s">'32660591-b8a0-4a0e-b6a8-9b52611217c2'</span>
<span class="n">subscription_a</span> <span class="o">=</span> <span class="n">Subscription</span><span class="p">(</span><span class="n">account_id</span><span class="o">=</span><span class="n">account_id</span><span class="p">,</span>
                              <span class="n">plan_name</span><span class="o">=</span><span class="s">'pistol-thirty-days'</span><span class="p">)</span>

<span class="n">subscription_b</span> <span class="o">=</span> <span class="n">Subscription</span><span class="p">(</span><span class="n">account_id</span><span class="o">=</span><span class="n">account_id</span><span class="p">,</span>
                              <span class="n">plan_name</span><span class="o">=</span><span class="s">'cleaning-monthly'</span><span class="p">)</span>

<span class="n">bundle1</span> <span class="o">=</span> <span class="n">BulkSubscriptionsBundle</span><span class="p">([</span><span class="n">subscription_a</span><span class="p">,</span> <span class="n">subscription_b</span><span class="p">])</span>

<span class="n">subscription_c</span> <span class="o">=</span> <span class="n">Subscription</span><span class="p">(</span><span class="n">account_id</span><span class="o">=</span><span class="n">account_id</span><span class="p">,</span>
                              <span class="n">plan_name</span><span class="o">=</span><span class="s">'shotgun-monthly'</span><span class="p">)</span>

<span class="n">subscription_d</span> <span class="o">=</span> <span class="n">Subscription</span><span class="p">(</span><span class="n">account_id</span><span class="o">=</span><span class="n">account_id</span><span class="p">,</span>
                              <span class="n">plan_name</span><span class="o">=</span><span class="s">'holster-monthly-regular'</span><span class="p">)</span>

<span class="n">bundle2</span> <span class="o">=</span> <span class="n">BulkSubscriptionsBundle</span><span class="p">([</span><span class="n">subscription_c</span><span class="p">,</span> <span class="n">subscription_d</span><span class="p">])</span>

<span class="n">subscriptionApi</span><span class="p">.</span><span class="n">create_subscriptions_with_add_ons</span><span class="p">([</span><span class="n">bundle1</span><span class="p">,</span> <span class="n">bundle2</span><span class="p">],</span>
                                                  <span class="n">created_by</span><span class="o">=</span><span class="s">'demo'</span><span class="p">,</span>
                                                  <span class="n">reason</span><span class="o">=</span><span class="s">'reason'</span><span class="p">,</span>
                                                  <span class="n">comment</span><span class="o">=</span><span class="s">'comment'</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">const</span> <span class="nx">api</span><span class="p">:</span> <span class="nx">killbill</span><span class="p">.</span><span class="nx">SubscriptionApi</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">killbill</span><span class="p">.</span><span class="nx">SubscriptionApi</span><span class="p">(</span><span class="nx">config</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">base1</span><span class="p">:</span> <span class="nx">Subscription</span> <span class="o">=</span> <span class="p">{</span><span class="na">planName</span><span class="p">:</span> <span class="dl">"</span><span class="s2">pistol-monthly</span><span class="dl">"</span><span class="p">,</span> <span class="na">accountId</span><span class="p">:</span> <span class="dl">"</span><span class="s2">04779ade-11f9-48d1-88a1-a63be84d1cb7</span><span class="dl">"</span><span class="p">};</span>
<span class="kd">const</span> <span class="nx">addon1</span><span class="p">:</span> <span class="nx">Subscription</span> <span class="o">=</span> <span class="p">{</span><span class="na">planName</span><span class="p">:</span> <span class="dl">"</span><span class="s2">cleaning-monthly</span><span class="dl">"</span><span class="p">,</span> <span class="na">accountId</span><span class="p">:</span> <span class="dl">"</span><span class="s2">04779ade-11f9-48d1-88a1-a63be84d1cb7</span><span class="dl">"</span><span class="p">};</span>
<span class="kd">const</span> <span class="nx">subscriptions1</span> <span class="o">=</span> <span class="p">[</span><span class="nx">base1</span><span class="p">,</span> <span class="nx">addon1</span><span class="p">];</span>
<span class="kd">const</span> <span class="nx">bulkSubBundle1</span><span class="p">:</span> <span class="nx">BulkSubscriptionsBundle</span> <span class="o">=</span> <span class="p">{</span><span class="na">baseEntitlementAndAddOns</span><span class="p">:</span> <span class="nx">subscriptions1</span><span class="p">};</span>

<span class="kd">const</span> <span class="nx">base2</span><span class="p">:</span> <span class="nx">Subscription</span> <span class="o">=</span> <span class="p">{</span><span class="na">planName</span><span class="p">:</span> <span class="dl">"</span><span class="s2">shotgun-monthly</span><span class="dl">"</span><span class="p">,</span> <span class="na">accountId</span><span class="p">:</span> <span class="dl">"</span><span class="s2">04779ade-11f9-48d1-88a1-a63be84d1cb7</span><span class="dl">"</span><span class="p">};</span>
<span class="kd">const</span> <span class="nx">addon2</span><span class="p">:</span> <span class="nx">Subscription</span> <span class="o">=</span> <span class="p">{</span><span class="na">planName</span><span class="p">:</span> <span class="dl">"</span><span class="s2">telescopic-scope-monthly</span><span class="dl">"</span><span class="p">,</span> <span class="na">accountId</span><span class="p">:</span> <span class="dl">"</span><span class="s2">04779ade-11f9-48d1-88a1-a63be84d1cb7</span><span class="dl">"</span><span class="p">};</span>
<span class="kd">const</span> <span class="nx">subscriptions2</span> <span class="o">=</span> <span class="p">[</span><span class="nx">base2</span><span class="p">,</span> <span class="nx">addon2</span><span class="p">];</span>
<span class="kd">const</span> <span class="nx">bulkSubBundle2</span><span class="p">:</span> <span class="nx">BulkSubscriptionsBundle</span> <span class="o">=</span> <span class="p">{</span><span class="na">baseEntitlementAndAddOns</span><span class="p">:</span> <span class="nx">subscriptions2</span><span class="p">};</span>

<span class="kd">const</span> <span class="nx">bulkSubscriptionBundles</span> <span class="o">=</span> <span class="p">[</span><span class="nx">bulkSubBundle1</span><span class="p">,</span> <span class="nx">bulkSubBundle2</span><span class="p">];</span>

<span class="nx">api</span><span class="p">.</span><span class="nx">createSubscriptionsWithAddOns</span><span class="p">(</span><span class="nx">bulkSubscriptionBundles</span><span class="p">,</span> <span class="dl">'</span><span class="s1">created_by</span><span class="dl">'</span><span class="p">);</span>
</code></pre></div><div class="highlight"><pre class="highlight php tab-php"><code><span class="nv">$apiInstance</span> <span class="o">=</span> <span class="nv">$client</span><span class="o">-&gt;</span><span class="nf">getSubscriptionApi</span><span class="p">();</span>

<span class="nv">$xKillbillCreatedBy</span> <span class="o">=</span> <span class="s2">"user"</span><span class="p">;</span>
<span class="nv">$xKillbillReason</span> <span class="o">=</span> <span class="s2">"reason"</span><span class="p">;</span>
<span class="nv">$xKillbillComment</span> <span class="o">=</span> <span class="s2">"comment"</span><span class="p">;</span>

<span class="nv">$base1</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Subscription</span><span class="p">();</span>
<span class="nv">$base1</span> <span class="o">-&gt;</span> <span class="nf">setAccountId</span><span class="p">(</span><span class="s1">'13102713-9672-4e3b-8b4f-e10869fc5a59'</span><span class="p">);</span>
<span class="nv">$base1</span> <span class="o">-&gt;</span> <span class="nf">setPlanName</span><span class="p">(</span><span class="s1">'pistol-monthly'</span><span class="p">);</span>

<span class="nv">$addon1</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Subscription</span><span class="p">();</span>
<span class="nv">$addon1</span> <span class="o">-&gt;</span> <span class="nf">setAccountId</span><span class="p">(</span><span class="s1">'13102713-9672-4e3b-8b4f-e10869fc5a59'</span><span class="p">);</span>
<span class="nv">$addon1</span> <span class="o">-&gt;</span> <span class="nf">setPlanName</span><span class="p">(</span><span class="s1">'cleaning-monthly'</span><span class="p">);</span>

<span class="nv">$subs1</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="nv">$base1</span><span class="p">,</span> <span class="nv">$addon1</span><span class="p">);</span>

<span class="nv">$bulkSubscriptionsBundle1</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">BulkSubscriptionsBundle</span><span class="p">();</span>
<span class="nv">$bulkSubscriptionsBundle1</span> <span class="o">-&gt;</span> <span class="nf">setBaseEntitlementAndAddOns</span><span class="p">(</span><span class="nv">$subs1</span><span class="p">);</span>

<span class="nv">$base2</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Subscription</span><span class="p">();</span>
<span class="nv">$base2</span> <span class="o">-&gt;</span> <span class="nf">setAccountId</span><span class="p">(</span><span class="s1">'13102713-9672-4e3b-8b4f-e10869fc5a59'</span><span class="p">);</span>
<span class="nv">$base2</span> <span class="o">-&gt;</span> <span class="nf">setPlanName</span><span class="p">(</span><span class="s1">'shotgun-monthly'</span><span class="p">);</span>

<span class="nv">$addon2</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Subscription</span><span class="p">();</span>
<span class="nv">$addon2</span> <span class="o">-&gt;</span> <span class="nf">setAccountId</span><span class="p">(</span><span class="s1">'13102713-9672-4e3b-8b4f-e10869fc5a59'</span><span class="p">);</span>
<span class="nv">$addon2</span> <span class="o">-&gt;</span> <span class="nf">setPlanName</span><span class="p">(</span><span class="s1">'laser-scope-monthly'</span><span class="p">);</span>

<span class="nv">$subs2</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="nv">$base2</span><span class="p">,</span> <span class="nv">$addon2</span><span class="p">);</span>

<span class="nv">$bulkSubscriptionsBundle2</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">BulkSubscriptionsBundle</span><span class="p">();</span>
<span class="nv">$bulkSubscriptionsBundle2</span> <span class="o">-&gt;</span> <span class="nf">setBaseEntitlementAndAddOns</span><span class="p">(</span><span class="nv">$subs2</span><span class="p">);</span>

<span class="nv">$body</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="nv">$bulkSubscriptionsBundle1</span><span class="p">,</span> <span class="nv">$bulkSubscriptionsBundle2</span><span class="p">);</span>

<span class="nv">$entitlementDate</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
<span class="nv">$billingDate</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
<span class="nv">$renameKeyIfExistsAndUnused</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
<span class="nv">$migrated</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
<span class="nv">$skipResponse</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
<span class="nv">$callCompletion</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
<span class="nv">$callTimeoutSec</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
<span class="nv">$pluginProperty</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">"pluginProperty_example"</span><span class="p">);</span>

<span class="nv">$result</span> <span class="o">=</span> <span class="nv">$apiInstance</span><span class="o">-&gt;</span><span class="nf">createSubscriptionsWithAddOns</span><span class="p">(</span><span class="nv">$body</span><span class="p">,</span> <span class="nv">$xKillbillCreatedBy</span><span class="p">,</span> <span class="nv">$xKillbillReason</span><span class="p">,</span> <span class="nv">$xKillbillComment</span><span class="p">,</span> <span class="nv">$entitlementDate</span><span class="p">,</span> <span class="nv">$billingDate</span><span class="p">,</span> <span class="nv">$renameKeyIfExistsAndUnused</span><span class="p">,</span> <span class="nv">$migrated</span><span class="p">,</span> <span class="nv">$skipResponse</span><span class="p">,</span> <span class="nv">$callCompletion</span><span class="p">,</span> <span class="nv">$callTimeoutSec</span><span class="p">,</span> <span class="nv">$pluginProperty</span><span class="p">);</span>
</code></pre></div>
<p><strong>Request Body</strong></p>

<p>One or more subscription resource object corresponding to the base subscriptions need to be specified. Additional, each base subscription resource object can include zero or more subscription resource objects corresponding to add-on subscriptions. Alternatively, only a list of add-on subscription resource objects may be specified along with the base subscription bundle id. Each subscription resource object needs to include <code>accountId</code> and either the <code>planName</code> or a combination of <code>productName</code>, <code>productCategory</code>,<code>billingPeriod</code> and <code>priceList</code>.</p>

<p>In addition, each subscription resource can also include the following optional fields:</p>

<ul>
<li><code>phaseType</code> - Target phase type. Specifying this field causes the subscription to start with this phase.</li>
<li><code>externalKey</code> - External key corresponding to the subscription.</li>
<li><code>billCycleDayLocal</code> - Per-subscription BCD. Specifying this value allows realigning the billing with the specified date. </li>
<li><code>bundleId</code> - Id of the bundle in which to create this subscription. Can be specified only with an add-on subscription resource.</li>
</ul>

<p><strong>Query Parameters</strong></p>

<table><thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Required</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><strong>entitlementDate</strong></td>
<td>string</td>
<td>no</td>
<td>immediately</td>
<td>Date at which the entitlement (sevice) starts in <code>yyyy-mm-dd</code> format. If specified, applies both to base and add-on products.</td>
</tr>
<tr>
<td><strong>billingDate</strong></td>
<td>string</td>
<td>no</td>
<td>immediately</td>
<td>Date at which the billing starts in <code>yyyy-mm-dd</code> format. If specified, applies both to base and add-on products.</td>
</tr>
<tr>
<td><strong>renameKeyIfExistsAndUnused</strong></td>
<td>boolean</td>
<td>no</td>
<td>true</td>
<td>If true, rename external key if it exists and is unused</td>
</tr>
<tr>
<td><strong>migrated</strong></td>
<td>boolean</td>
<td>no</td>
<td>false</td>
<td>If true, subscription is migrated</td>
</tr>
<tr>
<td><strong>skipResponse</strong></td>
<td>boolean</td>
<td>no</td>
<td>false</td>
<td>TODO</td>
</tr>
<tr>
<td><strong>callCompletion</strong></td>
<td>boolean</td>
<td>no</td>
<td>false</td>
<td>see below</td>
</tr>
<tr>
<td><strong>callTimeoutSec</strong></td>
<td>long</td>
<td>no</td>
<td>unlimited?</td>
<td>Timeout in seconds (see below)</td>
</tr>
<tr>
<td><strong>pluginProperty</strong></td>
<td>array of strings</td>
<td>false</td>
<td>omit</td>
<td>list of plugin properties, if any</td>
</tr>
</tbody></table>

<p>Creating a subscription often triggers the creation of an invoice, and associated with this there is often a payment (against the invoice). If <strong>callCompletion</strong> is true, the call to this API will be delayed until the invoice is created and/or the payment is processed. However, the maximum delay in seconds will be given by <strong>callTimeoutSec</strong>.</p>

<p><strong>Response</strong></p>

<p>If successful, returns a status code of 201 and an empty body. In addition, a <code>Location</code> header is returned which contains URL to fetch the newly created bundles.</p>
<h3 id='retrieve-a-subscription-by-id'>Retrieve a subscription by id</h3>
<p>This API retrieves a subscription resource object based on its subscription id </p>

<p><strong>HTTP Request</strong> </p>

<p><code>GET http://127.0.0.1:8080/1.0/kb/subscriptions/{subscriptionId}</code></p>

<blockquote>
<p>Example Request:</p>
</blockquote>
<div class="highlight"><pre class="highlight shell tab-shell"><code>curl <span class="se">\</span>
    <span class="nt">-u</span> admin:password <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-ApiKey: bob"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-ApiSecret: lazar"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"Accept: application/json"</span> <span class="se">\</span>
    <span class="s1">'http://127.0.0.1:8080/1.0/kb/subscriptions/d4a919f4-7459-494f-85e5-af8880f63e90'</span> 
</code></pre></div><div class="highlight"><pre class="highlight java tab-java"><code><span class="kn">import</span> <span class="nn">org.killbill.billing.client.api.gen.SubscriptionApi</span><span class="o">;</span>
<span class="kd">protected</span> <span class="nc">SubscriptionApi</span> <span class="n">subscriptionApi</span><span class="o">;</span>

<span class="no">UUID</span> <span class="n">subscriptionId</span> <span class="o">=</span> <span class="no">UUID</span><span class="o">.</span><span class="na">fromString</span><span class="o">(</span><span class="s">"905a0636-ab63-40c0-acd4-b461b6808b5d"</span><span class="o">);</span>

<span class="nc">Subscription</span> <span class="n">subscription</span> <span class="o">=</span> <span class="n">subscriptionApi</span><span class="o">.</span><span class="na">getSubscription</span><span class="o">(</span><span class="n">subscriptionId</span><span class="o">,</span> 
                                                           <span class="nc">AuditLevel</span><span class="o">.</span><span class="na">NONE</span><span class="o">,</span> 
                                                           <span class="n">requestOptions</span><span class="o">);</span>
</code></pre></div><div class="highlight"><pre class="highlight ruby tab-ruby"><code><span class="n">subscription_id</span> <span class="o">=</span> <span class="s2">"161692a4-c293-410c-a92f-939c5e3dcba7"</span>

<span class="n">subscription</span> <span class="o">=</span> <span class="no">KillBillClient</span><span class="o">::</span><span class="no">Model</span><span class="o">::</span><span class="no">Subscription</span><span class="p">.</span><span class="nf">find_by_id</span><span class="p">(</span><span class="n">subscription_id</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="n">subscriptionApi</span> <span class="o">=</span> <span class="n">killbill</span><span class="p">.</span><span class="n">api</span><span class="p">.</span><span class="n">SubscriptionApi</span><span class="p">()</span>
<span class="n">subscription_id</span> <span class="o">=</span> <span class="s">'4aab9b96-c2e7-4641-a6d9-db984969201e'</span>

<span class="n">subscription</span> <span class="o">=</span> <span class="n">subscriptionApi</span><span class="p">.</span><span class="n">get_subscription</span><span class="p">(</span><span class="n">subscription_id</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">const</span> <span class="nx">api</span><span class="p">:</span> <span class="nx">killbill</span><span class="p">.</span><span class="nx">SubscriptionApi</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">killbill</span><span class="p">.</span><span class="nx">SubscriptionApi</span><span class="p">(</span><span class="nx">config</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">subscriptionId</span><span class="o">=</span> <span class="dl">'</span><span class="s1">a07be253-f7ce-4719-9959-037e05ff0777</span><span class="dl">'</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">audit</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">NONE</span><span class="dl">'</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">response</span><span class="p">:</span> <span class="nx">AxiosResponse</span><span class="o">&lt;</span><span class="nx">killbill</span><span class="p">.</span><span class="nx">Subscription</span><span class="p">,</span> <span class="nx">any</span><span class="o">&gt;</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">api</span><span class="p">.</span><span class="nx">getSubscription</span><span class="p">(</span><span class="nx">subscriptionId</span><span class="p">,</span> <span class="nx">audit</span><span class="p">);</span>
</code></pre></div><div class="highlight"><pre class="highlight php tab-php"><code><span class="nv">$apiInstance</span> <span class="o">=</span> <span class="nv">$client</span><span class="o">-&gt;</span><span class="nf">getSubscriptionApi</span><span class="p">();</span>

<span class="nv">$subscriptionId</span> <span class="o">=</span> <span class="s2">"88d1878e-fb60-4497-95c2-ec71b4aa2a21"</span><span class="p">;</span>
<span class="nv">$audit</span> <span class="o">=</span> <span class="s2">"NONE"</span><span class="p">;</span>

<span class="nv">$result</span> <span class="o">=</span> <span class="nv">$apiInstance</span> <span class="o">-&gt;</span> <span class="nf">getSubscription</span><span class="p">(</span><span class="nv">$subscriptionId</span><span class="p">,</span> <span class="nv">$audit</span><span class="p">);</span>
</code></pre></div>
<blockquote>
<p>Example Response:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"accountId"</span><span class="p">:</span><span class="s2">"581d86fc-7cfc-46f2-b6d4-4dbc1d98beb3"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"bundleId"</span><span class="p">:</span><span class="s2">"3b7a754c-4fe3-49a4-a56c-c8f56fc4116c"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"subscriptionId"</span><span class="p">:</span><span class="s2">"d4a919f4-7459-494f-85e5-af8880f63e90"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"externalKey"</span><span class="p">:</span><span class="s2">"somethingSpecial"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"bundleExternalKey"</span><span class="p">:</span><span class="s2">"somethingAlsoSpecial"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"startDate"</span><span class="p">:</span><span class="s2">"2018-07-19"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"productName"</span><span class="p">:</span><span class="s2">"Super"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"productCategory"</span><span class="p">:</span><span class="s2">"BASE"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"billingPeriod"</span><span class="p">:</span><span class="s2">"MONTHLY"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"phaseType"</span><span class="p">:</span><span class="s2">"TRIAL"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"priceList"</span><span class="p">:</span><span class="s2">"DEFAULT"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"planName"</span><span class="p">:</span><span class="s2">"super-monthly"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"state"</span><span class="p">:</span><span class="s2">"ACTIVE"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"sourceType"</span><span class="p">:</span><span class="s2">"NATIVE"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"cancelledDate"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"chargedThroughDate"</span><span class="p">:</span><span class="s2">"2018-07-19"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"billingStartDate"</span><span class="p">:</span><span class="s2">"2018-07-19"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"billingEndDate"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"billCycleDayLocal"</span><span class="p">:</span><span class="mi">18</span><span class="p">,</span><span class="w">
    </span><span class="nl">"events"</span><span class="p">:</span><span class="w">
    </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"eventId"</span><span class="p">:</span><span class="s2">"d1fc7c9a-bdcd-447c-90f4-72c8de37d457"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"billingPeriod"</span><span class="p">:</span><span class="s2">"MONTHLY"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"effectiveDate"</span><span class="p">:</span><span class="s2">"2018-07-19"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"plan"</span><span class="p">:</span><span class="s2">"super-monthly"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"product"</span><span class="p">:</span><span class="s2">"Super"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"priceList"</span><span class="p">:</span><span class="s2">"DEFAULT"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"eventType"</span><span class="p">:</span><span class="s2">"START_ENTITLEMENT"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"isBlockedBilling"</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="nl">"isBlockedEntitlement"</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="nl">"serviceName"</span><span class="p">:</span><span class="s2">"entitlement-service"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"serviceStateName"</span><span class="p">:</span><span class="s2">"ENT_STARTED"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"phase"</span><span class="p">:</span><span class="s2">"super-monthly-trial"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"auditLogs"</span><span class="p">:[]</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"eventId"</span><span class="p">:</span><span class="s2">"e1cea834-9c21-450a-8ff5-8e1ebef705d1"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"billingPeriod"</span><span class="p">:</span><span class="s2">"MONTHLY"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"effectiveDate"</span><span class="p">:</span><span class="s2">"2018-07-19"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"plan"</span><span class="p">:</span><span class="s2">"super-monthly"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"product"</span><span class="p">:</span><span class="s2">"Super"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"priceList"</span><span class="p">:</span><span class="s2">"DEFAULT"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"eventType"</span><span class="p">:</span><span class="s2">"START_BILLING"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"isBlockedBilling"</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="nl">"isBlockedEntitlement"</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="nl">"serviceName"</span><span class="p">:</span><span class="s2">"billing-service"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"serviceStateName"</span><span class="p">:</span><span class="s2">"START_BILLING"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"phase"</span><span class="p">:</span><span class="s2">"super-monthly-trial"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"auditLogs"</span><span class="p">:[]</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"eventId"</span><span class="p">:</span><span class="s2">"c9045227-4638-46ca-9a4a-2d3086168505"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"billingPeriod"</span><span class="p">:</span><span class="s2">"MONTHLY"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"effectiveDate"</span><span class="p">:</span><span class="s2">"2018-08-18"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"plan"</span><span class="p">:</span><span class="s2">"super-monthly"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"product"</span><span class="p">:</span><span class="s2">"Super"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"priceList"</span><span class="p">:</span><span class="s2">"DEFAULT"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"eventType"</span><span class="p">:</span><span class="s2">"PHASE"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"isBlockedBilling"</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="nl">"isBlockedEntitlement"</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="nl">"serviceName"</span><span class="p">:</span><span class="s2">"entitlement+billing-service"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"serviceStateName"</span><span class="p">:</span><span class="s2">"PHASE"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"phase"</span><span class="p">:</span><span class="s2">"super-monthly-evergreen"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"auditLogs"</span><span class="p">:[]</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nl">"priceOverrides"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"prices"</span><span class="p">:</span><span class="w">
    </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"planName"</span><span class="p">:</span><span class="s2">"super-monthly"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"phaseName"</span><span class="p">:</span><span class="s2">"super-monthly-trial"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"phaseType"</span><span class="p">:</span><span class="s2">"TRIAL"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"fixedPrice"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w">
            </span><span class="nl">"recurringPrice"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="nl">"usagePrices"</span><span class="p">:[]</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"planName"</span><span class="p">:</span><span class="s2">"super-monthly"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"phaseName"</span><span class="p">:</span><span class="s2">"super-monthly-evergreen"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"phaseType"</span><span class="p">:</span><span class="s2">"EVERGREEN"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"fixedPrice"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="nl">"recurringPrice"</span><span class="p">:</span><span class="mf">1000.00</span><span class="p">,</span><span class="w">
            </span><span class="nl">"usagePrices"</span><span class="p">:[]</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nl">"auditLogs"</span><span class="p">:[]}</span><span class="w">
</span></code></pre></div>
<p><strong>Query Parameters</strong></p>

<table><thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Required</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><strong>audit</strong></td>
<td>string</td>
<td>no</td>
<td>&quot;NONE&quot;</td>
<td>Level of audit information to return</td>
</tr>
</tbody></table>

<p>Audit information options are &quot;NONE&quot;, &quot;MINIMAL&quot; (only inserts), or &quot;FULL&quot;.</p>

<p><strong>Response</strong></p>

<p>If successful, returns a status code of 200 and a subscription resource object.</p>
<h3 id='retrieve-a-subscription-by-key'>Retrieve a subscription by key</h3>
<p>This API retrieves a subscription resource object based on its external key </p>

<p><strong>HTTP Request</strong></p>

<p><code>GET http://127.0.0.1:8080/1.0/kb/subscriptions/</code></p>

<blockquote>
<p>Example Request:</p>
</blockquote>
<div class="highlight"><pre class="highlight shell tab-shell"><code>curl <span class="nt">-v</span> <span class="se">\</span>
    <span class="nt">-u</span> admin:password <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-ApiKey: bob"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-ApiSecret: lazar"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"Accept: application/json"</span> <span class="se">\</span>
    <span class="s1">'http://localhost:8080/1.0/kb/subscriptions?externalKey=somethingSpecial'</span>
</code></pre></div><div class="highlight"><pre class="highlight java tab-java"><code><span class="kn">import</span> <span class="nn">org.killbill.billing.client.api.gen.SubscriptionApi</span><span class="o">;</span>
<span class="kd">protected</span> <span class="nc">SubscriptionApi</span> <span class="n">subscriptionApi</span><span class="o">;</span>

<span class="nc">String</span> <span class="n">externalKey</span> <span class="o">=</span> <span class="s">"somethingSpecial"</span><span class="o">;</span>
<span class="nc">Subscription</span> <span class="n">subscription</span> <span class="o">=</span> <span class="n">subscriptionApi</span><span class="o">.</span><span class="na">getSubscriptionByKey</span><span class="o">(</span><span class="n">externalKey</span><span class="o">,</span> <span class="n">requestOptions</span><span class="o">);</span>
</code></pre></div><div class="highlight"><pre class="highlight ruby tab-ruby"><code><span class="n">external_key</span> <span class="o">=</span> <span class="s2">"somethingSpecial"</span>
<span class="n">subscription</span> <span class="o">=</span> <span class="no">KillBillClient</span><span class="o">::</span><span class="no">Model</span><span class="o">::</span><span class="no">Subscription</span><span class="p">.</span><span class="nf">find_by_external_key</span><span class="p">(</span><span class="n">external_key</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="n">subscriptionApi</span> <span class="o">=</span> <span class="n">killbill</span><span class="p">.</span><span class="n">api</span><span class="p">.</span><span class="n">SubscriptionApi</span><span class="p">()</span>
<span class="n">external_key</span> <span class="o">=</span> <span class="s">'somethingSpecial'</span>
<span class="n">subscription</span> <span class="o">=</span> <span class="n">subscriptionApi</span><span class="p">.</span><span class="n">get_subscription_by_key</span><span class="p">(</span><span class="n">external_key</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">const</span> <span class="nx">api</span><span class="p">:</span> <span class="nx">killbill</span><span class="p">.</span><span class="nx">SubscriptionApi</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">killbill</span><span class="p">.</span><span class="nx">SubscriptionApi</span><span class="p">(</span><span class="nx">config</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">key</span><span class="o">=</span> <span class="dl">'</span><span class="s1">somethingSpecial</span><span class="dl">'</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">audit</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">NONE</span><span class="dl">'</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">response</span><span class="p">:</span> <span class="nx">AxiosResponse</span><span class="o">&lt;</span><span class="nx">killbill</span><span class="p">.</span><span class="nx">Subscription</span><span class="p">,</span> <span class="nx">any</span><span class="o">&gt;</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">api</span><span class="p">.</span><span class="nx">getSubscriptionByKey</span><span class="p">(</span><span class="nx">key</span><span class="p">,</span> <span class="nx">audit</span><span class="p">);</span>
</code></pre></div><div class="highlight"><pre class="highlight php tab-php"><code><span class="nv">$apiInstance</span> <span class="o">=</span> <span class="nv">$client</span><span class="o">-&gt;</span><span class="nf">getSubscriptionApi</span><span class="p">();</span>

<span class="nv">$externalKey</span> <span class="o">=</span> <span class="s2">"somethingSpecial"</span><span class="p">;</span>
<span class="nv">$audit</span> <span class="o">=</span> <span class="s2">"NONE"</span><span class="p">;</span>

<span class="nv">$result</span> <span class="o">=</span> <span class="nv">$apiInstance</span> <span class="o">-&gt;</span> <span class="nf">getSubscriptionByKey</span><span class="p">(</span><span class="nv">$externalKey</span><span class="p">,</span> <span class="nv">$audit</span><span class="p">);</span>
</code></pre></div>
<blockquote>
<p>Example Response:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"accountId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1f979085-1765-471b-878a-5f640db4d831"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"bundleId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"8815e8c0-afab-41b9-b793-cb8fef2382e4"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"bundleExternalKey"</span><span class="p">:</span><span class="w"> </span><span class="s2">"8815e8c0-afab-41b9-b793-cb8fef2382e4"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"subscriptionId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"8e5c5339-1cad-46c6-ab18-3d5ddc1b2414"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"externalKey"</span><span class="p">:</span><span class="w"> </span><span class="s2">"somethingSpecial"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"startDate"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-01-08"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"productName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Pistol"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"productCategory"</span><span class="p">:</span><span class="w"> </span><span class="s2">"BASE"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"billingPeriod"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MONTHLY"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"phaseType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"EVERGREEN"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"priceList"</span><span class="p">:</span><span class="w"> </span><span class="s2">"notrial"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"planName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"pistol-monthly-notrial"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"state"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ACTIVE"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"sourceType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"NATIVE"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"cancelledDate"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nl">"chargedThroughDate"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-05-08"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"billingStartDate"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-01-08"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"billingEndDate"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nl">"billCycleDayLocal"</span><span class="p">:</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span><span class="w">
  </span><span class="nl">"events"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"eventId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1d24928e-790d-4dc9-8a88-c4eaa56de392"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"billingPeriod"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MONTHLY"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"effectiveDate"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-01-08"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"plan"</span><span class="p">:</span><span class="w"> </span><span class="s2">"pistol-monthly-notrial"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"product"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Pistol"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"priceList"</span><span class="p">:</span><span class="w"> </span><span class="s2">"notrial"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"eventType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"START_ENTITLEMENT"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"isBlockedBilling"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
      </span><span class="nl">"isBlockedEntitlement"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
      </span><span class="nl">"serviceName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"entitlement-service"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"serviceStateName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ENT_STARTED"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"phase"</span><span class="p">:</span><span class="w"> </span><span class="s2">"pistol-monthly-notrial-evergreen"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"auditLogs"</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"eventId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"3aaa3239-2bc6-4f04-977b-fce5de098af8"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"billingPeriod"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MONTHLY"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"effectiveDate"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-01-08"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"plan"</span><span class="p">:</span><span class="w"> </span><span class="s2">"pistol-monthly-notrial"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"product"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Pistol"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"priceList"</span><span class="p">:</span><span class="w"> </span><span class="s2">"notrial"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"eventType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"START_BILLING"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"isBlockedBilling"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
      </span><span class="nl">"isBlockedEntitlement"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
      </span><span class="nl">"serviceName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"billing-service"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"serviceStateName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"START_BILLING"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"phase"</span><span class="p">:</span><span class="w"> </span><span class="s2">"pistol-monthly-notrial-evergreen"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"auditLogs"</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="nl">"priceOverrides"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nl">"prices"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"planName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"pistol-monthly-notrial"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"phaseName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"pistol-monthly-notrial-evergreen"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"phaseType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"EVERGREEN"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"fixedPrice"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nl">"recurringPrice"</span><span class="p">:</span><span class="w"> </span><span class="mf">19.95</span><span class="p">,</span><span class="w">
      </span><span class="nl">"usagePrices"</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="nl">"auditLogs"</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p><strong>Query Parameters</strong></p>

<table><thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Required</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><strong>externalKey</strong></td>
<td>String</td>
<td>yes</td>
<td>none</td>
<td>The subscription external key</td>
</tr>
<tr>
<td><strong>audit</strong></td>
<td>string</td>
<td>no</td>
<td>&quot;NONE&quot;</td>
<td>Level of audit information to return</td>
</tr>
</tbody></table>

<p>Audit information options are &quot;NONE&quot;, &quot;MINIMAL&quot; (only inserts), or &quot;FULL&quot;.</p>

<p><strong>Response</strong></p>

<p>If successful, returns a status code of 200 and a subscription resource object.</p>
<h3 id='update-the-bcd-associated-with-a-subscription'>Update the BCD associated with a subscription</h3>
<p>This API allows you to change the Bill Cycle Date, BCD, for a given subscription.
This only applies to subscriptions whose recurring term is month based -- e.g <code>MONTHLY</code>, <code>ANNUAL</code>, ... </p>

<p>For example if a given subscription was invoiced on the 1st, then one could use this API
to realign invoicing, let&#39;s say on the 16th. </p>

<p><strong>HTTP Request</strong> </p>

<p><code>PUT http://127.0.0.1:8080/1.0/kb/subscriptions/{subscriptionId}/bcd</code></p>

<blockquote>
<p>Example Request:</p>
</blockquote>
<div class="highlight"><pre class="highlight shell tab-shell"><code>curl <span class="nt">-v</span> <span class="se">\</span>
    <span class="nt">-X</span> PUT <span class="se">\</span>
    <span class="nt">-u</span> admin:password <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-ApiKey: bob"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-ApiSecret: lazar"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-CreatedBy: demo"</span> <span class="se">\</span>
    <span class="nt">-d</span> <span class="s1">'{ "billCycleDayLocal": 16 }'</span> <span class="se">\</span>
    <span class="s1">'http://127.0.0.1:8080/1.0/kb/subscriptions/77e23878-8b9d-403b-bf31-93003e125712/bcd'</span> 
</code></pre></div><div class="highlight"><pre class="highlight java tab-java"><code><span class="kn">import</span> <span class="nn">org.killbill.billing.client.api.gen.SubscriptionApi</span><span class="o">;</span>
<span class="kd">protected</span> <span class="nc">SubscriptionApi</span> <span class="n">subscriptionApi</span><span class="o">;</span>

<span class="no">UUID</span> <span class="n">subscriptionId</span> <span class="o">=</span> <span class="no">UUID</span><span class="o">.</span><span class="na">fromString</span><span class="o">(</span><span class="s">"905a0636-ab63-40c0-acd4-b461b6808b5d"</span><span class="o">);</span>

<span class="nc">Subscription</span> <span class="n">updatedSubscription</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Subscription</span><span class="o">();</span>
<span class="n">updatedSubscription</span><span class="o">.</span><span class="na">setSubscriptionId</span><span class="o">(</span><span class="n">subscriptionId</span><span class="o">);</span>
<span class="n">updatedSubscription</span><span class="o">.</span><span class="na">setBillCycleDayLocal</span><span class="o">(</span><span class="mi">9</span><span class="o">);</span>

<span class="nc">LocalDate</span> <span class="n">effectiveFromDate</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>

<span class="n">subscriptionApi</span><span class="o">.</span><span class="na">updateSubscriptionBCD</span><span class="o">(</span><span class="n">subscriptionId</span><span class="o">,</span> 
                                      <span class="n">updatedSubscription</span><span class="o">,</span> 
                                      <span class="n">effectiveFromDate</span><span class="o">,</span> 
                                      <span class="n">requestOptions</span><span class="o">);</span>
</code></pre></div><div class="highlight"><pre class="highlight ruby tab-ruby"><code><span class="n">user</span> <span class="o">=</span> <span class="s2">"demo"</span>
<span class="n">reason</span> <span class="o">=</span> <span class="kp">nil</span>
<span class="n">comment</span> <span class="o">=</span> <span class="kp">nil</span>

<span class="n">subscription</span>                      <span class="o">=</span> <span class="no">KillBillClient</span><span class="o">::</span><span class="no">Model</span><span class="o">::</span><span class="no">Subscription</span><span class="p">.</span><span class="nf">new</span>
<span class="n">subscription</span><span class="p">.</span><span class="nf">subscription_id</span>      <span class="o">=</span> <span class="s2">"161692a4-c293-410c-a92f-939c5e3dcba7"</span>
<span class="n">subscription</span><span class="p">.</span><span class="nf">bill_cycle_day_local</span> <span class="o">=</span> <span class="mi">16</span>

<span class="n">effective_from_date</span>  <span class="o">=</span> <span class="kp">nil</span>
<span class="n">force_past_effective_date</span> <span class="o">=</span> <span class="kp">nil</span>

<span class="n">subscription</span><span class="p">.</span><span class="nf">update_bcd</span><span class="p">(</span><span class="n">user</span><span class="p">,</span> 
                        <span class="n">reason</span><span class="p">,</span> 
                        <span class="n">comment</span><span class="p">,</span> 
                        <span class="n">effective_from_date</span><span class="p">,</span> 
                        <span class="n">force_past_effective_date</span><span class="p">,</span> 
                        <span class="n">options</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="n">subscriptionApi</span> <span class="o">=</span> <span class="n">killbill</span><span class="p">.</span><span class="n">api</span><span class="p">.</span><span class="n">SubscriptionApi</span><span class="p">()</span>
<span class="n">subscription_id</span> <span class="o">=</span> <span class="s">'161692a4-c293-410c-a92f-939c5e3dcba7'</span>
<span class="n">body</span> <span class="o">=</span> <span class="n">Subscription</span><span class="p">(</span><span class="n">subscription_id</span><span class="o">=</span><span class="n">subscription_id</span><span class="p">,</span>
                    <span class="n">bill_cycle_day_local</span><span class="o">=</span><span class="mi">26</span><span class="p">)</span>

<span class="n">subscriptionApi</span><span class="p">.</span><span class="n">update_subscription_bcd</span><span class="p">(</span><span class="n">subscription_id</span><span class="p">,</span> 
                                        <span class="n">body</span><span class="p">,</span> 
                                        <span class="n">created_by</span><span class="o">=</span><span class="s">'demo'</span><span class="p">,</span>
                                        <span class="n">reason</span><span class="o">=</span><span class="s">'reason'</span><span class="p">,</span> 
                                        <span class="n">comment</span><span class="o">=</span><span class="s">'comment'</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">const</span> <span class="nx">api</span><span class="p">:</span> <span class="nx">killbill</span><span class="p">.</span><span class="nx">SubscriptionApi</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">killbill</span><span class="p">.</span><span class="nx">SubscriptionApi</span><span class="p">(</span><span class="nx">config</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">subscription</span><span class="p">:</span> <span class="nx">Subscription</span> <span class="o">=</span> <span class="p">{</span><span class="na">billCycleDayLocal</span><span class="p">:</span> <span class="mi">10</span><span class="p">};</span>
<span class="kd">const</span> <span class="nx">subscriptionId</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">e5254822-680f-4720-b5e1-a7146cefb904</span><span class="dl">'</span><span class="p">;</span>

<span class="nx">api</span><span class="p">.</span><span class="nx">updateSubscriptionBCD</span><span class="p">(</span><span class="nx">subscription</span><span class="p">,</span> <span class="nx">subscriptionId</span><span class="p">,</span> <span class="dl">'</span><span class="s1">created_by</span><span class="dl">'</span><span class="p">);</span>
</code></pre></div><div class="highlight"><pre class="highlight php tab-php"><code><span class="nv">$apiInstance</span> <span class="o">=</span> <span class="nv">$client</span><span class="o">-&gt;</span><span class="nf">getSubscriptionApi</span><span class="p">();</span>

<span class="nv">$xKillbillCreatedBy</span> <span class="o">=</span> <span class="s2">"user"</span><span class="p">;</span>
<span class="nv">$xKillbillReason</span> <span class="o">=</span> <span class="s2">"reason"</span><span class="p">;</span>
<span class="nv">$xKillbillComment</span> <span class="o">=</span> <span class="s2">"comment"</span><span class="p">;</span>

<span class="nv">$body</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Subscription</span><span class="p">();</span>
<span class="nv">$body</span> <span class="o">-&gt;</span> <span class="nf">setBillCycleDayLocal</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span>
<span class="nv">$subscriptionId</span> <span class="o">=</span> <span class="s2">"52bee217-4ed9-40a3-8b89-baa1cb1e6f95"</span><span class="p">;</span>

<span class="nv">$effectiveFromDate</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
<span class="nv">$forceNewBcdWithPastEffectiveDate</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>

<span class="nv">$apiInstance</span><span class="o">-&gt;</span><span class="nf">updateSubscriptionBCD</span><span class="p">(</span><span class="nv">$body</span><span class="p">,</span> <span class="nv">$xKillbillCreatedBy</span><span class="p">,</span> <span class="nv">$subscriptionId</span><span class="p">,</span> <span class="nv">$xKillbillReason</span><span class="p">,</span> <span class="nv">$xKillbillComment</span><span class="p">,</span>  <span class="nv">$effectiveFromDate</span><span class="p">,</span> <span class="nv">$forceNewBcdWithPastEffectiveDate</span><span class="p">);</span>
</code></pre></div>
<p><strong>Request Body</strong></p>

<p>The new BCD needs to be specified in the request body via the <code>billCycleDayLocal</code> field.</p>

<p><strong>Query Parameters</strong></p>

<table><thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Required</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><strong>effectiveFromDate</strong></td>
<td>string</td>
<td>no</td>
<td>immediate</td>
<td>Date on which this change becomes effective in <code>yyyy-mm-dd</code> format.</td>
</tr>
<tr>
<td><strong>forceNewBcdWithPastEffectiveDate</strong></td>
<td>boolean</td>
<td>no</td>
<td>false</td>
<td>See below</td>
</tr>
</tbody></table>

<p>By default the effective date must be in the future so as to not modify existing invoices. Setting <strong>forceNewBcdWithPastEffectiveDate</strong> to true allows the date to be set in the past. </p>

<p>Secondly, even after this endpoint is executed, the <a href="subscription.html#subscription-retrieve-a-subscription-by-id">Retrieve a Subscription</a> endpoint will still return the old BCD until an invoice is generated on the new BCD.</p>

<p><strong>Response</strong></p>

<p>If successful, returns a status code of 204 and an empty body.</p>
<h3 id='update-the-subscription-quantity'>Update the subscription quantity</h3>
<p>This API allows you to change the subscription quantity.</p>

<p><strong>HTTP Request</strong> </p>

<p><code>PUT http://127.0.0.1:8080/1.0/kb/subscriptions/{subscriptionId}/quantity</code></p>

<blockquote>
<p>Example Request:</p>
</blockquote>
<div class="highlight"><pre class="highlight shell tab-shell"><code>curl <span class="nt">-v</span> <span class="se">\</span>
    <span class="nt">-X</span> PUT <span class="se">\</span>
    <span class="nt">-u</span> admin:password <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-ApiKey: bob"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-ApiSecret: lazar"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-CreatedBy: demo"</span> <span class="se">\</span>
    <span class="nt">-d</span> <span class="s1">'{ 
            "quantity": "2" 
        }'</span> <span class="se">\</span>
    <span class="s1">'http://127.0.0.1:8080/1.0/kb/subscriptions/c20715fa-8d69-488d-a094-51da0cdf999b/quantity'</span>
</code></pre></div><div class="highlight"><pre class="highlight java tab-java"><code><span class="kn">import</span> <span class="nn">org.killbill.billing.client.api.gen.SubscriptionApi</span><span class="o">;</span>
<span class="kd">protected</span> <span class="nc">SubscriptionApi</span> <span class="n">subscriptionApi</span><span class="o">;</span>

<span class="no">UUID</span> <span class="n">subscriptionId</span> <span class="o">=</span> <span class="no">UUID</span><span class="o">.</span><span class="na">fromString</span><span class="o">(</span><span class="s">"f0143401-5b9b-41d1-b9c0-8513f1f0cf0b"</span><span class="o">);</span>

<span class="nc">Subscription</span> <span class="n">body</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Subscription</span><span class="o">();</span>
<span class="n">body</span><span class="o">.</span><span class="na">setQuantity</span><span class="o">(</span><span class="mi">3</span><span class="o">);</span>
<span class="nc">LocalDate</span> <span class="n">effectiveFromDate</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>

<span class="n">subscriptionApi</span><span class="o">.</span><span class="na">updateSubscriptionQuantity</span><span class="o">(</span><span class="n">subscriptionId</span><span class="o">,</span> <span class="n">body</span><span class="o">,</span> <span class="n">effectiveFromDate</span><span class="o">,</span> <span class="n">requestOptions</span><span class="o">);</span>
</code></pre></div><div class="highlight"><pre class="highlight ruby tab-ruby"><code><span class="no">TODO</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="n">subscriptionApi</span> <span class="o">=</span> <span class="n">killbill</span><span class="p">.</span><span class="n">api</span><span class="p">.</span><span class="n">SubscriptionApi</span><span class="p">()</span>
<span class="n">subscription_id</span> <span class="o">=</span> <span class="s">'7b3f0181-d9e8-4886-a90a-af35e671f5f0'</span>
<span class="n">body</span> <span class="o">=</span> <span class="n">Subscription</span><span class="p">(</span><span class="n">subscription_id</span><span class="o">=</span><span class="n">subscription_id</span><span class="p">,</span>
                    <span class="n">quantity</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="n">subscriptionApi</span><span class="p">.</span><span class="n">update_subscription_quantity</span><span class="p">(</span><span class="n">subscription_id</span><span class="p">,</span>
                                             <span class="n">body</span><span class="p">,</span>
                                             <span class="n">created_by</span><span class="o">=</span><span class="s">'demo'</span><span class="p">,</span>
                                             <span class="n">reason</span><span class="o">=</span><span class="s">'reason'</span><span class="p">,</span>
                                             <span class="n">comment</span><span class="o">=</span><span class="s">'comment'</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">const</span> <span class="nx">api</span><span class="p">:</span> <span class="nx">killbill</span><span class="p">.</span><span class="nx">SubscriptionApi</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">killbill</span><span class="p">.</span><span class="nx">SubscriptionApi</span><span class="p">(</span><span class="nx">config</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">subscription</span><span class="p">:</span> <span class="nx">Subscription</span> <span class="o">=</span> <span class="p">{</span><span class="na">quantity</span><span class="p">:</span> <span class="mi">3</span><span class="p">};</span>
    <span class="kd">const</span> <span class="nx">subscriptionId</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">e5254822-680f-4720-b5e1-a7146cefb904</span><span class="dl">'</span><span class="p">;</span>

<span class="nx">api</span><span class="p">.</span><span class="nx">updateSubscriptionQuantity</span><span class="p">(</span><span class="nx">subscription</span><span class="p">,</span> <span class="nx">subscriptionId</span><span class="p">,</span> <span class="dl">'</span><span class="s1">created_by</span><span class="dl">'</span><span class="p">);</span>
</code></pre></div><div class="highlight"><pre class="highlight php tab-php"><code><span class="nv">$apiInstance</span> <span class="o">=</span> <span class="nv">$client</span><span class="o">-&gt;</span><span class="nf">getSubscriptionApi</span><span class="p">();</span>

<span class="nv">$xKillbillCreatedBy</span> <span class="o">=</span> <span class="s2">"user"</span><span class="p">;</span>
<span class="nv">$xKillbillReason</span> <span class="o">=</span> <span class="s2">"reason"</span><span class="p">;</span>
<span class="nv">$xKillbillComment</span> <span class="o">=</span> <span class="s2">"comment"</span><span class="p">;</span>

<span class="nv">$body</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Subscription</span><span class="p">();</span>
<span class="nv">$body</span> <span class="o">-&gt;</span> <span class="nf">setQuantity</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>
<span class="nv">$subscriptionId</span> <span class="o">=</span> <span class="s2">"88d1878e-fb60-4497-95c2-ec71b4aa2a21"</span><span class="p">;</span>

<span class="nv">$effectiveFromDate</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
<span class="nv">$forceNewBcdWithPastEffectiveDate</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>

<span class="nv">$apiInstance</span> <span class="o">-&gt;</span> <span class="nf">updateSubscriptionQuantity</span><span class="p">(</span><span class="nv">$body</span><span class="p">,</span> <span class="nv">$xKillbillCreatedBy</span><span class="p">,</span> <span class="nv">$subscriptionId</span><span class="p">,</span> <span class="nv">$xKillbillReason</span><span class="p">,</span> <span class="nv">$xKillbillComment</span><span class="p">,</span> <span class="nv">$effectiveFromDate</span><span class="p">,</span> <span class="nv">$forceNewBcdWithPastEffectiveDate</span><span class="p">);</span>
</code></pre></div>
<p><strong>Request Body</strong></p>

<p>The quantity needs to be specified in the request body via the <code>quantity</code> field.</p>

<p><strong>Query Parameters</strong></p>

<table><thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Required</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><strong>effectiveFromDate</strong></td>
<td>string</td>
<td>no</td>
<td>immediate</td>
<td>Date on which this change becomes effective in <code>yyyy-mm-dd</code> format.</td>
</tr>
<tr>
<td><strong>forceNewQuantityWithPastEffectiveDate</strong></td>
<td>boolean</td>
<td>no</td>
<td>false</td>
<td>See below</td>
</tr>
</tbody></table>

<p>By default the effective date must be in the future so as to not modify existing invoices. Setting <strong>forceNewQuantityWithPastEffectiveDate</strong> to true allows the date to be set in the past. </p>

<p><strong>Response</strong></p>

<p>If successful, returns a status code of 204 and an empty body.</p>
<h3 id='change-subscription-plan'>Change subscription plan</h3>
<p>This API allows you to upgrade or downgrade a given subscription to a new <code>Plan</code>.</p>

<p><strong>HTTP Request</strong> </p>

<p><code>PUT http://127.0.0.1:8080/1.0/kb/subscriptions/{subscriptionId}</code></p>

<blockquote>
<p>Example Request:</p>
</blockquote>
<div class="highlight"><pre class="highlight shell tab-shell"><code><span class="c"># With productName, billingPeriod, priceList</span>
curl <span class="nt">-v</span> <span class="se">\</span>
    <span class="nt">-X</span> PUT <span class="se">\</span>
    <span class="nt">-u</span> admin:password <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-ApiKey: bob"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-ApiSecret: lazar"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-CreatedBy: demo"</span> <span class="se">\</span>
    <span class="nt">-d</span> <span class="s1">'{ 
            "productName": "Sports", 
            "billingPeriod": "MONTHLY", 
            "priceList": "DEFAULT"
        }'</span> <span class="se">\</span>
    <span class="s1">'http://127.0.0.1:8080/1.0/kb/subscriptions/77e23878-8b9d-403b-bf31-93003e125712'</span>

<span class="c"># with planName</span>
curl <span class="nt">-v</span> <span class="se">\</span>
    <span class="nt">-X</span> PUT <span class="se">\</span>
    <span class="nt">-u</span> admin:password <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-ApiKey: bob"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-ApiSecret: lazar"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-CreatedBy: demo"</span> <span class="se">\</span>
    <span class="nt">-d</span> <span class="s1">'{ 
            "planName": "sports-monthly"
        }'</span> <span class="se">\</span>
    <span class="s1">'http://127.0.0.1:8080/1.0/kb/subscriptions/e1868fa6-ea97-493e-870d-50787f4b5921'</span>
</code></pre></div><div class="highlight"><pre class="highlight java tab-java"><code><span class="kn">import</span> <span class="nn">org.killbill.billing.client.api.gen.SubscriptionApi</span><span class="o">;</span>
<span class="kd">protected</span> <span class="nc">SubscriptionApi</span> <span class="n">subscriptionApi</span><span class="o">;</span>

<span class="no">UUID</span> <span class="n">subscriptionId</span> <span class="o">=</span> <span class="no">UUID</span><span class="o">.</span><span class="na">fromString</span><span class="o">(</span><span class="s">"905a0636-ab63-40c0-acd4-b461b6808b5d"</span><span class="o">);</span>

<span class="nc">Subscription</span> <span class="n">newInput</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Subscription</span><span class="o">();</span>
<span class="n">newInput</span><span class="o">.</span><span class="na">setSubscriptionId</span><span class="o">(</span><span class="n">subscriptionId</span><span class="o">);</span>

<span class="n">newInput</span><span class="o">.</span><span class="na">setPlanName</span><span class="o">(</span><span class="s">"shotgun-monthly"</span><span class="o">);</span>

<span class="nc">LocalDate</span> <span class="n">requestedDate</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
<span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">String</span><span class="o">&gt;</span> <span class="no">NULL_PLUGIN_PROPERTIES</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>

<span class="c1">//specify either requestedDate or BillingActionPolicy</span>
<span class="n">subscriptionApi</span><span class="o">.</span><span class="na">changeSubscriptionPlan</span><span class="o">(</span><span class="n">subscriptionId</span><span class="o">,</span> 
                                       <span class="n">newInput</span><span class="o">,</span> 
                                       <span class="n">requestedDate</span><span class="o">,</span> 
                                       <span class="nc">BillingActionPolicy</span><span class="o">.</span><span class="na">IMMEDIATE</span><span class="o">,</span> 
                                       <span class="no">NULL_PLUGIN_PROPERTIES</span><span class="o">,</span> 
                                       <span class="n">requestOptions</span><span class="o">);</span>
</code></pre></div><div class="highlight"><pre class="highlight ruby tab-ruby"><code><span class="n">user</span> <span class="o">=</span> <span class="s2">"demo"</span>
<span class="n">reason</span> <span class="o">=</span> <span class="kp">nil</span>
<span class="n">comment</span> <span class="o">=</span> <span class="kp">nil</span>

<span class="n">input</span> <span class="o">=</span> <span class="p">{</span>
           <span class="ss">:productName</span> <span class="o">=&gt;</span> <span class="s1">'Super'</span><span class="p">,</span> 
           <span class="ss">:billingPeriod</span> <span class="o">=&gt;</span> <span class="s1">'MONTHLY'</span><span class="p">,</span> 
           <span class="ss">:priceList</span> <span class="o">=&gt;</span> <span class="s1">'DEFAULT'</span>
         <span class="p">}</span>

<span class="n">subscription</span> <span class="o">=</span> <span class="no">KillBillClient</span><span class="o">::</span><span class="no">Model</span><span class="o">::</span><span class="no">Subscription</span><span class="p">.</span><span class="nf">new</span>
<span class="n">subscription</span><span class="p">.</span><span class="nf">subscription_id</span> <span class="o">=</span> <span class="s2">"21541d56-c34a-4012-990a-2250e2822019"</span>         

<span class="n">requested_date</span> <span class="o">=</span> <span class="kp">nil</span>
<span class="n">billing_policy</span> <span class="o">=</span> <span class="kp">nil</span>
<span class="n">call_completion</span> <span class="o">=</span> <span class="kp">false</span>
<span class="n">target_phase_type</span> <span class="o">=</span> <span class="kp">nil</span>

<span class="n">subscription</span><span class="p">.</span><span class="nf">change_plan</span><span class="p">(</span><span class="n">input</span><span class="p">,</span> 
                         <span class="n">user</span><span class="p">,</span> 
                         <span class="n">reason</span><span class="p">,</span> 
                         <span class="n">comment</span><span class="p">,</span> 
                         <span class="n">requested_date</span><span class="p">,</span> 
                         <span class="n">billing_policy</span><span class="p">,</span>
                         <span class="n">target_phase_type</span><span class="p">,</span> 
                         <span class="n">call_completion</span><span class="p">,</span> 
                         <span class="n">options</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="n">subscriptionApi</span> <span class="o">=</span> <span class="n">killbill</span><span class="p">.</span><span class="n">api</span><span class="p">.</span><span class="n">SubscriptionApi</span><span class="p">()</span>
<span class="n">subscription_id</span> <span class="o">=</span> <span class="s">'97278000-72fd-45d7-9b67-e44690bdb074'</span>
<span class="n">body</span> <span class="o">=</span> <span class="n">Subscription</span><span class="p">(</span><span class="n">plan_name</span><span class="o">=</span><span class="s">'pistol-monthly'</span><span class="p">)</span>

<span class="n">subscriptionApi</span><span class="p">.</span><span class="n">change_subscription_plan</span><span class="p">(</span><span class="n">subscription_id</span><span class="p">,</span>
                                         <span class="n">body</span><span class="p">,</span>
                                         <span class="n">created_by</span><span class="o">=</span><span class="s">'demo'</span><span class="p">,</span>
                                         <span class="n">reason</span><span class="o">=</span><span class="s">'reason'</span><span class="p">,</span>
                                         <span class="n">comment</span><span class="o">=</span><span class="s">'comment'</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">const</span> <span class="nx">api</span><span class="p">:</span> <span class="nx">killbill</span><span class="p">.</span><span class="nx">SubscriptionApi</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">killbill</span><span class="p">.</span><span class="nx">SubscriptionApi</span><span class="p">(</span><span class="nx">config</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">subscription</span><span class="p">:</span> <span class="nx">Subscription</span> <span class="o">=</span> <span class="p">{</span><span class="na">planName</span><span class="p">:</span> <span class="dl">"</span><span class="s2">pistol-monthly-notrial</span><span class="dl">"</span><span class="p">};</span>
<span class="kd">const</span> <span class="nx">subscriptionId</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">e5254822-680f-4720-b5e1-a7146cefb904</span><span class="dl">'</span><span class="p">;</span>

<span class="nx">api</span><span class="p">.</span><span class="nx">changeSubscriptionPlan</span><span class="p">(</span><span class="nx">subscription</span><span class="p">,</span> <span class="nx">subscriptionId</span><span class="p">,</span> <span class="dl">'</span><span class="s1">created_by</span><span class="dl">'</span><span class="p">);</span>
</code></pre></div><div class="highlight"><pre class="highlight php tab-php"><code><span class="nv">$apiInstance</span> <span class="o">=</span> <span class="nv">$client</span><span class="o">-&gt;</span><span class="nf">getSubscriptionApi</span><span class="p">();</span>

<span class="nv">$xKillbillCreatedBy</span> <span class="o">=</span> <span class="s2">"user"</span><span class="p">;</span>
<span class="nv">$xKillbillReason</span> <span class="o">=</span> <span class="s2">"reason"</span><span class="p">;</span>
<span class="nv">$xKillbillComment</span> <span class="o">=</span> <span class="s2">"comment"</span><span class="p">;</span>

<span class="nv">$body</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Subscription</span><span class="p">();</span>
<span class="nv">$body</span> <span class="o">-&gt;</span> <span class="nf">setPlanName</span><span class="p">(</span><span class="s1">'pistol-monthly-notrial'</span><span class="p">);</span>

<span class="nv">$requestedDate</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
<span class="nv">$callCompletion</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
<span class="nv">$callTimeoutSec</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
<span class="nv">$billingPolicy</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
<span class="nv">$pluginProperty</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">"pluginProperty_example"</span><span class="p">);</span>

<span class="nv">$subscriptionId</span> <span class="o">=</span> <span class="s2">"52bee217-4ed9-40a3-8b89-baa1cb1e6f95"</span><span class="p">;</span>

<span class="nv">$apiInstance</span><span class="o">-&gt;</span><span class="nf">changeSubscriptionPlan</span><span class="p">(</span><span class="nv">$body</span><span class="p">,</span> <span class="nv">$xKillbillCreatedBy</span><span class="p">,</span> <span class="nv">$subscriptionId</span><span class="p">,</span> <span class="nv">$xKillbillReason</span><span class="p">,</span> <span class="nv">$xKillbillComment</span><span class="p">,</span> <span class="nv">$requestedDate</span><span class="p">,</span> <span class="nv">$callCompletion</span><span class="p">,</span> <span class="nv">$callTimeoutSec</span><span class="p">,</span> <span class="nv">$billingPolicy</span><span class="p">,</span> <span class="nv">$pluginProperty</span><span class="p">);</span>
</code></pre></div>
<p><strong>Request Body</strong></p>

<p>A subscription resource object specifying either the <code>planName</code> or a combination of <code>productName</code>, <code>billingPeriod</code> and <code>priceList</code>. </p>

<p><strong>Query Parameters</strong></p>

<table><thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Required</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><strong>billingPolicy</strong></td>
<td>string</td>
<td>no</td>
<td>default</td>
<td>Billing policy that will be used to make this change effective (see below)</td>
</tr>
<tr>
<td><strong>requestedDate</strong></td>
<td>string</td>
<td>no</td>
<td>immediate</td>
<td>Date/DateTime at which this change should become effective in <code>yyyy-mm-dd</code>/<code>yyyy-mm-ddThh:mm</code>  format.</td>
</tr>
<tr>
<td><strong>callCompletion</strong></td>
<td>boolean</td>
<td>no</td>
<td>false</td>
<td>see below</td>
</tr>
<tr>
<td><strong>callTimeoutSec</strong></td>
<td>long</td>
<td>no</td>
<td>unlimited?</td>
<td>Timeout in seconds (see below)</td>
</tr>
<tr>
<td><strong>pluginProperty</strong></td>
<td>array of strings</td>
<td>false</td>
<td>omit</td>
<td>list of plugin properties, if any</td>
</tr>
</tbody></table>

<p><strong>billingPolicy</strong>: Possible values are START_OF_TERM, END_OF_TERM, IMMEDIATE, or ILLEGAL</p>

<p><strong>requestedDate</strong>: This date is only used if no billingPolicy was specified.</p>

<p>Changing the plan associated to a subscription often triggers the creation of an invoice, and associated with this there is often a payment (against the invoice). If <strong>callCompletion</strong> is true, the call to this API will be delayed until the invoice is created and/or the payment is processed. However, the maximum delay in seconds will be given by <strong>callTimeoutSec</strong>.</p>

<p><strong>Response</strong></p>

<p>If successful, returns a status code of 204 and an empty body.</p>
<h3 id='undo-a-pending-change-plan-on-a-subscription'>Undo a pending change plan on a subscription</h3>
<p>This endpoint allows a pending <code>Plan</code> change (plan change request with a future effective date) for a given subscription to be canceled. Note that if the plan change is already effective, then it cannot be undone. </p>

<p><strong>HTTP Request</strong> </p>

<p><code>PUT http://127.0.0.1:8080/1.0/kb/subscriptions/{subscriptionId}/undoChangePlan</code></p>

<blockquote>
<p>Example Request:</p>
</blockquote>
<div class="highlight"><pre class="highlight shell tab-shell"><code>curl <span class="se">\</span>
    <span class="nt">-X</span> PUT <span class="se">\</span>
    <span class="nt">-u</span> admin:password <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-ApiKey: bob"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-ApiSecret: lazar"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-CreatedBy: demo"</span> <span class="se">\</span>
    <span class="s1">'http://127.0.0.1:8080/1.0/kb/subscriptions/77e23878-8b9d-403b-bf31-93003e125712/undoChangePlan'</span> 
</code></pre></div><div class="highlight"><pre class="highlight java tab-java"><code><span class="kn">import</span> <span class="nn">org.killbill.billing.client.api.gen.SubscriptionApi</span><span class="o">;</span>
<span class="kd">protected</span> <span class="nc">SubscriptionApi</span> <span class="n">subscriptionApi</span><span class="o">;</span>

<span class="no">UUID</span> <span class="n">subscriptionId</span> <span class="o">=</span> <span class="no">UUID</span><span class="o">.</span><span class="na">fromString</span><span class="o">(</span><span class="s">"1bb4b638-3886-4f73-90a5-89eb6d1bcf7f"</span><span class="o">);</span>
<span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">String</span><span class="o">&gt;</span> <span class="no">NULL_PLUGIN_PROPERTIES</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>

<span class="n">subscriptionApi</span><span class="o">.</span><span class="na">undoChangeSubscriptionPlan</span><span class="o">(</span><span class="n">subscriptionId</span><span class="o">,</span> 
                                           <span class="no">NULL_PLUGIN_PROPERTIES</span><span class="o">,</span> 
                                           <span class="n">requestOptions</span><span class="o">);</span>
</code></pre></div><div class="highlight"><pre class="highlight ruby tab-ruby"><code><span class="n">user</span> <span class="o">=</span> <span class="s2">"demo"</span>
<span class="n">reason</span> <span class="o">=</span> <span class="kp">nil</span>
<span class="n">comment</span> <span class="o">=</span> <span class="kp">nil</span>

<span class="n">subscription</span> <span class="o">=</span> <span class="no">KillBillClient</span><span class="o">::</span><span class="no">Model</span><span class="o">::</span><span class="no">Subscription</span><span class="p">.</span><span class="nf">new</span>
<span class="n">subscription</span><span class="p">.</span><span class="nf">subscription_id</span> <span class="o">=</span> <span class="s2">"fbe97f23-30da-4f7e-9987-3280034c5258"</span>

<span class="n">subscription</span><span class="p">.</span><span class="nf">undo_change_plan</span><span class="p">(</span><span class="n">user</span><span class="p">,</span> 
                              <span class="n">reason</span><span class="p">,</span> 
                              <span class="n">comment</span><span class="p">,</span> 
                              <span class="n">options</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="n">subscriptionApi</span> <span class="o">=</span> <span class="n">killbill</span><span class="p">.</span><span class="n">api</span><span class="p">.</span><span class="n">SubscriptionApi</span><span class="p">()</span>
<span class="n">subscription_id</span> <span class="o">=</span> <span class="s">'f5bb14ed-c6e8-4895-8d4e-34422e12cdfa'</span>

<span class="n">subscriptionApi</span><span class="p">.</span><span class="n">undo_change_subscription_plan</span><span class="p">(</span><span class="n">subscription_id</span><span class="p">,</span>
                                              <span class="n">created_by</span><span class="o">=</span><span class="s">'demo'</span><span class="p">,</span>
                                              <span class="n">reason</span><span class="o">=</span><span class="s">'reason'</span><span class="p">,</span>
                                              <span class="n">comment</span><span class="o">=</span><span class="s">'comment'</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">const</span> <span class="nx">api</span><span class="p">:</span> <span class="nx">killbill</span><span class="p">.</span><span class="nx">SubscriptionApi</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">killbill</span><span class="p">.</span><span class="nx">SubscriptionApi</span><span class="p">(</span><span class="nx">config</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">subscriptionId</span><span class="o">=</span> <span class="dl">'</span><span class="s1">1664777f-f194-48fd-a274-e883063790b1</span><span class="dl">'</span><span class="p">;</span>

<span class="nx">api</span><span class="p">.</span><span class="nx">undoChangeSubscriptionPlan</span><span class="p">(</span><span class="nx">subscriptionId</span><span class="p">,</span> <span class="dl">'</span><span class="s1">created-by</span><span class="dl">'</span><span class="p">);</span>
</code></pre></div><div class="highlight"><pre class="highlight php tab-php"><code><span class="nv">$apiInstance</span> <span class="o">=</span> <span class="nv">$client</span><span class="o">-&gt;</span><span class="nf">getSubscriptionApi</span><span class="p">();</span>

<span class="nv">$xKillbillCreatedBy</span> <span class="o">=</span> <span class="s2">"user"</span><span class="p">;</span>
<span class="nv">$xKillbillReason</span> <span class="o">=</span> <span class="s2">"reason"</span><span class="p">;</span>
<span class="nv">$xKillbillComment</span> <span class="o">=</span> <span class="s2">"comment"</span><span class="p">;</span>

<span class="nv">$subscriptionId</span> <span class="o">=</span> <span class="s2">"88d1878e-fb60-4497-95c2-ec71b4aa2a21"</span><span class="p">;</span>
<span class="nv">$pluginProperty</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">"pluginProperty_example"</span><span class="p">);</span>

<span class="nv">$apiInstance</span><span class="o">-&gt;</span><span class="nf">undoChangeSubscriptionPlan</span><span class="p">(</span><span class="nv">$subscriptionId</span><span class="p">,</span> <span class="nv">$xKillbillCreatedBy</span><span class="p">,</span> <span class="nv">$pluginProperty</span><span class="p">,</span> <span class="nv">$xKillbillReason</span><span class="p">,</span> <span class="nv">$xKillbillComment</span><span class="p">);</span>
</code></pre></div>
<p><strong>Query Parameters</strong></p>

<p><strong>Query Parameters</strong></p>

<table><thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Required</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><strong>pluginProperty</strong></td>
<td>array of strings</td>
<td>false</td>
<td>omit</td>
<td>list of plugin properties, if any</td>
</tr>
</tbody></table>

<p><strong>Response</strong></p>

<p>If successful, returns a status code of 204 and an empty body.</p>
<h3 id='cancel-a-subscription'>Cancel a subscription</h3>
<p>This API cancels an existing subscription.</p>

<p><strong>HTTP Request</strong> </p>

<p><code>DELETE http://127.0.0.1:8080/1.0/kb/subscriptions/{subscriptionId}</code></p>

<blockquote>
<p>Example Request:</p>
</blockquote>
<div class="highlight"><pre class="highlight shell tab-shell"><code>curl  <span class="nt">-v</span> <span class="se">\</span>
    <span class="nt">-X</span> DELETE <span class="se">\</span>
    <span class="nt">-u</span> admin:password <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-ApiKey: bob"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-ApiSecret: lazar"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-CreatedBy: demo"</span> <span class="se">\</span>
    <span class="s1">'http://127.0.0.1:8080/1.0/kb/subscriptions/77e23878-8b9d-403b-bf31-93003e125712'</span>
</code></pre></div><div class="highlight"><pre class="highlight java tab-java"><code><span class="kn">import</span> <span class="nn">org.killbill.billing.client.api.gen.SubscriptionApi</span><span class="o">;</span>
<span class="kd">protected</span> <span class="nc">SubscriptionApi</span> <span class="n">subscriptionApi</span><span class="o">;</span>

<span class="no">UUID</span> <span class="n">subscriptionId</span> <span class="o">=</span> <span class="no">UUID</span><span class="o">.</span><span class="na">fromString</span><span class="o">(</span><span class="s">"905a0636-ab63-40c0-acd4-b461b6808b5d"</span><span class="o">);</span>
<span class="nc">LocalDate</span> <span class="n">requestedDate</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
<span class="nc">EntitlementActionPolicy</span> <span class="n">entitlementPolicy</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
<span class="nc">BillingActionPolicy</span> <span class="n">billingPolicy</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
<span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">String</span><span class="o">&gt;</span> <span class="no">NULL_PLUGIN_PROPERTIES</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>

<span class="n">subscriptionApi</span><span class="o">.</span><span class="na">cancelSubscriptionPlan</span><span class="o">(</span><span class="n">subscriptionId</span><span class="o">,</span>
                                       <span class="n">requestedDate</span><span class="o">,</span> 
                                       <span class="n">entitlementPolicy</span><span class="o">,</span> 
                                       <span class="n">billingPolicy</span><span class="o">,</span> 
                                       <span class="no">NULL_PLUGIN_PROPERTIES</span><span class="o">,</span> 
                                       <span class="n">requestOptions</span><span class="o">);</span>
</code></pre></div><div class="highlight"><pre class="highlight ruby tab-ruby"><code><span class="n">user</span> <span class="o">=</span> <span class="s2">"demo"</span>
<span class="n">reason</span> <span class="o">=</span> <span class="kp">nil</span>
<span class="n">comment</span> <span class="o">=</span> <span class="kp">nil</span>

<span class="n">requested_date</span> <span class="o">=</span> <span class="kp">nil</span>
<span class="n">entitlement_policy</span> <span class="o">=</span> <span class="kp">nil</span>
<span class="n">billing_policy</span> <span class="o">=</span> <span class="kp">nil</span>
<span class="n">use_requested_date_for_billing</span> <span class="o">=</span> <span class="kp">nil</span>

<span class="n">subscription</span> <span class="o">=</span> <span class="no">KillBillClient</span><span class="o">::</span><span class="no">Model</span><span class="o">::</span><span class="no">Subscription</span><span class="p">.</span><span class="nf">new</span>
<span class="n">subscription</span><span class="p">.</span><span class="nf">subscription_id</span> <span class="o">=</span> <span class="s2">"21541d56-c34a-4012-990a-2250e2822019"</span>

<span class="n">subscription</span><span class="p">.</span><span class="nf">cancel</span><span class="p">(</span><span class="n">user</span><span class="p">,</span> 
                    <span class="n">reason</span><span class="p">,</span> 
                    <span class="n">comment</span><span class="p">,</span> 
                    <span class="n">requested_date</span><span class="p">,</span> 
                    <span class="n">entitlement_policy</span><span class="p">,</span> 
                    <span class="n">billing_policy</span><span class="p">,</span> 
                    <span class="n">use_requested_date_for_billing</span><span class="p">,</span> 
                    <span class="n">options</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="n">subscriptionApi</span> <span class="o">=</span> <span class="n">killbill</span><span class="p">.</span><span class="n">api</span><span class="p">.</span><span class="n">SubscriptionApi</span><span class="p">()</span>
<span class="n">subscription_id</span> <span class="o">=</span> <span class="s">'ee508b5b-46b8-42a7-8988-16c0470de4ae'</span>

<span class="n">subscriptionApi</span><span class="p">.</span><span class="n">cancel_subscription_plan</span><span class="p">(</span><span class="n">subscription_id</span><span class="p">,</span>
                                         <span class="n">created_by</span><span class="o">=</span><span class="s">'demo'</span><span class="p">,</span>
                                         <span class="n">reason</span><span class="o">=</span><span class="s">'reason'</span><span class="p">,</span>
                                         <span class="n">comment</span><span class="o">=</span><span class="s">'comment'</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">const</span> <span class="nx">api</span><span class="p">:</span> <span class="nx">killbill</span><span class="p">.</span><span class="nx">SubscriptionApi</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">killbill</span><span class="p">.</span><span class="nx">SubscriptionApi</span><span class="p">(</span><span class="nx">config</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">subscriptionId</span><span class="o">=</span> <span class="dl">'</span><span class="s1">66d3d89f-e074-49cc-bf9a-96a2e57d15ab</span><span class="dl">'</span><span class="p">;</span>

<span class="nx">api</span><span class="p">.</span><span class="nx">cancelSubscriptionPlan</span><span class="p">(</span><span class="nx">subscriptionId</span><span class="p">,</span> <span class="dl">'</span><span class="s1">created-by</span><span class="dl">'</span><span class="p">);</span>
</code></pre></div><div class="highlight"><pre class="highlight php tab-php"><code><span class="nv">$apiInstance</span> <span class="o">=</span> <span class="nv">$client</span><span class="o">-&gt;</span><span class="nf">getSubscriptionApi</span><span class="p">();</span>

<span class="nv">$xKillbillCreatedBy</span> <span class="o">=</span> <span class="s2">"user"</span><span class="p">;</span>
<span class="nv">$xKillbillReason</span> <span class="o">=</span> <span class="s2">"reason"</span><span class="p">;</span>
<span class="nv">$xKillbillComment</span> <span class="o">=</span> <span class="s2">"comment"</span><span class="p">;</span>

<span class="nv">$subscriptionId</span> <span class="o">=</span> <span class="s2">"71ccbec4-af0e-4011-8f65-9acb89204e45"</span><span class="p">;</span>
<span class="nv">$requestedDate</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
<span class="nv">$callCompletion</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
<span class="nv">$callTimeoutSec</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
<span class="nv">$entitlementPolicy</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
<span class="nv">$billingPolicy</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
<span class="nv">$useRequestedDateForBilling</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
<span class="nv">$pluginProperty</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">"pluginProperty_example"</span><span class="p">);</span>

<span class="nv">$apiInstance</span> <span class="o">-&gt;</span> <span class="nf">cancelSubscriptionPlan</span><span class="p">(</span><span class="nv">$subscriptionId</span><span class="p">,</span> <span class="nv">$xKillbillCreatedBy</span><span class="p">,</span> <span class="nv">$requestedDate</span><span class="p">,</span> <span class="nv">$callCompletion</span><span class="p">,</span> <span class="nv">$callTimeoutSec</span><span class="p">,</span> <span class="nv">$entitlementPolicy</span><span class="p">,</span> <span class="nv">$billingPolicy</span><span class="p">,</span> <span class="nv">$useRequestedDateForBilling</span><span class="p">,</span> <span class="nv">$pluginProperty</span><span class="p">,</span> <span class="nv">$xKillbillReason</span><span class="p">,</span> <span class="nv">$xKillbillComment</span><span class="p">);</span>
</code></pre></div>
<p><strong>Query Parameters</strong></p>

<table><thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Required</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><strong>requestedDate</strong></td>
<td>string</td>
<td>no</td>
<td>immediate</td>
<td>Date/DateTime at which this change should become effective in <code>yyyy-mm-dd</code>/<code>yyyy-mm-ddThh:mm</code>  format.</td>
</tr>
<tr>
<td><strong>entitlementPolicy</strong></td>
<td>string</td>
<td>no</td>
<td>IMMEDIATE</td>
<td>entitlement policy (see below)</td>
</tr>
<tr>
<td><strong>billingPolicy</strong></td>
<td>string</td>
<td>no</td>
<td>default policy from catalog if present, otherwise <code>END_OF_TERM</code></td>
<td>billing policy (see below)</td>
</tr>
<tr>
<td><strong>useRequestedDateForBilling</strong></td>
<td>boolean</td>
<td>no</td>
<td>false</td>
<td>use <strong>requestedDate</strong> for billing</td>
</tr>
<tr>
<td><strong>callCompletion</strong></td>
<td>boolean</td>
<td>no</td>
<td>false</td>
<td>see below</td>
</tr>
<tr>
<td><strong>callTimeoutSec</strong></td>
<td>long</td>
<td>no</td>
<td>unlimited?</td>
<td>Timeout in seconds (see below)</td>
</tr>
<tr>
<td><strong>pluginProperty</strong></td>
<td>array of strings</td>
<td>false</td>
<td>omit</td>
<td>list of plugin properties, if any</td>
</tr>
</tbody></table>

<p><strong>entitlementPolicy</strong>: Possible values are IMMEDIATE, END_OF_TERM</p>

<p><strong>billingPolicy</strong>: Possible values are START_OF_TERM, END_OF_TERM, or IMMEDIATE</p>

<p>Creating a subscription often triggers the creation of an invoice, and associated with this there is often a payment (against the invoice). If <strong>callCompletion</strong> is true, the call to this API will be delayed until the invoice is created and/or the payment is processed. However, the maximum delay in seconds will be given by <strong>callTimeoutSec</strong>.</p>

<p>Since we offer the ability to control the cancelation date for both entitlement (service) and billing either through policies, dates or null values (now), it is important to understand how those parameters work:</p>

<ul>
<li>If <code>entitlementPolicy</code> has been defined, the <code>requestedDate</code> is ignored, and we either default to the catalog defined <code>billingPolicy</code> for this <code>Plan</code>, or use the one provided in this API.</li>
<li>If not, the <code>requestedDate</code> is used to compute the entitlement cancelation date, and the null value means change should be immediate. The billing date will then be computed the following way:

<ul>
<li>If <code>billingPolicy</code> has been specified, it is used to compute the billing cancelation date</li>
<li>If <code>billingPolicy</code> has not been specified, we either use the <code>requestedDate</code> when <code>useRequestedDateForBilling</code> is true or default to the catalog defined <code>billingPolicy</code> for this <code>Plan</code></li>
</ul></li>
</ul>

<p>So, the common use case would require the following:</p>

<ul>
<li><strong>Immediate cancelation</strong>: This will create a prorated credit unless this aligns with the subscription charged through date (<code>CTD</code>), that is, the date up to which it was invoiced, and then from an entitlement point of view it will deactivate service immediately. In order to achieve this result, one can pass the following parameters: <code>entitlementPolicy</code>=<code>IMMEDIATE</code> and <code>billingPolicy</code>=<code>IMMEDIATE</code>; alternatively passing no parameters and therefore a null <code>requestedDate</code> would produce the same result.</li>
<li><strong>EOT cancelation</strong>: This will not create any proration and will keep the service active until the end of the period (<code>CTD</code>). In order to achieve this result, one can pass the following parameters: <code>entitlementPolicy</code>=<code>END_OF_TERM</code> and <code>billingPolicy</code>=<code>END_OF_TERM</code>.</li>
</ul>

<p>The reason for all this complexity is to allow to control entitlement and billing date separately, and also avoid users to have to compute dates to achieve certain behavior by relying on well defined policies.</p>

<p><strong>Other Notes:</strong>
* If a subscription is created with a future date and if the cancel method is invoked for immediate cancellation, the cancellation takes effect only after the subscription creation date is reached. Thus, the subscription remains in <code>PENDING</code> state until the subscription creation date is reached after which it is moved to the <code>CANCELLED</code> state.</p>

<p><strong>Returns</strong></p>

<p>If successful, returns a status code of 204 and an empty body.</p>
<h3 id='un-cancel-a-subscription'>Un-cancel a subscription</h3>
<p>This endpoint allows you to undo a pending cancellation (cancellation request with a future effective date) for a given subscription.</p>

<p><strong>HTTP Request</strong> </p>

<p><code>PUT http://127.0.0.1:8080/1.0/kb/subscriptions/{subscriptionId}/uncancel</code></p>

<blockquote>
<p>Example Request:</p>
</blockquote>
<div class="highlight"><pre class="highlight shell tab-shell"><code>curl <span class="se">\</span>
    <span class="nt">-X</span> PUT <span class="se">\</span>
    <span class="nt">-u</span> admin:password <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-ApiKey: bob"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-ApiSecret: lazar"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-CreatedBy: demo"</span> <span class="se">\</span>
    <span class="s1">'http://127.0.0.1:8080/1.0/kb/subscriptions/77e23878-8b9d-403b-bf31-93003e125712/uncancel'</span> 
</code></pre></div><div class="highlight"><pre class="highlight java tab-java"><code><span class="kn">import</span> <span class="nn">org.killbill.billing.client.api.gen.SubscriptionApi</span><span class="o">;</span>
<span class="kd">protected</span> <span class="nc">SubscriptionApi</span> <span class="n">subscriptionApi</span><span class="o">;</span>

<span class="no">UUID</span> <span class="n">subscriptionId</span> <span class="o">=</span> <span class="no">UUID</span><span class="o">.</span><span class="na">fromString</span><span class="o">(</span><span class="s">"1bb4b638-3886-4f73-90a5-89eb6d1bcf7f"</span><span class="o">);</span>
<span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">String</span><span class="o">&gt;</span> <span class="no">NULL_PLUGIN_PROPERTIES</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>

<span class="n">subscriptionApi</span><span class="o">.</span><span class="na">uncancelSubscriptionPlan</span><span class="o">(</span><span class="n">subscriptionId</span><span class="o">,</span> 
                                         <span class="no">NULL_PLUGIN_PROPERTIES</span><span class="o">,</span> 
                                         <span class="n">requestOptions</span><span class="o">);</span>
</code></pre></div><div class="highlight"><pre class="highlight ruby tab-ruby"><code><span class="n">user</span> <span class="o">=</span> <span class="s2">"demo"</span>
<span class="n">reason</span> <span class="o">=</span> <span class="kp">nil</span>
<span class="n">comment</span> <span class="o">=</span> <span class="kp">nil</span>

<span class="n">subscription</span> <span class="o">=</span> <span class="no">KillBillClient</span><span class="o">::</span><span class="no">Model</span><span class="o">::</span><span class="no">Subscription</span><span class="p">.</span><span class="nf">new</span>
<span class="n">subscription</span><span class="p">.</span><span class="nf">subscription_id</span> <span class="o">=</span> <span class="s2">"fbe97f23-30da-4f7e-9987-3280034c5258"</span>

<span class="n">subscription</span><span class="p">.</span><span class="nf">uncancel</span><span class="p">(</span><span class="n">user</span><span class="p">,</span> 
                      <span class="n">reason</span><span class="p">,</span> 
                      <span class="n">comment</span><span class="p">,</span> 
                      <span class="n">options</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="n">subscriptionApi</span> <span class="o">=</span> <span class="n">killbill</span><span class="p">.</span><span class="n">api</span><span class="p">.</span><span class="n">SubscriptionApi</span><span class="p">()</span>
<span class="n">subscription_id</span> <span class="o">=</span> <span class="s">'f5bb14ed-c6e8-4895-8d4e-34422e12cdfa'</span>

<span class="n">subscriptionApi</span><span class="p">.</span><span class="n">uncancel_subscription_plan</span><span class="p">(</span><span class="n">subscription_id</span><span class="p">,</span>
                                           <span class="n">created_by</span><span class="o">=</span><span class="s">'demo'</span><span class="p">,</span>
                                           <span class="n">reason</span><span class="o">=</span><span class="s">'reason'</span><span class="p">,</span>
                                           <span class="n">comment</span><span class="o">=</span><span class="s">'comment'</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">const</span> <span class="nx">api</span><span class="p">:</span> <span class="nx">killbill</span><span class="p">.</span><span class="nx">SubscriptionApi</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">killbill</span><span class="p">.</span><span class="nx">SubscriptionApi</span><span class="p">(</span><span class="nx">config</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">subscriptionId</span><span class="o">=</span> <span class="dl">'</span><span class="s1">1664777f-f194-48fd-a274-e883063790b1</span><span class="dl">'</span><span class="p">;</span>

<span class="nx">api</span><span class="p">.</span><span class="nx">uncancelSubscriptionPlan</span><span class="p">(</span><span class="nx">subscriptionId</span><span class="p">,</span> <span class="dl">'</span><span class="s1">created-by</span><span class="dl">'</span><span class="p">);</span>
</code></pre></div><div class="highlight"><pre class="highlight php tab-php"><code><span class="nv">$apiInstance</span> <span class="o">=</span> <span class="nv">$client</span><span class="o">-&gt;</span><span class="nf">getSubscriptionApi</span><span class="p">();</span>

<span class="nv">$xKillbillCreatedBy</span> <span class="o">=</span> <span class="s2">"user"</span><span class="p">;</span>
<span class="nv">$xKillbillReason</span> <span class="o">=</span> <span class="s2">"reason"</span><span class="p">;</span>
<span class="nv">$xKillbillComment</span> <span class="o">=</span> <span class="s2">"comment"</span><span class="p">;</span>

<span class="nv">$subscriptionId</span> <span class="o">=</span> <span class="s2">"5499095e-36c3-4eff-9feb-7bbbabdde9df"</span><span class="p">;</span>
<span class="nv">$pluginProperty</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">"pluginProperty_example"</span><span class="p">);</span>

<span class="nv">$apiInstance</span> <span class="o">-&gt;</span> <span class="nf">uncancelSubscriptionPlan</span><span class="p">(</span><span class="nv">$subscriptionId</span><span class="p">,</span> <span class="nv">$xKillbillCreatedBy</span><span class="p">,</span> <span class="nv">$pluginProperty</span><span class="p">,</span> <span class="nv">$xKillbillReason</span><span class="p">,</span> <span class="nv">$xKillbillComment</span><span class="p">);</span>
</code></pre></div>
<p><strong>Query Parameters</strong></p>

<table><thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Required</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><strong>pluginProperty</strong></td>
<td>array of strings</td>
<td>false</td>
<td>omit</td>
<td>list of plugin properties, if any</td>
</tr>
</tbody></table>

<p><strong>Returns</strong></p>

<p>If successful, returns a status code of 204 and an empty body.</p>
<h2 id='blocking-state'>Blocking State</h2>
<p>See section <a href="account.html#account-blocking-state">Account Blocking State</a> for an introduction to blocking states.</p>
<h3 id='block-a-subscription'>Block a subscription</h3>
<p>Provides a low level interface to add a <code>BlockingState</code> event for this subscription. </p>

<p><strong>HTTP Request</strong> </p>

<p><code>POST http://127.0.0.1:8080/1.0/kb/subscriptions/{subscriptionId}/block</code></p>

<blockquote>
<p>Example Request:</p>
</blockquote>
<div class="highlight"><pre class="highlight shell tab-shell"><code>curl <span class="nt">-v</span> <span class="se">\</span>
    <span class="nt">-X</span> POST <span class="se">\</span>
    <span class="nt">-u</span> admin:password <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-ApiKey: bob"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-ApiSecret: lazar"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-CreatedBy: demo"</span> <span class="se">\</span>
    <span class="nt">-d</span> <span class="s1">'{ 
            "stateName": "STATE",
            "service": "ServiceStateService",
            "isBlockChange": false,
            "isBlockEntitlement": false,
            "isBlockBilling": false
    }'</span> <span class="se">\</span>
    <span class="s1">'http://127.0.0.1:8080/1.0/kb/subscriptions/77e23878-8b9d-403b-bf31-93003e125712/block'</span> 
</code></pre></div><div class="highlight"><pre class="highlight java tab-java"><code><span class="kn">import</span> <span class="nn">org.killbill.billing.client.api.gen.SubscriptionApi</span><span class="o">;</span>
<span class="kd">protected</span> <span class="nc">SubscriptionApi</span> <span class="n">subscriptionApi</span><span class="o">;</span>

<span class="no">UUID</span> <span class="n">subscriptionId</span> <span class="o">=</span> <span class="no">UUID</span><span class="o">.</span><span class="na">fromString</span><span class="o">(</span><span class="s">"161692a4-c293-410c-a92f-939c5e3dcba7"</span><span class="o">);</span>

<span class="nc">BlockingState</span> <span class="n">blockingState</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">BlockingState</span><span class="o">();</span>
<span class="n">blockingState</span><span class="o">.</span><span class="na">setStateName</span><span class="o">(</span><span class="s">"STATE1"</span><span class="o">);</span>
<span class="n">blockingState</span><span class="o">.</span><span class="na">setService</span><span class="o">(</span><span class="s">"ServiceStateService"</span><span class="o">);</span>
<span class="n">blockingState</span><span class="o">.</span><span class="na">setIsBlockChange</span><span class="o">(</span><span class="kc">false</span><span class="o">);</span>
<span class="n">blockingState</span><span class="o">.</span><span class="na">setIsBlockBilling</span><span class="o">(</span><span class="kc">false</span><span class="o">);</span>
<span class="n">blockingState</span><span class="o">.</span><span class="na">setIsBlockEntitlement</span><span class="o">(</span><span class="kc">false</span><span class="o">);</span>

<span class="nc">LocalDate</span> <span class="n">requestedDate</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">LocalDate</span><span class="o">(</span><span class="s">"2013-08-01"</span><span class="o">);</span>
<span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">String</span><span class="o">&gt;</span> <span class="n">pluginProperty</span> <span class="o">=</span> <span class="nc">Collections</span><span class="o">.</span><span class="na">emptyMap</span><span class="o">();</span>

<span class="nc">BlockingStates</span> <span class="n">result</span> <span class="o">=</span> <span class="n">subscriptionApi</span><span class="o">.</span><span class="na">addSubscriptionBlockingState</span><span class="o">(</span><span class="n">subscriptionId</span><span class="o">,</span>
                                                                     <span class="n">blockingState</span><span class="o">,</span>
                                                                     <span class="n">requestedDate</span><span class="o">,</span>
                                                                     <span class="n">pluginProperty</span><span class="o">,</span>
                                                                     <span class="n">requestOptions</span><span class="o">);</span>
</code></pre></div><div class="highlight"><pre class="highlight ruby tab-ruby"><code><span class="n">user</span> <span class="o">=</span> <span class="s2">"demo"</span>
<span class="n">reason</span> <span class="o">=</span> <span class="kp">nil</span>
<span class="n">comment</span> <span class="o">=</span> <span class="kp">nil</span>

<span class="n">subscription</span> <span class="o">=</span> <span class="no">KillBillClient</span><span class="o">::</span><span class="no">Model</span><span class="o">::</span><span class="no">Subscription</span><span class="p">.</span><span class="nf">new</span>
<span class="n">subscription</span><span class="p">.</span><span class="nf">subscription_id</span> <span class="o">=</span> <span class="s2">"161692a4-c293-410c-a92f-939c5e3dcba7"</span>

<span class="n">state_name</span> <span class="o">=</span> <span class="s1">'STATE1'</span>
<span class="n">service</span> <span class="o">=</span> <span class="s1">'ServiceStateService'</span>
<span class="n">block_change</span> <span class="o">=</span> <span class="kp">false</span>
<span class="n">block_entitlement</span> <span class="o">=</span> <span class="kp">false</span>
<span class="n">block_billing</span> <span class="o">=</span> <span class="kp">false</span>
<span class="n">requested_date</span> <span class="o">=</span> <span class="kp">nil</span>

<span class="n">subscription</span><span class="p">.</span><span class="nf">set_blocking_state</span><span class="p">(</span><span class="n">state_name</span><span class="p">,</span> 
                                <span class="n">service</span><span class="p">,</span> 
                                <span class="n">block_change</span><span class="p">,</span> 
                                <span class="n">block_entitlement</span><span class="p">,</span> 
                                <span class="n">block_billing</span><span class="p">,</span> 
                                <span class="n">requested_date</span><span class="p">,</span> 
                                <span class="n">user</span><span class="p">,</span> 
                                <span class="n">reason</span><span class="p">,</span>
                                <span class="n">comment</span><span class="p">,</span> 
                                <span class="n">options</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="n">subscriptionApi</span> <span class="o">=</span> <span class="n">killbill</span><span class="p">.</span><span class="n">api</span><span class="p">.</span><span class="n">SubscriptionApi</span><span class="p">()</span>
<span class="n">body</span> <span class="o">=</span> <span class="n">BlockingState</span><span class="p">(</span><span class="n">state_name</span><span class="o">=</span><span class="s">'STATE1'</span><span class="p">,</span>
                     <span class="n">service</span><span class="o">=</span><span class="s">'ServiceStateService'</span><span class="p">,</span>
                     <span class="n">is_block_change</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                     <span class="n">is_block_entitlement</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                     <span class="n">is_block_billing</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="n">subscription_id</span> <span class="o">=</span> <span class="s">'33aa2952-cea2-4cad-900a-9731c1042e54'</span>

<span class="n">subscriptionApi</span><span class="p">.</span><span class="n">add_subscription_blocking_state</span><span class="p">(</span><span class="n">subscription_id</span><span class="p">,</span>
                                                <span class="n">body</span><span class="p">,</span>
                                                <span class="n">created_by</span><span class="o">=</span><span class="s">'demo'</span><span class="p">,</span>
                                                <span class="n">reason</span><span class="o">=</span><span class="s">'reason'</span><span class="p">,</span>
                                                <span class="n">comment</span><span class="o">=</span><span class="s">'comment'</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">const</span> <span class="nx">api</span><span class="p">:</span> <span class="nx">killbill</span><span class="p">.</span><span class="nx">SubscriptionApi</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">killbill</span><span class="p">.</span><span class="nx">SubscriptionApi</span><span class="p">(</span><span class="nx">config</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">blockingState</span><span class="p">:</span> <span class="nx">BlockingState</span> <span class="o">=</span> <span class="p">{</span><span class="na">stateName</span><span class="p">:</span> <span class="dl">"</span><span class="s2">STATE1</span><span class="dl">"</span><span class="p">,</span> <span class="na">service</span><span class="p">:</span> <span class="dl">"</span><span class="s2">ServiceStateService</span><span class="dl">"</span><span class="p">,</span> <span class="na">isBlockChange</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span> <span class="na">isBlockEntitlement</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span> <span class="na">isBlockBilling</span><span class="p">:</span> <span class="kc">false</span><span class="p">};</span>
<span class="kd">const</span> <span class="nx">subscriptionId</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">b6000207-42fd-40ea-9c8e-297d9adc1574</span><span class="dl">'</span><span class="p">;</span>

<span class="nx">api</span><span class="p">.</span><span class="nx">addSubscriptionBlockingState</span><span class="p">(</span><span class="nx">blockingState</span><span class="p">,</span> <span class="nx">subscriptionId</span><span class="p">,</span> <span class="dl">'</span><span class="s1">created_by</span><span class="dl">'</span><span class="p">);</span>
</code></pre></div><div class="highlight"><pre class="highlight php tab-php"><code><span class="nv">$apiInstance</span> <span class="o">=</span> <span class="nv">$client</span><span class="o">-&gt;</span><span class="nf">getSubscriptionApi</span><span class="p">();</span>

<span class="nv">$xKillbillCreatedBy</span> <span class="o">=</span> <span class="s2">"user"</span><span class="p">;</span>
<span class="nv">$xKillbillReason</span> <span class="o">=</span> <span class="s2">"reason"</span><span class="p">;</span>
<span class="nv">$xKillbillComment</span> <span class="o">=</span> <span class="s2">"comment"</span><span class="p">;</span>

<span class="nv">$blockingState</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">BlockingState</span><span class="p">();</span>
<span class="nv">$blockingState</span> <span class="o">-&gt;</span> <span class="nf">setStateName</span><span class="p">(</span><span class="s1">'STATE1'</span><span class="p">);</span>
<span class="nv">$blockingState</span> <span class="o">-&gt;</span> <span class="nf">setService</span><span class="p">(</span><span class="s1">'ServiceStateService1'</span><span class="p">);</span>
<span class="nv">$blockingState</span> <span class="o">-&gt;</span> <span class="nf">setIsBlockChange</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
<span class="nv">$blockingState</span> <span class="o">-&gt;</span> <span class="nf">setIsBlockBilling</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
<span class="nv">$blockingState</span> <span class="o">-&gt;</span> <span class="nf">setIsBlockEntitlement</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>

<span class="nv">$subscriptionId</span> <span class="o">=</span> <span class="s2">"3f4a2efd-a8c1-4f85-9266-32bd6f7113ba"</span><span class="p">;</span>
<span class="nv">$requestedDate</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">DateTime</span><span class="p">(</span><span class="s2">"2023-10-20"</span><span class="p">);</span>
<span class="nv">$pluginProperty</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">"pluginProperty_example"</span><span class="p">);</span>

<span class="nv">$result</span> <span class="o">=</span> <span class="nv">$apiInstance</span><span class="o">-&gt;</span><span class="nf">addSubscriptionBlockingState</span><span class="p">(</span><span class="nv">$blockingState</span><span class="p">,</span> <span class="nv">$xKillbillCreatedBy</span><span class="p">,</span> <span class="nv">$subscriptionId</span><span class="p">,</span> <span class="nv">$xKillbillReason</span><span class="p">,</span> <span class="nv">$xKillbillComment</span><span class="p">,</span> <span class="nv">$requestedDate</span><span class="p">,</span> <span class="nv">$pluginProperty</span><span class="p">);</span>
</code></pre></div>
<p><strong>Request Body</strong></p>

<p>A <a href="account-blocking-state-resource">blocking state resource</a> representing the intended new blocking state.</p>
<div class="highlight"><pre class="highlight plaintext"><code>{
  "blockedId": "943c4fd0-9000-4975-a3a8-09712223e1f8",
  "stateName": "STATE1",
  "service": "ServiceStateService",
  "isBlockChange": false,
  "isBlockEntitlement": false,
  "isBlockBilling": true,
  "effectiveDate": "2020-07-18T18:22:30.376Z",
  "type": "SUBSCRIPTION"
}
</code></pre></div>
<p><strong>Query Parameters</strong></p>

<table><thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Required</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><strong>requestedDate</strong></td>
<td>string</td>
<td>no</td>
<td>immediate</td>
<td>Date/DateTime to begin blocking in <code>yyyy-mm-dd</code>/<code>yyyy-mm-ddThh:mm</code> format.</td>
</tr>
</tbody></table>

<p><strong>Response</strong></p>

<p>If successful, returns a status code of 201 and an empty body. In addition, a <code>Location</code> header is returned which contains the URL to retrieve the subscription blocking states for the account.</p>
<h2 id='custom-fields'>Custom Fields</h2>
<p><code>Custom fields</code> are <code>{key, value}</code> attributes that can be attached to any customer resources. For more on custom fields see <a href="custom-field.html">Custom Fields</a>. These endpoints manage custom fields associated with <code>Subscription</code> objects.</p>
<h3 id='add-custom-fields-to-subscription'>Add custom fields to subscription</h3>
<p>Adds one or more custom fields to a subscription object. Existing custom fields are not disturbed.</p>

<p><strong>HTTP Request</strong> </p>

<p><code>POST http://127.0.0.1:8080/1.0/kb/subscriptions/{subscriptionId}/customFields</code></p>

<blockquote>
<p>Example Request:</p>
</blockquote>
<div class="highlight"><pre class="highlight shell tab-shell"><code>curl <span class="nt">-v</span> <span class="se">\</span>
    <span class="nt">-X</span> POST <span class="se">\</span>
    <span class="nt">-u</span> admin:password <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-ApiKey: bob"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-ApiSecret: lazar"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-CreatedBy: demo"</span> <span class="se">\</span>
    <span class="nt">-d</span> <span class="s1">'[{ 
            "name": "Test Custom Field",
            "value": "test_value"
    }]'</span> <span class="se">\</span>
    <span class="s1">'http://127.0.0.1:8080/1.0/kb/subscriptions/77e23878-8b9d-403b-bf31-93003e125712/customFields'</span> 
</code></pre></div><div class="highlight"><pre class="highlight java tab-java"><code><span class="kn">import</span> <span class="nn">org.killbill.billing.client.api.gen.SubscriptionApi</span><span class="o">;</span>
<span class="kd">protected</span> <span class="nc">SubscriptionApi</span> <span class="n">subscriptionApi</span><span class="o">;</span>

<span class="no">UUID</span> <span class="n">subscriptionId</span> <span class="o">=</span> <span class="no">UUID</span><span class="o">.</span><span class="na">fromString</span><span class="o">(</span><span class="s">"cca08349-8b26-41c7-bfcc-2e3cf70a0f28"</span><span class="o">);</span>

<span class="kd">final</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">AuditLog</span><span class="o">&gt;</span> <span class="no">EMPTY_AUDIT_LOGS</span> <span class="o">=</span> <span class="nc">Collections</span><span class="o">.</span><span class="na">emptyList</span><span class="o">();</span>

<span class="nc">CustomFields</span> <span class="n">customFields</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CustomFields</span><span class="o">();</span>
<span class="n">customFields</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="nc">CustomField</span><span class="o">(</span><span class="kc">null</span><span class="o">,</span> 
                                 <span class="n">subscriptionId</span><span class="o">,</span> 
                                 <span class="nc">ObjectType</span><span class="o">.</span><span class="na">SUBSCRIPTION</span><span class="o">,</span> 
                                 <span class="s">"Test Custom Field"</span><span class="o">,</span> 
                                 <span class="s">"test_value"</span><span class="o">,</span> 
                                 <span class="no">EMPTY_AUDIT_LOGS</span><span class="o">));</span>

<span class="n">subscriptionApi</span><span class="o">.</span><span class="na">createSubscriptionCustomFields</span><span class="o">(</span><span class="n">subscriptionId</span><span class="o">,</span> 
                                               <span class="n">customFields</span><span class="o">,</span> 
                                               <span class="n">requestOptions</span><span class="o">);</span>
</code></pre></div><div class="highlight"><pre class="highlight ruby tab-ruby"><code><span class="n">user</span> <span class="o">=</span> <span class="s2">"demo"</span>
<span class="n">reason</span> <span class="o">=</span> <span class="kp">nil</span>
<span class="n">comment</span> <span class="o">=</span> <span class="kp">nil</span>

<span class="n">subscription</span> <span class="o">=</span> <span class="no">KillBillClient</span><span class="o">::</span><span class="no">Model</span><span class="o">::</span><span class="no">Subscription</span><span class="p">.</span><span class="nf">new</span>
<span class="n">subscription</span><span class="p">.</span><span class="nf">subscription_id</span> <span class="o">=</span> <span class="s2">"2207150d-0652-43eb-abbe-2cbd0092b744"</span>

<span class="n">custom_field</span> <span class="o">=</span> <span class="no">KillBillClient</span><span class="o">::</span><span class="no">Model</span><span class="o">::</span><span class="no">CustomFieldAttributes</span><span class="p">.</span><span class="nf">new</span>
<span class="n">custom_field</span><span class="p">.</span><span class="nf">name</span> <span class="o">=</span> <span class="s1">'Test Custom Field'</span>
<span class="n">custom_field</span><span class="p">.</span><span class="nf">value</span> <span class="o">=</span> <span class="s1">'test_value'</span>

<span class="n">subscription</span><span class="p">.</span><span class="nf">add_custom_field</span><span class="p">(</span><span class="n">custom_field</span><span class="p">,</span>
                              <span class="n">user</span><span class="p">,</span>
                              <span class="n">reason</span><span class="p">,</span>
                              <span class="n">comment</span><span class="p">,</span>
                              <span class="n">options</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="n">subscriptionApi</span> <span class="o">=</span> <span class="n">killbill</span><span class="p">.</span><span class="n">api</span><span class="p">.</span><span class="n">SubscriptionApi</span><span class="p">()</span>
<span class="n">subscription_id</span> <span class="o">=</span> <span class="s">'33aa2952-cea2-4cad-900a-9731c1042e54'</span>
<span class="n">body</span> <span class="o">=</span> <span class="n">CustomField</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">'Test Custom Field'</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s">'test_value'</span><span class="p">)</span>

<span class="n">subscriptionApi</span><span class="p">.</span><span class="n">create_subscription_custom_fields</span><span class="p">(</span><span class="n">subscription_id</span><span class="p">,</span>
                                                  <span class="p">[</span><span class="n">body</span><span class="p">],</span>
                                                  <span class="n">created_by</span><span class="o">=</span><span class="s">'demo'</span><span class="p">,</span>
                                                  <span class="n">reason</span><span class="o">=</span><span class="s">'reason'</span><span class="p">,</span>
                                                  <span class="n">comment</span><span class="o">=</span><span class="s">'comment'</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">const</span> <span class="nx">api</span><span class="p">:</span> <span class="nx">killbill</span><span class="p">.</span><span class="nx">SubscriptionApi</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">killbill</span><span class="p">.</span><span class="nx">SubscriptionApi</span><span class="p">(</span><span class="nx">config</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">subscriptionId</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">b6000207-42fd-40ea-9c8e-297d9adc1574</span><span class="dl">'</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">customField</span><span class="p">:</span> <span class="nx">CustomField</span> <span class="o">=</span> <span class="p">{</span><span class="na">name</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Test Custom Field</span><span class="dl">"</span><span class="p">,</span> <span class="na">value</span><span class="p">:</span> <span class="dl">"</span><span class="s2">test_value</span><span class="dl">"</span><span class="p">};</span>
<span class="kd">const</span> <span class="nx">customFields</span> <span class="o">=</span> <span class="p">[</span><span class="nx">customField</span><span class="p">];</span>

<span class="nx">api</span><span class="p">.</span><span class="nx">createSubscriptionCustomFields</span><span class="p">(</span><span class="nx">customFields</span><span class="p">,</span> <span class="nx">subscriptionId</span><span class="p">,</span> <span class="dl">'</span><span class="s1">created_by</span><span class="dl">'</span><span class="p">);</span>
</code></pre></div><div class="highlight"><pre class="highlight php tab-php"><code><span class="nv">$apiInstance</span> <span class="o">=</span> <span class="nv">$client</span><span class="o">-&gt;</span><span class="nf">getSubscriptionApi</span><span class="p">();</span>

<span class="nv">$xKillbillCreatedBy</span> <span class="o">=</span> <span class="s2">"user"</span><span class="p">;</span>
<span class="nv">$xKillbillReason</span> <span class="o">=</span> <span class="s2">"reason"</span><span class="p">;</span>
<span class="nv">$xKillbillComment</span> <span class="o">=</span> <span class="s2">"comment"</span><span class="p">;</span>

<span class="nv">$subscriptionId</span> <span class="o">=</span> <span class="s2">"3f4a2efd-a8c1-4f85-9266-32bd6f7113ba"</span><span class="p">;</span>

<span class="nv">$customField</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CustomField</span><span class="p">();</span>
<span class="nv">$customField</span> <span class="o">-&gt;</span> <span class="nf">setName</span><span class="p">(</span><span class="s1">'Test Custom Field'</span><span class="p">);</span>
<span class="nv">$customField</span> <span class="o">-&gt;</span> <span class="nf">setValue</span><span class="p">(</span><span class="s1">'test_value'</span><span class="p">);</span>
<span class="nv">$body</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="nv">$customField</span><span class="p">);</span>

<span class="nv">$apiInstance</span><span class="o">-&gt;</span><span class="nf">createSubscriptionCustomFields</span><span class="p">(</span><span class="nv">$body</span><span class="p">,</span> <span class="nv">$xKillbillCreatedBy</span><span class="p">,</span> <span class="nv">$subscriptionId</span><span class="p">,</span> <span class="nv">$xKillbillReason</span><span class="p">,</span> <span class="nv">$xKillbillComment</span><span class="p">);</span>
</code></pre></div>
<p><strong>Request Body</strong></p>

<p>A list of objects giving the name and value of the custom field, or fields, to be added. For example:</p>

<p>[
      {
        &quot;name&quot;: &quot;CF1&quot;,
        &quot;value&quot;: &quot;123&quot;
      }
    ]</p>

<p><strong>Query Parameters</strong></p>

<p>None.</p>

<p><strong>Response</strong></p>

<p>If successful, returns a 201 status code.In addition, a Location header is returned giving the URL to retrieve the custom fields associated with the subscription.</p>
<h3 id='retrieve-subscription-custom-fields'>Retrieve subscription custom fields</h3>
<p>Returns any custom field objects associated with the specified subscription</p>

<p><strong>HTTP Request</strong> </p>

<p><code>GET http://127.0.0.1:8080/1.0/kb/subscriptions/{subscriptionId}/customFields</code></p>

<blockquote>
<p>Example Request:</p>
</blockquote>
<div class="highlight"><pre class="highlight shell tab-shell"><code>curl <span class="se">\</span>
    <span class="nt">-u</span> admin:password <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-ApiKey: bob"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-ApiSecret: lazar"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"Accept: application/json"</span> <span class="se">\</span>
    <span class="s1">'http://127.0.0.1:8080/1.0/kb/subscriptions/77e23878-8b9d-403b-bf31-93003e125712/customFields'</span> 
</code></pre></div><div class="highlight"><pre class="highlight java tab-java"><code><span class="kn">import</span> <span class="nn">org.killbill.billing.client.api.gen.SubscriptionApi</span><span class="o">;</span>
<span class="kd">protected</span> <span class="nc">SubscriptionApi</span> <span class="n">subscriptionApi</span><span class="o">;</span>

<span class="no">UUID</span> <span class="n">subscriptionId</span> <span class="o">=</span> <span class="no">UUID</span><span class="o">.</span><span class="na">fromString</span><span class="o">(</span><span class="s">"cca08349-8b26-41c7-bfcc-2e3cf70a0f28"</span><span class="o">);</span>

<span class="nc">List</span><span class="o">&lt;</span><span class="nc">CustomField</span><span class="o">&gt;</span> <span class="n">customFields</span> <span class="o">=</span> <span class="n">subscriptionApi</span><span class="o">.</span><span class="na">getSubscriptionCustomFields</span><span class="o">(</span><span class="n">subscriptionId</span><span class="o">,</span>
                                                                             <span class="nc">AuditLevel</span><span class="o">.</span><span class="na">NONE</span><span class="o">,</span>
                                                                             <span class="n">requestOptions</span><span class="o">);</span>
</code></pre></div><div class="highlight"><pre class="highlight ruby tab-ruby"><code><span class="n">subscription</span> <span class="o">=</span> <span class="no">KillBillClient</span><span class="o">::</span><span class="no">Model</span><span class="o">::</span><span class="no">Subscription</span><span class="p">.</span><span class="nf">new</span>
<span class="n">subscription</span><span class="p">.</span><span class="nf">subscription_id</span> <span class="o">=</span> <span class="s2">"2207150d-0652-43eb-abbe-2cbd0092b744"</span>

<span class="n">audit</span> <span class="o">=</span> <span class="s1">'NONE'</span>
<span class="n">fields</span> <span class="o">=</span> <span class="n">subscription</span><span class="p">.</span><span class="nf">custom_fields</span><span class="p">(</span><span class="n">audit</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="n">subscriptionApi</span> <span class="o">=</span> <span class="n">killbill</span><span class="p">.</span><span class="n">api</span><span class="p">.</span><span class="n">SubscriptionApi</span><span class="p">()</span>
<span class="n">subscription_id</span> <span class="o">=</span> <span class="s">'33aa2952-cea2-4cad-900a-9731c1042e54'</span>

<span class="n">fields</span> <span class="o">=</span> <span class="n">subscriptionApi</span><span class="p">.</span><span class="n">get_subscription_custom_fields</span><span class="p">(</span><span class="n">subscription_id</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">const</span> <span class="nx">api</span><span class="p">:</span> <span class="nx">killbill</span><span class="p">.</span><span class="nx">SubscriptionApi</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">killbill</span><span class="p">.</span><span class="nx">SubscriptionApi</span><span class="p">(</span><span class="nx">config</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">subscriptionId</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">e5254822-680f-4720-b5e1-a7146cefb904</span><span class="dl">'</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">audit</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">NONE</span><span class="dl">'</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">response</span><span class="p">:</span> <span class="nx">AxiosResponse</span><span class="o">&lt;</span><span class="nx">killbill</span><span class="p">.</span><span class="nx">CustomField</span><span class="p">[],</span> <span class="nx">any</span><span class="o">&gt;</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">api</span><span class="p">.</span><span class="nx">getSubscriptionCustomFields</span><span class="p">(</span><span class="nx">subscriptionId</span><span class="p">,</span> <span class="nx">audit</span><span class="p">,</span> <span class="dl">'</span><span class="s1">created_by</span><span class="dl">'</span><span class="p">);</span>
</code></pre></div><div class="highlight"><pre class="highlight php tab-php"><code><span class="nv">$apiInstance</span> <span class="o">=</span> <span class="nv">$client</span><span class="o">-&gt;</span><span class="nf">getSubscriptionApi</span><span class="p">();</span>

<span class="nv">$subscriptionId</span> <span class="o">=</span> <span class="s2">"3f4a2efd-a8c1-4f85-9266-32bd6f7113ba"</span><span class="p">;</span>
<span class="nv">$audit</span> <span class="o">=</span> <span class="s2">"NONE"</span><span class="p">;</span>

<span class="nv">$result</span> <span class="o">=</span> <span class="nv">$apiInstance</span><span class="o">-&gt;</span><span class="nf">getSubscriptionCustomFields</span><span class="p">(</span><span class="nv">$subscriptionId</span><span class="p">,</span> <span class="nv">$audit</span><span class="p">);</span>
</code></pre></div>
<blockquote>
<p>Example Response:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="nl">"customFieldId"</span><span class="p">:</span><span class="s2">"439ed0f8-9b37-4688-bace-e2595b1d3801"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"objectId"</span><span class="p">:</span><span class="s2">"77e23878-8b9d-403b-bf31-93003e125712"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"objectType"</span><span class="p">:</span><span class="s2">"SUBSCRIPTION"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"name"</span><span class="p">:</span><span class="s2">"Test Custom Field"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"value"</span><span class="p">:</span><span class="s2">"test_value"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"auditLogs"</span><span class="p">:[]</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre></div>
<p><strong>Query Parameters</strong></p>

<table><thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Required</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><strong>audit</strong></td>
<td>string</td>
<td>no</td>
<td>&quot;NONE&quot;</td>
<td>Level of audit information to return:&quot;NONE&quot;, &quot;MINIMAL&quot;, or &quot;FULL&quot;</td>
</tr>
</tbody></table>

<p><strong>Response</strong></p>

<p>If successful, returns a status code of 200 and a (possibly empty) list of custom field objects.</p>
<h3 id='modify-custom-fields-for-a-subscription'>Modify custom fields for a subscription</h3>
<p>Modifies the value of one or more existing custom fields associated with a subscription. Note that it is not possible to modify the name of a custom field, it is only possible to modify its value.</p>

<p><strong>HTTP Request</strong> </p>

<p><code>PUT http://127.0.0.1:8080/1.0/kb/subscriptions/{subscriptionId}/customFields</code></p>

<blockquote>
<p>Example Request:</p>
</blockquote>
<div class="highlight"><pre class="highlight shell tab-shell"><code>curl <span class="nt">-v</span> <span class="se">\</span>
    <span class="nt">-X</span> PUT <span class="se">\</span>
    <span class="nt">-u</span> admin:password <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-ApiKey: bob"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-ApiSecret: lazar"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-CreatedBy: demo"</span> <span class="se">\</span>
    <span class="nt">-d</span> <span class="s1">'[{ 
            "customFieldId": "439ed0f8-9b37-4688-bace-e2595b1d3801",
            "value": "NewValue"
    }]'</span> <span class="se">\</span>
    <span class="s1">'http://127.0.0.1:8080/1.0/kb/subscriptions/77e23878-8b9d-403b-bf31-93003e125712/customFields'</span> 
</code></pre></div><div class="highlight"><pre class="highlight java tab-java"><code><span class="kn">import</span> <span class="nn">org.killbill.billing.client.api.gen.SubscriptionApi</span><span class="o">;</span>
<span class="kd">protected</span> <span class="nc">SubscriptionApi</span> <span class="n">subscriptionApi</span><span class="o">;</span>

<span class="no">UUID</span> <span class="n">subscriptionId</span> <span class="o">=</span> <span class="no">UUID</span><span class="o">.</span><span class="na">fromString</span><span class="o">(</span><span class="s">"cca08349-8b26-41c7-bfcc-2e3cf70a0f28"</span><span class="o">);</span>
<span class="no">UUID</span> <span class="n">customFieldId</span> <span class="o">=</span> <span class="no">UUID</span><span class="o">.</span><span class="na">fromString</span><span class="o">(</span><span class="s">"9913e0f6-b5ef-498b-ac47-60e1626eba8f"</span><span class="o">);</span>

<span class="nc">CustomField</span> <span class="n">customFieldModified</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CustomField</span><span class="o">();</span>
<span class="n">customFieldModified</span><span class="o">.</span><span class="na">setCustomFieldId</span><span class="o">(</span><span class="n">customFieldId</span><span class="o">);</span>
<span class="n">customFieldModified</span><span class="o">.</span><span class="na">setValue</span><span class="o">(</span><span class="s">"NewValue"</span><span class="o">);</span>
<span class="nc">CustomFields</span> <span class="n">customFields</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CustomFields</span><span class="o">();</span>
<span class="n">customFields</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">customFieldModified</span><span class="o">);</span>

<span class="n">subscriptionApi</span><span class="o">.</span><span class="na">modifySubscriptionCustomFields</span><span class="o">(</span><span class="n">subscriptionId</span><span class="o">,</span> 
                                               <span class="n">customFields</span><span class="o">,</span> 
                                               <span class="n">requestOptions</span><span class="o">);</span>
</code></pre></div><div class="highlight"><pre class="highlight ruby tab-ruby"><code><span class="n">user</span> <span class="o">=</span> <span class="s2">"demo"</span>
<span class="n">reason</span> <span class="o">=</span> <span class="kp">nil</span>
<span class="n">comment</span> <span class="o">=</span> <span class="kp">nil</span>

<span class="n">subscription</span> <span class="o">=</span> <span class="no">KillBillClient</span><span class="o">::</span><span class="no">Model</span><span class="o">::</span><span class="no">Subscription</span><span class="p">.</span><span class="nf">new</span>
<span class="n">subscription</span><span class="p">.</span><span class="nf">subscription_id</span> <span class="o">=</span> <span class="s2">"2207150d-0652-43eb-abbe-2cbd0092b744"</span>

<span class="n">custom_field</span> <span class="o">=</span> <span class="no">KillBillClient</span><span class="o">::</span><span class="no">Model</span><span class="o">::</span><span class="no">CustomFieldAttributes</span><span class="p">.</span><span class="nf">new</span>
<span class="n">custom_field</span><span class="p">.</span><span class="nf">custom_field_id</span> <span class="o">=</span> <span class="s1">'a04adaca-78a4-41fe-b512-a8d620aad456'</span>
<span class="n">custom_field</span><span class="p">.</span><span class="nf">value</span> <span class="o">=</span> <span class="s1">'test_modify_value'</span>

<span class="n">subscription</span><span class="p">.</span><span class="nf">modify_custom_field</span><span class="p">(</span><span class="n">custom_field</span><span class="p">,</span>
                                 <span class="n">user</span><span class="p">,</span>
                                 <span class="n">reason</span><span class="p">,</span>
                                 <span class="n">comment</span><span class="p">,</span>
                                 <span class="n">options</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="n">subscriptionApi</span> <span class="o">=</span> <span class="n">killbill</span><span class="p">.</span><span class="n">api</span><span class="p">.</span><span class="n">SubscriptionApi</span><span class="p">()</span>
<span class="n">subscription_id</span> <span class="o">=</span> <span class="s">'33aa2952-cea2-4cad-900a-9731c1042e54'</span>
<span class="n">custom_field_id</span> <span class="o">=</span> <span class="s">'3a26be42-a153-4894-ac3d-93ad2e38e05b'</span>
<span class="n">body</span> <span class="o">=</span> <span class="n">CustomField</span><span class="p">(</span><span class="n">custom_field_id</span><span class="o">=</span><span class="n">custom_field_id</span><span class="p">,</span>
                   <span class="n">value</span><span class="o">=</span><span class="s">'modified_value'</span><span class="p">)</span>

<span class="n">subscriptionApi</span><span class="p">.</span><span class="n">modify_subscription_custom_fields</span><span class="p">(</span><span class="n">subscription_id</span><span class="p">,</span>
                                                  <span class="p">[</span><span class="n">body</span><span class="p">],</span>
                                                  <span class="n">created_by</span><span class="o">=</span><span class="s">'demo'</span><span class="p">,</span>
                                                  <span class="n">reason</span><span class="o">=</span><span class="s">'reason'</span><span class="p">,</span>
                                                  <span class="n">comment</span><span class="o">=</span><span class="s">'comment'</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">const</span> <span class="nx">api</span><span class="p">:</span> <span class="nx">killbill</span><span class="p">.</span><span class="nx">SubscriptionApi</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">killbill</span><span class="p">.</span><span class="nx">SubscriptionApi</span><span class="p">(</span><span class="nx">config</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">subscriptionId</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">b6000207-42fd-40ea-9c8e-297d9adc1574</span><span class="dl">'</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">customField</span><span class="p">:</span> <span class="nx">CustomField</span> <span class="o">=</span> <span class="p">{</span><span class="na">customFieldId</span><span class="p">:</span> <span class="dl">"</span><span class="s2">d8f2e80d-9fd8-48e7-b564-a541a0a7621d</span><span class="dl">"</span><span class="p">,</span> <span class="na">value</span><span class="p">:</span> <span class="dl">"</span><span class="s2">new_value</span><span class="dl">"</span><span class="p">};</span>
<span class="kd">const</span> <span class="nx">customFields</span> <span class="o">=</span> <span class="p">[</span><span class="nx">customField</span><span class="p">];</span>

<span class="nx">api</span><span class="p">.</span><span class="nx">modifySubscriptionCustomFields</span><span class="p">(</span><span class="nx">customFields</span><span class="p">,</span> <span class="nx">subscriptionId</span><span class="p">,</span> <span class="dl">'</span><span class="s1">created_by</span><span class="dl">'</span><span class="p">);</span>
</code></pre></div><div class="highlight"><pre class="highlight php tab-php"><code><span class="nv">$apiInstance</span> <span class="o">=</span> <span class="nv">$client</span><span class="o">-&gt;</span><span class="nf">getSubscriptionApi</span><span class="p">();</span>

<span class="nv">$xKillbillCreatedBy</span> <span class="o">=</span> <span class="s2">"user"</span><span class="p">;</span>
<span class="nv">$xKillbillReason</span> <span class="o">=</span> <span class="s2">"reason"</span><span class="p">;</span>
<span class="nv">$xKillbillComment</span> <span class="o">=</span> <span class="s2">"comment"</span><span class="p">;</span>

<span class="nv">$subscriptionId</span> <span class="o">=</span> <span class="s2">"3f4a2efd-a8c1-4f85-9266-32bd6f7113ba"</span><span class="p">;</span>

<span class="nv">$customField</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CustomField</span><span class="p">();</span>
<span class="nv">$customField</span> <span class="o">-&gt;</span> <span class="nf">setCustomFieldId</span><span class="p">(</span><span class="s1">'73e399fe-efaa-4f05-a5fe-08f10608c345'</span><span class="p">);</span>
<span class="nv">$customField</span> <span class="o">-&gt;</span> <span class="nf">setValue</span><span class="p">(</span><span class="s1">'new_value'</span><span class="p">);</span>
<span class="nv">$body</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="nv">$customField</span><span class="p">);</span>

<span class="nv">$apiInstance</span><span class="o">-&gt;</span><span class="nf">modifySubscriptionCustomFields</span><span class="p">(</span><span class="nv">$body</span><span class="p">,</span> <span class="nv">$xKillbillCreatedBy</span><span class="p">,</span> <span class="nv">$subscriptionId</span><span class="p">,</span> <span class="nv">$xKillbillReason</span><span class="p">,</span> <span class="nv">$xKillbillComment</span><span class="p">);</span>
</code></pre></div>
<p><strong>Request Body</strong></p>

<p>A list of objects specifying the id and the new value for the custom fields to be modified. For example:</p>

<p>[ { &quot;customFieldId&quot;: &quot;6d4c073b-fd89-4e39-9802-eba65f42492f&quot;, &quot;value&quot;: &quot;123&quot; } ]</p>

<p>Although the <code>fieldName</code> and <code>objectType</code> can be specified in the request body, these cannot be modified, only the field value can be modified.</p>

<p><strong>Query Parameters</strong></p>

<p>None.</p>

<p><strong>Response</strong></p>

<p>If successful, returns a status code of 204 and an empty body.</p>
<h3 id='remove-custom-fields-from-subscription'>Remove custom fields from subscription</h3>
<p>Delete one or more custom fields from a subscription. It accepts query parameters corresponding to the custom field ids to be deleted. if no query parameters are specified, it deletes all the custom fields corresponding to the subscription.</p>

<p><strong>HTTP Request</strong> </p>

<p><code>DELETE http://127.0.0.1:8080/1.0/kb/subscriptions/{subscriptionId}/customFields</code></p>

<blockquote>
<p>Example Request:</p>
</blockquote>
<div class="highlight"><pre class="highlight shell tab-shell"><code>curl <span class="nt">-v</span> <span class="se">\</span>
    <span class="nt">-X</span> DELETE <span class="se">\</span>
    <span class="nt">-u</span> admin:password <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-ApiKey: bob"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-ApiSecret: lazar"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-CreatedBy: demo"</span> <span class="se">\</span>
    <span class="s1">'http://127.0.0.1:8080/1.0/kb/subscriptions/77e23878-8b9d-403b-bf31-93003e125712/customFields?customField=439ed0f8-9b37-4688-bace-e2595b1d3801'</span> 
</code></pre></div><div class="highlight"><pre class="highlight java tab-java"><code><span class="kn">import</span> <span class="nn">org.killbill.billing.client.api.gen.SubscriptionApi</span><span class="o">;</span>
<span class="kd">protected</span> <span class="nc">SubscriptionApi</span> <span class="n">subscriptionApi</span><span class="o">;</span>

<span class="no">UUID</span> <span class="n">subscriptionId</span> <span class="o">=</span> <span class="no">UUID</span><span class="o">.</span><span class="na">fromString</span><span class="o">(</span><span class="s">"cca08349-8b26-41c7-bfcc-2e3cf70a0f28"</span><span class="o">);</span>
<span class="no">UUID</span> <span class="n">customFieldsId</span> <span class="o">=</span> <span class="no">UUID</span><span class="o">.</span><span class="na">fromString</span><span class="o">(</span><span class="s">"9913e0f6-b5ef-498b-ac47-60e1626eba8f"</span><span class="o">);</span>
<span class="nc">List</span><span class="o">&lt;</span><span class="no">UUID</span><span class="o">&gt;</span> <span class="n">customFieldsList</span> <span class="o">=</span> <span class="nc">List</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="n">customFieldsId</span><span class="o">);</span>

<span class="n">subscriptionApi</span><span class="o">.</span><span class="na">deleteSubscriptionCustomFields</span><span class="o">(</span><span class="n">subscriptionId</span><span class="o">,</span> 
                                               <span class="n">customFieldsList</span><span class="o">,</span> 
                                               <span class="n">requestOptions</span><span class="o">);</span>
</code></pre></div><div class="highlight"><pre class="highlight ruby tab-ruby"><code><span class="n">user</span> <span class="o">=</span> <span class="s2">"demo"</span>
<span class="n">reason</span> <span class="o">=</span> <span class="kp">nil</span>
<span class="n">comment</span> <span class="o">=</span> <span class="kp">nil</span>

<span class="n">subscription</span> <span class="o">=</span> <span class="no">KillBillClient</span><span class="o">::</span><span class="no">Model</span><span class="o">::</span><span class="no">Subscription</span><span class="p">.</span><span class="nf">new</span>
<span class="n">subscription</span><span class="p">.</span><span class="nf">subscription_id</span> <span class="o">=</span> <span class="s2">"2207150d-0652-43eb-abbe-2cbd0092b744"</span>

<span class="n">custom_field_id</span> <span class="o">=</span> <span class="s1">'a04adaca-78a4-41fe-b512-a8d620aad456'</span>

<span class="n">subscription</span><span class="p">.</span><span class="nf">remove_custom_field</span><span class="p">(</span><span class="n">custom_field_id</span><span class="p">,</span>
                                 <span class="n">user</span><span class="p">,</span>
                                 <span class="n">reason</span><span class="p">,</span>
                                 <span class="n">comment</span><span class="p">,</span>
                                 <span class="n">options</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="n">subscriptionApi</span> <span class="o">=</span> <span class="n">killbill</span><span class="p">.</span><span class="n">api</span><span class="p">.</span><span class="n">SubscriptionApi</span><span class="p">()</span>
<span class="n">subscription_id</span> <span class="o">=</span> <span class="s">'e5254822-680f-4720-b5e1-a7146cefb904'</span>

<span class="n">custom_fields</span> <span class="o">=</span> <span class="p">[</span><span class="s">'194bcfc8-340f-4592-acd2-ffc1fc461e96'</span><span class="p">]</span>

<span class="n">subscriptionApi</span><span class="p">.</span><span class="n">delete_subscription_custom_fields</span><span class="p">(</span><span class="n">subscription_id</span><span class="o">=</span><span class="n">subscription_id</span><span class="p">,</span>
                                                  <span class="n">custom_field</span><span class="o">=</span><span class="n">custom_fields</span><span class="p">,</span>
                                                  <span class="n">created_by</span><span class="o">=</span><span class="s">'demo'</span><span class="p">,</span>
                                                  <span class="n">reason</span><span class="o">=</span><span class="s">'reason'</span><span class="p">,</span>
                                                  <span class="n">comment</span><span class="o">=</span><span class="s">'comment'</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">const</span> <span class="nx">api</span><span class="p">:</span> <span class="nx">killbill</span><span class="p">.</span><span class="nx">SubscriptionApi</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">killbill</span><span class="p">.</span><span class="nx">SubscriptionApi</span><span class="p">(</span><span class="nx">config</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">subscriptionId</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">b6000207-42fd-40ea-9c8e-297d9adc1574</span><span class="dl">'</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">customField</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">d8f2e80d-9fd8-48e7-b564-a541a0a7621d</span><span class="dl">'</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">customFields</span> <span class="o">=</span> <span class="p">[</span><span class="nx">customField</span><span class="p">];</span>

<span class="nx">api</span><span class="p">.</span><span class="nx">deleteSubscriptionCustomFields</span><span class="p">(</span><span class="nx">subscriptionId</span><span class="p">,</span> <span class="dl">'</span><span class="s1">created_by</span><span class="dl">'</span><span class="p">,</span> <span class="nx">customFields</span><span class="p">);</span>
</code></pre></div><div class="highlight"><pre class="highlight php tab-php"><code><span class="nv">$apiInstance</span> <span class="o">=</span> <span class="nv">$client</span><span class="o">-&gt;</span><span class="nf">getSubscriptionApi</span><span class="p">();</span>

<span class="nv">$xKillbillCreatedBy</span> <span class="o">=</span> <span class="s2">"user"</span><span class="p">;</span>
<span class="nv">$xKillbillReason</span> <span class="o">=</span> <span class="s2">"reason"</span><span class="p">;</span>
<span class="nv">$xKillbillComment</span> <span class="o">=</span> <span class="s2">"comment"</span><span class="p">;</span>

<span class="nv">$subscriptionId</span> <span class="o">=</span> <span class="s2">"3f4a2efd-a8c1-4f85-9266-32bd6f7113ba"</span><span class="p">;</span>
<span class="nv">$customFields</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">"73e399fe-efaa-4f05-a5fe-08f10608c345"</span><span class="p">);</span>

<span class="nv">$apiInstance</span><span class="o">-&gt;</span><span class="nf">deleteSubscriptionCustomFields</span><span class="p">(</span><span class="nv">$subscriptionId</span><span class="p">,</span> <span class="nv">$xKillbillCreatedBy</span><span class="p">,</span> <span class="nv">$customFields</span><span class="p">,</span> <span class="nv">$xKillbillReason</span><span class="p">,</span> <span class="nv">$xKillbillComment</span><span class="p">);</span>
</code></pre></div>
<p><strong>Query Parameters</strong></p>

<table><thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Required</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><strong>customField</strong></td>
<td>string</td>
<td>no</td>
<td>none</td>
<td>Custom field object ID that should be deleted. Multiple custom fields can be deleted by specifying a separate <strong>customField</strong> parameter corresponding to each field</td>
</tr>
</tbody></table>

<p><strong>Response</strong></p>

<p>If successful, returns a status code of 204 and an empty body.</p>
<h2 id='tags'>Tags</h2>
<p>See section <a href="account.html#account-tags">Account Tags</a> for an introduction.</p>

<p>The are no <code>system</code> tags applicable for a <code>Subscription</code>.</p>
<h3 id='add-tags-to-subscription'>Add tags to subscription</h3>
<p>This API adds one or more tags to a subscription. Note that none of the <a href="#tag">system tags</a> are applicable for subscriptions, thus only a <a href="#tag">user tag</a> can be added to a subscription. The <a href="#tag-definition">tag definition</a> for the user tag must exist.</p>

<p><strong>HTTP Request</strong> </p>

<p><code>POST http://127.0.0.1:8080/1.0/kb/subscriptions/{subscriptionId}/tags</code></p>

<blockquote>
<p>Example Request:</p>
</blockquote>
<div class="highlight"><pre class="highlight shell tab-shell"><code>curl <span class="nt">-v</span> <span class="se">\</span>
    <span class="nt">-X</span> POST <span class="se">\</span>
    <span class="nt">-u</span> admin:password <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-ApiKey: bob"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-ApiSecret: lazar"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-CreatedBy: demo"</span> <span class="se">\</span>
    <span class="nt">-d</span> <span class="s1">'[
            "353752dd-9041-4450-b782-a8bb03a923c8"
        ]'</span> <span class="se">\</span>
  <span class="s1">'http://127.0.0.1:8080/1.0/kb/subscriptions/77e23878-8b9d-403b-bf31-93003e125712/tags'</span> 
</code></pre></div><div class="highlight"><pre class="highlight java tab-java"><code><span class="kn">import</span> <span class="nn">org.killbill.billing.client.api.gen.SubscriptionApi</span><span class="o">;</span>
<span class="kd">protected</span> <span class="nc">SubscriptionApi</span> <span class="n">subscriptionApi</span><span class="o">;</span>

<span class="no">UUID</span> <span class="n">subscriptionId</span> <span class="o">=</span> <span class="no">UUID</span><span class="o">.</span><span class="na">fromString</span><span class="o">(</span><span class="s">"1bb4b638-3886-4f73-90a5-89eb6d1bcf7f"</span><span class="o">);</span>
<span class="no">UUID</span> <span class="n">tagDefinitionId</span> <span class="o">=</span> <span class="no">UUID</span><span class="o">.</span><span class="na">fromString</span><span class="o">(</span><span class="s">"353752dd-9041-4450-b782-a8bb03a923c8"</span><span class="o">);</span>

<span class="n">subscriptionApi</span><span class="o">.</span><span class="na">createSubscriptionTags</span><span class="o">(</span><span class="n">subscriptionId</span><span class="o">,</span> 
                                                     <span class="nc">List</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="n">tagDefinitionId</span><span class="o">),</span> 
                                                     <span class="n">requestOptions</span><span class="o">);</span>
</code></pre></div><div class="highlight"><pre class="highlight ruby tab-ruby"><code><span class="n">user</span> <span class="o">=</span> <span class="s2">"demo"</span>
<span class="n">reason</span> <span class="o">=</span> <span class="kp">nil</span>
<span class="n">comment</span> <span class="o">=</span> <span class="kp">nil</span>

<span class="n">subscription</span> <span class="o">=</span> <span class="no">KillBillClient</span><span class="o">::</span><span class="no">Model</span><span class="o">::</span><span class="no">Subscription</span><span class="p">.</span><span class="nf">new</span>
<span class="n">subscription</span><span class="p">.</span><span class="nf">subscription_id</span> <span class="o">=</span> <span class="s2">"92820d1c-1d4c-46eb-9010-26b0626a1927"</span>

<span class="n">tag_name</span> <span class="o">=</span> <span class="s1">'good_sub'</span>

<span class="n">subscription</span><span class="p">.</span><span class="nf">add_tag</span><span class="p">(</span><span class="n">tag_name</span><span class="p">,</span>
                     <span class="n">user</span><span class="p">,</span>
                     <span class="n">reason</span><span class="p">,</span>
                     <span class="n">comment</span><span class="p">,</span>
                     <span class="n">options</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="n">subscriptionApi</span> <span class="o">=</span> <span class="n">killbill</span><span class="p">.</span><span class="n">api</span><span class="p">.</span><span class="n">SubscriptionApi</span><span class="p">()</span>
<span class="n">subscription_id</span> <span class="o">=</span> <span class="s">'92820d1c-1d4c-46eb-9010-26b0626a1927'</span>
<span class="n">tagDefIds</span> <span class="o">=</span> <span class="p">[</span><span class="s">'30363fe5-310d-4446-b000-d7bb6e6662e2'</span><span class="p">]</span>

<span class="n">subscriptionApi</span><span class="p">.</span><span class="n">create_subscription_tags</span><span class="p">(</span><span class="n">subscription_id</span><span class="p">,</span>
                                         <span class="n">tagDefIds</span><span class="p">,</span>
                                         <span class="n">created_by</span><span class="o">=</span><span class="s">'demo'</span><span class="p">,</span>
                                         <span class="n">reason</span><span class="o">=</span><span class="s">'reason'</span><span class="p">,</span>
                                         <span class="n">comment</span><span class="o">=</span><span class="s">'comment'</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">const</span> <span class="nx">api</span><span class="p">:</span> <span class="nx">killbill</span><span class="p">.</span><span class="nx">SubscriptionApi</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">killbill</span><span class="p">.</span><span class="nx">SubscriptionApi</span><span class="p">(</span><span class="nx">config</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">subscriptionId</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">92820d1c-1d4c-46eb-9010-26b0626a1927</span><span class="dl">'</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">tagDefIds</span> <span class="o">=</span> <span class="p">[</span><span class="dl">'</span><span class="s1">06d991f7-f06a-4e45-80d2-c3b44a97f8bc</span><span class="dl">'</span><span class="p">];</span>

<span class="nx">api</span><span class="p">.</span><span class="nx">createSubscriptionTags</span><span class="p">(</span><span class="nx">tagDefIds</span><span class="p">,</span> <span class="nx">subscriptionId</span><span class="p">,</span> <span class="dl">'</span><span class="s1">created_by</span><span class="dl">'</span><span class="p">);</span>
</code></pre></div><div class="highlight"><pre class="highlight php tab-php"><code><span class="nv">$apiInstance</span> <span class="o">=</span> <span class="nv">$client</span><span class="o">-&gt;</span><span class="nf">getSubscriptionApi</span><span class="p">();</span>

<span class="nv">$xKillbillCreatedBy</span> <span class="o">=</span> <span class="s2">"user"</span><span class="p">;</span>
<span class="nv">$xKillbillReason</span> <span class="o">=</span> <span class="s2">"reason"</span><span class="p">;</span>
<span class="nv">$xKillbillComment</span> <span class="o">=</span> <span class="s2">"comment"</span><span class="p">;</span>

<span class="nv">$subscriptionId</span> <span class="o">=</span> <span class="s2">"92820d1c-1d4c-46eb-9010-26b0626a1927"</span><span class="p">;</span>
<span class="nv">$tagDefIds</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">"30363fe5-310d-4446-b000-d7bb6e6662e2"</span><span class="p">);</span>

<span class="nv">$apiInstance</span><span class="o">-&gt;</span><span class="nf">createSubscriptionTags</span><span class="p">(</span><span class="nv">$tagDefIds</span><span class="p">,</span> <span class="nv">$xKillbillCreatedBy</span><span class="p">,</span> <span class="nv">$subscriptionId</span><span class="p">,</span> <span class="nv">$xKillbillReason</span><span class="p">,</span> <span class="nv">$xKillbillComment</span><span class="p">);</span>
</code></pre></div>
<p><strong>Request Body</strong></p>

<p>A JSON array containing one or more strings giving the UUID of tag definitions for the user tags to be added.</p>

<p><strong>Query Parameters</strong></p>

<p>None.</p>

<p><strong>Returns</strong></p>

<p>If successful, returns a 201 status code. In addition, a Location header is returned giving the URL to retrieve the tags associated with the subscription.</p>
<h3 id='retrieve-subscription-tags'>Retrieve subscription tags</h3>
<p>Retrieve all tags attached to this subscription.</p>

<p><strong>HTTP Request</strong> </p>

<p><code>GET http://127.0.0.1:8080/1.0/kb/subscriptions/{subscriptionId}/tags</code></p>

<blockquote>
<p>Example Request:</p>
</blockquote>
<div class="highlight"><pre class="highlight shell tab-shell"><code>curl <span class="se">\</span>
    <span class="nt">-u</span> admin:password <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-ApiKey: bob"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-ApiSecret: lazar"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"Accept: application/json"</span> <span class="se">\</span>
    <span class="s1">'http://127.0.0.1:8080/1.0/kb/subscriptions/77e23878-8b9d-403b-bf31-93003e125712/tags'</span> 
</code></pre></div><div class="highlight"><pre class="highlight java tab-java"><code><span class="kn">import</span> <span class="nn">org.killbill.billing.client.api.gen.SubscriptionApi</span><span class="o">;</span>
<span class="kd">protected</span> <span class="nc">SubscriptionApi</span> <span class="n">subscriptionApi</span><span class="o">;</span>

<span class="no">UUID</span> <span class="n">subscriptionId</span> <span class="o">=</span> <span class="no">UUID</span><span class="o">.</span><span class="na">fromString</span><span class="o">(</span><span class="s">"1bb4b638-3886-4f73-90a5-89eb6d1bcf7f"</span><span class="o">);</span>
<span class="nc">Boolean</span> <span class="n">includedDeleted</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span> <span class="c1">// Will not include deleted tags</span>

<span class="nc">List</span><span class="o">&lt;</span><span class="nc">Tag</span><span class="o">&gt;</span> <span class="n">tags</span> <span class="o">=</span> <span class="n">subscriptionApi</span><span class="o">.</span><span class="na">getSubscriptionTags</span><span class="o">(</span><span class="n">subscriptionId</span><span class="o">,</span> 
                                                     <span class="n">includedDeleted</span><span class="o">,</span> 
                                                     <span class="nc">AuditLevel</span><span class="o">.</span><span class="na">FULL</span><span class="o">,</span> 
                                                     <span class="n">requestOptions</span><span class="o">);</span>
</code></pre></div><div class="highlight"><pre class="highlight ruby tab-ruby"><code><span class="n">subscription</span> <span class="o">=</span> <span class="no">KillBillClient</span><span class="o">::</span><span class="no">Model</span><span class="o">::</span><span class="no">Subscription</span><span class="p">.</span><span class="nf">new</span>
<span class="n">subscription</span><span class="p">.</span><span class="nf">subscription_id</span> <span class="o">=</span> <span class="s2">"92820d1c-1d4c-46eb-9010-26b0626a1927"</span>

<span class="n">included_deleted</span> <span class="o">=</span> <span class="kp">false</span>
<span class="n">audit</span> <span class="o">=</span> <span class="s1">'NONE'</span>

<span class="n">tags</span> <span class="o">=</span> <span class="n">subscription</span><span class="p">.</span><span class="nf">tags</span><span class="p">(</span><span class="n">included_deleted</span><span class="p">,</span>
                  <span class="n">audit</span><span class="p">,</span>
                  <span class="n">options</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="n">subscriptionApi</span> <span class="o">=</span> <span class="n">killbill</span><span class="p">.</span><span class="n">api</span><span class="p">.</span><span class="n">SubscriptionApi</span><span class="p">()</span>
<span class="n">subscription_id</span> <span class="o">=</span> <span class="s">'92820d1c-1d4c-46eb-9010-26b0626a1927'</span>

<span class="n">tags</span> <span class="o">=</span> <span class="n">subscriptionApi</span><span class="p">.</span><span class="n">get_subscription_tags</span><span class="p">(</span><span class="n">subscription_id</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">const</span> <span class="nx">api</span><span class="p">:</span> <span class="nx">killbill</span><span class="p">.</span><span class="nx">SubscriptionApi</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">killbill</span><span class="p">.</span><span class="nx">SubscriptionApi</span><span class="p">(</span><span class="nx">config</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">subscriptionId</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">92820d1c-1d4c-46eb-9010-26b0626a1927</span><span class="dl">'</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">includeDeleted</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">audit</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">NONE</span><span class="dl">'</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">response</span><span class="p">:</span> <span class="nx">AxiosResponse</span><span class="o">&lt;</span><span class="nx">killbill</span><span class="p">.</span><span class="nx">Tag</span><span class="p">[],</span> <span class="nx">any</span><span class="o">&gt;</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">api</span><span class="p">.</span><span class="nx">getSubscriptionTags</span><span class="p">(</span><span class="nx">subscriptionId</span><span class="p">,</span> <span class="nx">includeDeleted</span><span class="p">,</span> <span class="nx">audit</span><span class="p">);</span>
</code></pre></div><div class="highlight"><pre class="highlight php tab-php"><code><span class="nv">$apiInstance</span> <span class="o">=</span> <span class="nv">$client</span><span class="o">-&gt;</span><span class="nf">getSubscriptionApi</span><span class="p">();</span>

<span class="nv">$subscriptionId</span> <span class="o">=</span> <span class="s2">"92820d1c-1d4c-46eb-9010-26b0626a1927"</span><span class="p">;</span>
<span class="nv">$includedDeleted</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
<span class="nv">$audit</span> <span class="o">=</span> <span class="s2">"NONE"</span><span class="p">;</span>

<span class="nv">$result</span> <span class="o">=</span> <span class="nv">$apiInstance</span><span class="o">-&gt;</span><span class="nf">getSubscriptionTags</span><span class="p">(</span><span class="nv">$subscriptionId</span><span class="p">,</span> <span class="nv">$includedDeleted</span><span class="p">,</span> <span class="nv">$audit</span><span class="p">);</span>
</code></pre></div>
<blockquote>
<p>Example Response:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"tagId"</span><span class="p">:</span><span class="s2">"d0513754-56a9-4694-abb1-3ac46c72e861"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"objectType"</span><span class="p">:</span><span class="s2">"SUBSCRIPTION"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"objectId"</span><span class="p">:</span><span class="s2">"77e23878-8b9d-403b-bf31-93003e125712"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"tagDefinitionId"</span><span class="p">:</span><span class="s2">"353752dd-9041-4450-b782-a8bb03a923c8"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"tagDefinitionName"</span><span class="p">:</span><span class="s2">"foo"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"auditLogs"</span><span class="p">:[]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre></div>
<p><strong>Query Parameters</strong></p>

<table><thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Required</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><strong>includedDeleted</strong></td>
<td>boolean</td>
<td>no</td>
<td>false</td>
<td>If true, include deleted tags</td>
</tr>
<tr>
<td><strong>audit</strong></td>
<td>string</td>
<td>no</td>
<td>&quot;NONE&quot;</td>
<td>Level of audit information to return: &quot;NONE&quot;, &quot;MINIMAL&quot;, or &quot;FULL&quot;</td>
</tr>
</tbody></table>

<p><strong>Response</strong></p>

<p>If successful, returns a status code of 200 and a list of tag objects.</p>
<h3 id='remove-tags-from-subscription'>Remove tags from subscription</h3>
<p>This API deletes one or more tags attached to a subscription.</p>

<p><strong>HTTP Request</strong> </p>

<p><code>DELETE http://127.0.0.1:8080/1.0/kb/subscriptions/{subscriptionId}/tags</code></p>

<blockquote>
<p>Example Request:</p>
</blockquote>
<div class="highlight"><pre class="highlight shell tab-shell"><code>curl <span class="nt">-v</span> <span class="se">\</span>
    <span class="nt">-X</span> DELETE <span class="se">\</span>
    <span class="nt">-u</span> admin:password <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-ApiKey: bob"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-ApiSecret: lazar"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-CreatedBy: demo"</span> <span class="se">\</span>
    <span class="s1">'http://127.0.0.1:8080/1.0/kb/subscriptions/77e23878-8b9d-403b-bf31-93003e125712/tags?tagDef=353752dd-9041-4450-b782-a8bb03a923c8'</span>  
</code></pre></div><div class="highlight"><pre class="highlight java tab-java"><code><span class="kn">import</span> <span class="nn">org.killbill.billing.client.api.gen.SubscriptionApi</span><span class="o">;</span>
<span class="kd">protected</span> <span class="nc">SubscriptionApi</span> <span class="n">subscriptionApi</span><span class="o">;</span>

<span class="no">UUID</span> <span class="n">subscriptionId</span> <span class="o">=</span> <span class="no">UUID</span><span class="o">.</span><span class="na">fromString</span><span class="o">(</span><span class="s">"1bb4b638-3886-4f73-90a5-89eb6d1bcf7f"</span><span class="o">);</span>
<span class="no">UUID</span> <span class="n">tagDefinitionId</span> <span class="o">=</span> <span class="no">UUID</span><span class="o">.</span><span class="na">fromString</span><span class="o">(</span><span class="s">"353752dd-9041-4450-b782-a8bb03a923c8"</span><span class="o">);</span>

<span class="n">subscriptionApi</span><span class="o">.</span><span class="na">deleteSubscriptionTags</span><span class="o">(</span><span class="n">subscriptionId</span><span class="o">,</span> <span class="nc">List</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="n">tagDefinitionId</span><span class="o">),</span> <span class="n">requestOptions</span><span class="o">);</span>
</code></pre></div><div class="highlight"><pre class="highlight ruby tab-ruby"><code><span class="n">user</span> <span class="o">=</span> <span class="s2">"demo"</span>
<span class="n">reason</span> <span class="o">=</span> <span class="kp">nil</span>
<span class="n">comment</span> <span class="o">=</span> <span class="kp">nil</span>

<span class="n">subscription</span> <span class="o">=</span> <span class="no">KillBillClient</span><span class="o">::</span><span class="no">Model</span><span class="o">::</span><span class="no">Subscription</span><span class="p">.</span><span class="nf">new</span>
<span class="n">subscription</span><span class="p">.</span><span class="nf">subscription_id</span> <span class="o">=</span> <span class="s2">"92820d1c-1d4c-46eb-9010-26b0626a1927"</span>

<span class="n">tag_name</span> <span class="o">=</span> <span class="s1">'good_sub'</span>

<span class="n">subscription</span><span class="p">.</span><span class="nf">remove_tag</span><span class="p">(</span><span class="n">tag_name</span><span class="p">,</span>
                        <span class="n">user</span><span class="p">,</span>
                        <span class="n">reason</span><span class="p">,</span>
                        <span class="n">comment</span><span class="p">,</span>
                        <span class="n">options</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="n">subscriptionApi</span> <span class="o">=</span> <span class="n">killbill</span><span class="p">.</span><span class="n">api</span><span class="p">.</span><span class="n">SubscriptionApi</span><span class="p">()</span>
<span class="n">subscription_id</span> <span class="o">=</span> <span class="s">'92820d1c-1d4c-46eb-9010-26b0626a1927'</span>
<span class="n">tagDefIds</span> <span class="o">=</span> <span class="p">[</span><span class="s">'30363fe5-310d-4446-b000-d7bb6e6662e2'</span><span class="p">]</span>

<span class="n">subscriptionApi</span><span class="p">.</span><span class="n">delete_subscription_tags</span><span class="p">(</span><span class="n">subscription_id</span><span class="p">,</span>
                                         <span class="n">tag_def</span><span class="o">=</span><span class="n">tagDefIds</span><span class="p">,</span>
                                         <span class="n">created_by</span><span class="o">=</span><span class="s">'demo'</span><span class="p">,</span>
                                         <span class="n">reason</span><span class="o">=</span><span class="s">'reason'</span><span class="p">,</span>
                                         <span class="n">comment</span><span class="o">=</span><span class="s">'comment'</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">const</span> <span class="nx">api</span><span class="p">:</span> <span class="nx">killbill</span><span class="p">.</span><span class="nx">SubscriptionApi</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">killbill</span><span class="p">.</span><span class="nx">SubscriptionApi</span><span class="p">(</span><span class="nx">config</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">subscriptionId</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">92820d1c-1d4c-46eb-9010-26b0626a1927</span><span class="dl">'</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">tagDefIds</span> <span class="o">=</span> <span class="p">[</span><span class="dl">'</span><span class="s1">06d991f7-f06a-4e45-80d2-c3b44a97f8bc</span><span class="dl">'</span><span class="p">];</span>

<span class="nx">api</span><span class="p">.</span><span class="nx">deleteSubscriptionTags</span><span class="p">(</span><span class="nx">subscriptionId</span><span class="p">,</span> <span class="dl">'</span><span class="s1">created_by</span><span class="dl">'</span><span class="p">,</span> <span class="nx">tagDefIds</span><span class="p">);</span>
</code></pre></div><div class="highlight"><pre class="highlight php tab-php"><code><span class="nv">$apiInstance</span> <span class="o">=</span> <span class="nv">$client</span><span class="o">-&gt;</span><span class="nf">getSubscriptionApi</span><span class="p">();</span>

<span class="nv">$xKillbillCreatedBy</span> <span class="o">=</span> <span class="s2">"user"</span><span class="p">;</span>
<span class="nv">$xKillbillReason</span> <span class="o">=</span> <span class="s2">"reason"</span><span class="p">;</span>
<span class="nv">$xKillbillComment</span> <span class="o">=</span> <span class="s2">"comment"</span><span class="p">;</span>

<span class="nv">$subscriptionId</span> <span class="o">=</span> <span class="s2">"92820d1c-1d4c-46eb-9010-26b0626a1927"</span><span class="p">;</span>
<span class="nv">$tagDefIds</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">"30363fe5-310d-4446-b000-d7bb6e6662e2"</span><span class="p">);</span>

<span class="nv">$apiInstance</span><span class="o">-&gt;</span><span class="nf">deleteSubscriptionTags</span><span class="p">(</span><span class="nv">$subscriptionId</span><span class="p">,</span> <span class="nv">$xKillbillCreatedBy</span><span class="p">,</span> <span class="nv">$tagDefIds</span><span class="p">,</span> <span class="nv">$xKillbillReason</span><span class="p">,</span> <span class="nv">$xKillbillComment</span><span class="p">);</span>
</code></pre></div>
<p><strong>Query Parameters</strong></p>

<table><thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Required</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><strong>tagDef</strong></td>
<td>string</td>
<td>true</td>
<td>none</td>
<td>A tag definition ID identifying the tag that should be removed. Multiple tags can be deleted by specifying a separate tagDef parameter corresponding to each tag.</td>
</tr>
</tbody></table>

<p><strong>Response</strong></p>

<p>If successful, returns a status code of 204 and an empty body.</p>
<h2 id='audit-logs'>Audit Logs</h2>
<p>Audit logs provide a record of events that occur involving various specific resources. For details on audit logs see <a href="https://killbill.github.io/slate/#using-kill-bill-apis-audit-and-history">Audit and History</a>.</p>
<h3 id='retrieve-subscription-audit-logs-with-history-by-subscription-id'>Retrieve subscription audit logs with history by subscription id</h3>
<p>Retrieve a list of audit log records showing changes to the subscription. History information (a copy of the full subscription object) is included with each record.</p>

<p>Some examples:
* Assuming the API is invoked after an <code>IN_ADVANCE</code> subscription is created, it would return two records:
  * An <code>INSERT</code> record corresponding to the subscription creation
  * An <code>UPDATE</code> record corresponding to the <code>chargedThroughDate</code> update
* Assuming the API is invoked after a plan change, it would return three records:
  * An <code>INSERT</code> record corresponding to the subscription creation
  * An <code>UPDATE</code> record corresponding to the <code>chargedThroughDate</code> update
  * An <code>UPDATE</code> record corresponding to plan change</p>

<p><strong>HTTP Request</strong> </p>

<p><code>GET http://127.0.0.1:8080/1.0/kb/subscriptions/{subscriptionId}/auditLogsWithHistory</code></p>

<blockquote>
<p>Example Request:</p>
</blockquote>
<div class="highlight"><pre class="highlight shell tab-shell"><code>curl <span class="nt">-v</span> <span class="se">\</span>
    <span class="nt">-u</span> admin:password <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-ApiKey: bob"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-ApiSecret: lazar"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"Accept: application/json"</span> <span class="se">\</span>
    <span class="s2">"http://localhost:8080/1.0/kb/subscriptions/70b6856e-6938-495f-9ae9-0a8ec0571c37/auditLogsWithHistory"</span>
</code></pre></div><div class="highlight"><pre class="highlight java tab-java"><code><span class="kn">import</span> <span class="nn">org.killbill.billing.client.api.gen.SubscriptionApi</span><span class="o">;</span>
<span class="kd">protected</span> <span class="nc">SubscriptionApi</span> <span class="n">subscriptionApi</span><span class="o">;</span>

<span class="no">UUID</span> <span class="n">subscriptionId</span> <span class="o">=</span> <span class="no">UUID</span><span class="o">.</span><span class="na">fromString</span><span class="o">(</span><span class="s">"bc9b98e8-7497-4330-aa42-1fbc71a3d19c"</span><span class="o">);</span>

<span class="nc">List</span><span class="o">&lt;</span><span class="nc">AuditLog</span><span class="o">&gt;</span> <span class="n">auditLog</span> <span class="o">=</span> <span class="n">subscriptionApi</span><span class="o">.</span><span class="na">getSubscriptionAuditLogsWithHistory</span><span class="o">(</span><span class="n">subscriptionId</span><span class="o">,</span> <span class="n">requestOptions</span><span class="o">);</span>
</code></pre></div><div class="highlight"><pre class="highlight ruby tab-ruby"><code><span class="no">TODO</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="n">subscriptionApi</span> <span class="o">=</span> <span class="n">killbill</span><span class="p">.</span><span class="n">api</span><span class="p">.</span><span class="n">SubscriptionApi</span><span class="p">()</span>
<span class="n">subscription_id</span> <span class="o">=</span> <span class="s">'92820d1c-1d4c-46eb-9010-26b0626a1927'</span>

<span class="n">auditlogs</span> <span class="o">=</span> <span class="n">subscriptionApi</span><span class="p">.</span><span class="n">get_subscription_audit_logs_with_history</span><span class="p">(</span><span class="n">subscription_id</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">const</span> <span class="nx">api</span><span class="p">:</span> <span class="nx">killbill</span><span class="p">.</span><span class="nx">SubscriptionApi</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">killbill</span><span class="p">.</span><span class="nx">SubscriptionApi</span><span class="p">(</span><span class="nx">config</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">subscriptionId</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">92820d1c-1d4c-46eb-9010-26b0626a1927</span><span class="dl">'</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">response</span><span class="p">:</span> <span class="nx">AxiosResponse</span><span class="o">&lt;</span><span class="nx">killbill</span><span class="p">.</span><span class="nx">Tag</span><span class="p">[],</span> <span class="nx">any</span><span class="o">&gt;</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">api</span><span class="p">.</span><span class="nx">getSubscriptionAuditLogsWithHistory</span><span class="p">(</span><span class="nx">subscriptionId</span><span class="p">);</span>
</code></pre></div><div class="highlight"><pre class="highlight php tab-php"><code><span class="nv">$apiInstance</span> <span class="o">=</span> <span class="nv">$client</span><span class="o">-&gt;</span><span class="nf">getSubscriptionApi</span><span class="p">();</span>

<span class="nv">$subscriptionId</span> <span class="o">=</span> <span class="s2">"92820d1c-1d4c-46eb-9010-26b0626a1927"</span><span class="p">;</span>

<span class="nv">$result</span> <span class="o">=</span> <span class="nv">$apiInstance</span><span class="o">-&gt;</span><span class="nf">getSubscriptionAuditLogsWithHistory</span><span class="p">(</span><span class="nv">$subscriptionId</span><span class="p">);</span>
</code></pre></div>
<blockquote>
<p>Example Response:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"changeType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"INSERT"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"changeDate"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2019-02-22T22:38:10.000Z"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"objectType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SUBSCRIPTION"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"objectId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"70b6856e-6938-495f-9ae9-0a8ec0571c37"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"changedBy"</span><span class="p">:</span><span class="w"> </span><span class="s2">"admin"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"reasonCode"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"comments"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"userToken"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1f03e074-dea1-45c5-aee3-c9464886f476"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"history"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nl">"createdDate"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2019-02-22T22:38:10.000Z"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"updatedDate"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2019-02-22T22:38:10.000Z"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"recordId"</span><span class="p">:</span><span class="w"> </span><span class="mi">465</span><span class="p">,</span><span class="w">
      </span><span class="nl">"accountRecordId"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w">
      </span><span class="nl">"tenantRecordId"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
      </span><span class="nl">"bundleId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"d1b329c7-7dcf-466c-aaca-47bff304dab0"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"category"</span><span class="p">:</span><span class="w"> </span><span class="s2">"BASE"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"startDate"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2019-02-22T22:38:10.000Z"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"bundleStartDate"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2019-02-22T22:38:10.000Z"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"chargedThroughDate"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nl">"migrated"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
      </span><span class="nl">"tableName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SUBSCRIPTIONS"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"historyTableName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SUBSCRIPTION_HISTORY"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"changeType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"UPDATE"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"changeDate"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2019-02-22T22:38:10.000Z"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"objectType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SUBSCRIPTION"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"objectId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"70b6856e-6938-495f-9ae9-0a8ec0571c37"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"changedBy"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SubscriptionBaseTransition"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"reasonCode"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"comments"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"userToken"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1f03e074-dea1-45c5-aee3-c9464886f476"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"history"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nl">"createdDate"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2019-02-22T22:38:10.000Z"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"updatedDate"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2019-02-22T22:38:10.000Z"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"recordId"</span><span class="p">:</span><span class="w"> </span><span class="mi">465</span><span class="p">,</span><span class="w">
      </span><span class="nl">"accountRecordId"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w">
      </span><span class="nl">"tenantRecordId"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
      </span><span class="nl">"bundleId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"d1b329c7-7dcf-466c-aaca-47bff304dab0"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"category"</span><span class="p">:</span><span class="w"> </span><span class="s2">"BASE"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"startDate"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2019-02-22T22:38:10.000Z"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"bundleStartDate"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2019-02-22T22:38:10.000Z"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"chargedThroughDate"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2019-03-22T23:35:14.000Z"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"migrated"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
      </span><span class="nl">"tableName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SUBSCRIPTIONS"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"historyTableName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SUBSCRIPTION_HISTORY"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">

</span></code></pre></div>
<p><strong>Query Parameters</strong></p>

<p>None.</p>

<p><strong>Response</strong></p>

<p>If successful, returns a status code of 200 and a list of audit logs.</p>
<h3 id='retrieve-subscription-event-audit-logs-with-history-by-subscription-event-id'>Retrieve subscription event audit logs with history by subscription event id</h3>
<p>Retrieve a list of audit log records showing changes to a subscription event. History information (a copy of the full subscription event object) is included with each record. The <a href="##subscription-subscription-resource">subscription resource</a> contains the list of events associated with a subscription and the event id can be obtained from here.</p>

<p>Some examples:
* If a cancel request is issued for a subscription, this API can be invoked with the subscription event id of the <code>CANCEL</code> event. In this case, it will return:
  * An <code>INSERT</code> record corresponding to the subscription cancel event creation
* If a subscription is future cancelled and then uncancelled, and this API is invoked with the id of the <code>CANCEL</code>event, it will return two records:
  * An <code>INSERT</code> record corresponding to the <code>CANCEL</code> event creation
  * A <code>DELETE</code> record corresponding to the <code>CANCEL</code> event deletion.</p>

<p><strong>HTTP Request</strong> </p>

<p><code>GET http://127.0.0.1:8080/1.0/kb/subscriptions/events/{subscriptionEventId}/auditLogsWithHistory</code></p>

<blockquote>
<p>Example Request:</p>
</blockquote>
<div class="highlight"><pre class="highlight shell tab-shell"><code>curl  <span class="se">\</span>
    <span class="nt">-u</span> admin:password <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-ApiKey: bob"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"X-Killbill-ApiSecret: lazar"</span> <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"Accept: application/json"</span> <span class="se">\</span>
    <span class="s2">"http://localhost:8080/1.0/kb/subscriptions/events/9a1c85d5-beba-40c8-9268-f73e09c24007/auditLogsWithHistory"</span>
</code></pre></div><div class="highlight"><pre class="highlight java tab-java"><code><span class="kn">import</span> <span class="nn">org.killbill.billing.client.api.gen.SubscriptionApi</span><span class="o">;</span>
<span class="kd">protected</span> <span class="nc">SubscriptionApi</span> <span class="n">subscriptionApi</span><span class="o">;</span>

<span class="no">UUID</span> <span class="n">subscriptionEventId</span> <span class="o">=</span> <span class="no">UUID</span><span class="o">.</span><span class="na">fromString</span><span class="o">(</span><span class="s">"b4b6f990-4456-4009-9e6c-9825a99a1f25"</span><span class="o">);</span>

<span class="nc">List</span><span class="o">&lt;</span><span class="nc">AuditLog</span><span class="o">&gt;</span> <span class="n">eventAuditLog</span> <span class="o">=</span> <span class="n">subscriptionApi</span><span class="o">.</span><span class="na">getSubscriptionEventAuditLogsWithHistory</span><span class="o">(</span><span class="n">subscriptionEventId</span><span class="o">,</span> <span class="n">requestOptions</span><span class="o">);</span>
</code></pre></div><div class="highlight"><pre class="highlight ruby tab-ruby"><code><span class="no">TODO</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="n">subscriptionApi</span> <span class="o">=</span> <span class="n">killbill</span><span class="p">.</span><span class="n">api</span><span class="p">.</span><span class="n">SubscriptionApi</span><span class="p">()</span>
<span class="n">event_id</span> <span class="o">=</span> <span class="s">'dc283026-5be0-4e47-8190-b62fb0c9e357'</span>

<span class="n">auditlogs</span> <span class="o">=</span> <span class="n">subscriptionApi</span><span class="p">.</span><span class="n">get_subscription_event_audit_logs_with_history</span><span class="p">(</span><span class="n">event_id</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">const</span> <span class="nx">api</span><span class="p">:</span> <span class="nx">killbill</span><span class="p">.</span><span class="nx">SubscriptionApi</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">killbill</span><span class="p">.</span><span class="nx">SubscriptionApi</span><span class="p">(</span><span class="nx">config</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">eventId</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">dc283026-5be0-4e47-8190-b62fb0c9e357</span><span class="dl">'</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">response</span><span class="p">:</span> <span class="nx">AxiosResponse</span><span class="o">&lt;</span><span class="nx">killbill</span><span class="p">.</span><span class="nx">Tag</span><span class="p">[],</span> <span class="nx">any</span><span class="o">&gt;</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">api</span><span class="p">.</span><span class="nx">getSubscriptionEventAuditLogsWithHistory</span><span class="p">(</span><span class="nx">eventId</span><span class="p">);</span>
</code></pre></div><div class="highlight"><pre class="highlight php tab-php"><code><span class="nv">$apiInstance</span> <span class="o">=</span> <span class="nv">$client</span><span class="o">-&gt;</span><span class="nf">getSubscriptionApi</span><span class="p">();</span>

<span class="nv">$eventId</span> <span class="o">=</span> <span class="s2">"dc283026-5be0-4e47-8190-b62fb0c9e357"</span><span class="p">;</span>

<span class="nv">$result</span> <span class="o">=</span> <span class="nv">$apiInstance</span><span class="o">-&gt;</span><span class="nf">getSubscriptionEventAuditLogsWithHistory</span><span class="p">(</span><span class="nv">$eventId</span><span class="p">);</span>
</code></pre></div>
<blockquote>
<p>Example Response:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"changeType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"INSERT"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"changeDate"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2019-02-22T22:38:10.000Z"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"objectType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SUBSCRIPTION_EVENT"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"objectId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"9a1c85d5-beba-40c8-9268-f73e09c24007"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"changedBy"</span><span class="p">:</span><span class="w"> </span><span class="s2">"admin"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"reasonCode"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"comments"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"userToken"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1f03e074-dea1-45c5-aee3-c9464886f476"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"history"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nl">"createdDate"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2019-02-22T22:38:10.000Z"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"updatedDate"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2019-02-22T22:38:10.000Z"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"recordId"</span><span class="p">:</span><span class="w"> </span><span class="mi">1358</span><span class="p">,</span><span class="w">
      </span><span class="nl">"accountRecordId"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w">
      </span><span class="nl">"tenantRecordId"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
      </span><span class="nl">"totalOrdering"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
      </span><span class="nl">"eventType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"API_USER"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"userType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CREATE"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"effectiveDate"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2019-02-22T22:38:10.000Z"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"subscriptionId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"70b6856e-6938-495f-9ae9-0a8ec0571c37"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"planName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"foo-monthly"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"phaseName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"foo-monthly-evergreen"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"priceListName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"DEFAULT"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"billingCycleDayLocal"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
      </span><span class="nl">"isActive"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="nl">"tableName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SUBSCRIPTION_EVENTS"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"historyTableName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SUBSCRIPTION_EVENT_HISTORY"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"active"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre></div>
<p><strong>Query Parameters</strong></p>

<p>None.</p>

<p><strong>Response</strong></p>

<p>If successful, returns a status code of 200 and a list of audit logs with history.</p>

      </div>
    </main>
  </body>

    <script src="javascripts/all.js"></script>

  <script>
    function debounce(func, delay) {
      let timeoutId;
      return function() {
        const context = this;
        const args = arguments;
        clearTimeout(timeoutId);
        timeoutId = setTimeout(function() {
          func.apply(context, args);
        }, delay);
      };
    }
    function copyToClipboard(textToCopy) {
      const textarea = document.createElement('textarea');
      textarea.value = textToCopy;
      document.body.appendChild(textarea);
      textarea.select();
      document.execCommand('copy');
      document.body.removeChild(textarea);
    }

    class ProgramingLanguages {
      _defaultList = [];

      constructor(langList) {
        this.list = langList;
        this.updateDOMWithNewActiveLanguage();

        $(".lang-selector .lang-selector__link").on("click", (event) => {
          event.preventDefault();
          this.updateDOMWithNewActiveLanguage($(event.target).data("language-name"));
        });

        $(".lang-selector .lang-selector__select").on("change", (event) => {
          event.preventDefault()
          this.updateDOMWithNewActiveLanguage(event.target.value)
        });
      }

      get list() {
        const list = localStorage.getItem('listOfProgramingLanguages');
        return list ? JSON.parse(list) : this._defaultList;
      }

      set list(list) {
        localStorage.setItem('listOfProgramingLanguages', JSON.stringify(list));
      }

      get activeLanguage() {
        const activeLang = localStorage.getItem('activeProgramingLanguage');
        return activeLang || this.list[0];
      }
      
      set activeLanguage(activeLang) {
        localStorage.setItem('activeProgramingLanguage', activeLang);
      }

      updateDOMWithNewActiveLanguage(lang) {
        if(lang) {
          this.activeLanguage = lang
        }

        $(".lang-selector .lang-selector__link").removeClass('active');
        $(`.lang-selector .lang-selector__link[data-language-name='${lang || this.activeLanguage}']`).addClass('active');
        this.showOnlyActiveLanguage();
      }
      
      showOnlyActiveLanguage() {
        const activeLang = this.activeLanguage;
        
        if (activeLang) {
          $('.code-snippet').each((index, element) => {
            const snippetHasActiveLang = $(element).find(`.${activeLang}`);

            if (!snippetHasActiveLang.length > 0) {
              $(element).hide();
            } else {
              $(element).show();
            }

            $(element).children('.highlight').each(function (index, ch) {
              $(ch).hide()
              $(ch).has(`.${activeLang}`).show()
            })
          });
        }
      }
    }

    // DOM restructuring
    $('.content h2, .content h3, .content h4').each(function(){
      const itemHref = '#' + $(this).attr('id');
      $(this).append(`<a href="${itemHref}" style="padding-left: 10px;"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill="currentColor" fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>`);
      
      $(this).find('a').on('click', function(event) {
        event.preventDefault();

        const currentURLWithoutHash = window?.location?.href?.split('#')[0];
        const textToCopy = currentURLWithoutHash + itemHref;

        copyToClipboard(textToCopy)
      });
    });

    $('.content h3, .content h2, .content h1').each(
      function(i,e) {
        const sectionElements = $(this).nextUntil('h3, h2, h1')

        const codeSnippets = sectionElements.filter('.highlight, blockquote')
        const textBlock = sectionElements.not('.highlight, blockquote')

        const section = $('<section class="content__section" />')
          .append($('<div class="content__text" />').append(textBlock))
          .append($('<div class="content__code-snippets" />').append(codeSnippets))

        section.insertAfter($(this))
    });

    $('blockquote').each(function() {
      const $blockquote = $(this)
      $blockquote.prepend('<div class="copy-clipboard"><svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M5.25 1.5H11.1667C13.0335 1.5 13.9669 1.5 14.68 1.86331C15.3072 2.18289 15.8171 2.69282 16.1367 3.32003C16.5 4.03307 16.5 4.96649 16.5 6.83333V12.75M4.16667 16.5H10.9167C11.8501 16.5 12.3168 16.5 12.6733 16.3183C12.9869 16.1586 13.2419 15.9036 13.4017 15.59C13.5833 15.2335 13.5833 14.7668 13.5833 13.8333V7.08333C13.5833 6.14991 13.5833 5.6832 13.4017 5.32668C13.2419 5.01308 12.9869 4.75811 12.6733 4.59832C12.3168 4.41667 11.8501 4.41667 10.9167 4.41667H4.16667C3.23325 4.41667 2.76654 4.41667 2.41002 4.59832C2.09641 4.75811 1.84144 5.01308 1.68166 5.32668C1.5 5.6832 1.5 6.14991 1.5 7.08333V13.8333C1.5 14.7668 1.5 15.2335 1.68166 15.59C1.84144 15.9036 2.09641 16.1586 2.41002 16.3183C2.76654 16.5 3.23325 16.5 4.16667 16.5Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg></div>');

      $($blockquote).add($($blockquote).nextUntil('blockquote', 'div')).wrapAll('<div class="code-snippet"></div>')
    });

    $('table').each(function () {
      $(this).wrapAll('<div class="table-wrapper" />')
    })


    // Init active menu item if it has 
    $('.site-navigator .site-navigator__menu-item[href*="#"]').addClass('active')

    // Init theme
    if(JSON.parse(localStorage.getItem('is-dark-theme'))) {
      $('body').addClass('dark')
    }

    // Init programing language 
    programingLanguages = new ProgramingLanguages($('body').data('languages'))

    // Add event listeners on '.copy-clipboard' selector
    $('.copy-clipboard').on('click', function () {
      copyToClipboard($(this).parent().parent().find(`.${programingLanguages.activeLanguage} code`).text());

      if (!$(this).find('.tooltip').length > 0) {
        $(this).prepend('<span class="tooltip">Copied</span>');
        
        let that = this;
        setTimeout(function () {
          $(that).find('.tooltip').remove();
        }, 2000);
      }
    });
    
    $('.theme-switch').on('click', function (e) {
      $('body').toggleClass('dark');

      localStorage.setItem('is-dark-theme', $('body').hasClass('dark'))
    });

    $('.header__sidebar-toggler').on('click', function() {
      $(this).toggleClass('active')
      $('.page').toggleClass('show-sidebar')
    })

    $('.site-navigator .site-navigator__menu-item').on('click', function () {
      if($(this).hasClass('active')) {
        $(this).removeClass('active')

        return;
      }

      $('.site-navigator .site-navigator__menu-item').removeClass('active')
      $(this).addClass('active')
    })
    
    $('.site-navigator .site-navigator__submenu-item').on('click', function () {
      if($(this).parent('.site-navigator__submenu').siblings('.site-navigator__menu-item.active')) {
        $('.site-navigator .site-navigator__submenu-item').removeClass('active')
        $(this).addClass('active')

        return;
      }

      $('.site-navigator .site-navigator__submenu-item').removeClass('active')
      $('.site-navigator .site-navigator__menu-item').removeClass('active')
      $(this).parent('.site-navigator__menu-item').addClass('active')
      $(this).addClass('active')
    })

    const navLinks = $('.site-navigator .site-navigator__menu-item.active + .site-navigator__submenu').find('.site-navigator__submenu-item')
    const HEIGHT_OF_PAGE_HEADER = 70;
    
    function handleScroll() {
      navLinks.each(function(index) {
        const currentHref = $(this).attr('href')
        const targetHeader = $(currentHref);
        const targetSection = $(`${currentHref} + section`);

        if (!targetSection.length) {
          return;
        }

        const targetTop = Math.round(targetHeader.offset()?.top)
        const heightOfHeader = Math.round(targetHeader.outerHeight())
        // Calculate the end of an section
        const targetBottom = Math.round(targetTop + heightOfHeader + targetSection.outerHeight());

        if (HEIGHT_OF_PAGE_HEADER >= targetTop && 0 < targetBottom) {
          const currentNavSubitem = $(`.site-navigator .site-navigator__submenu-item[href="${currentHref}"]`)
          const currentSubmenuContainer = $(currentNavSubitem).parents('.site-navigator__submenu-container')
          const parentMenuItem = $(currentSubmenuContainer).find('>.site-navigator__submenu-item');

          if(parentMenuItem.hasClass('active')) {
            currentNavSubitem.parent().parent().find('.site-navigator__submenu-item').removeClass('active')
            currentNavSubitem.addClass('active')
          } else {
            $('.site-navigator .site-navigator__submenu-item').removeClass('active');
            parentMenuItem.addClass('active')
            $(currentNavSubitem).addClass('active')
          }
        }
      });
    }

    // Attach the custom debounced scroll event handler
    const debouncedScroll = debounce(handleScroll, 10);
    $('.page .page__content').on('scroll', debouncedScroll);

    // The page is ready  - hide loader
    setTimeout(() => $('.loader-wrapper').hide(), 500)
  </script>
  <script src='https://cdn.jsdelivr.net/npm/@docsearch/js@3'></script>
  <script>
    docsearch({apiKey: '3ef227e7fd5e2e1a3fffd880484934bf', container: '#docsearch', appId: 'S2ISXITURI', indexName: 'killbill_slate'});
  </script>
</html>
